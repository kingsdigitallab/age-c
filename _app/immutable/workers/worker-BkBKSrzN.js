(function(){"use strict";const ge={LOAD:"load",READY:"ready",SEARCH:"search",RESULTS:"results"};var gt=typeof global=="object"&&global&&global.Object===Object&&global,Tr=typeof self=="object"&&self&&self.Object===Object&&self,J=gt||Tr||Function("return this")(),L=J.Symbol,vt=Object.prototype,Fr=vt.hasOwnProperty,Ir=vt.toString,ve=L?L.toStringTag:void 0,Mr=Object.prototype.toString,$r="[object Null]",Nr="[object Undefined]",yt=L?L.toStringTag:void 0;function se(e){return e==null?e===void 0?Nr:$r:yt&&yt in Object(e)?function(r){var t=Fr.call(r,ve),n=r[ve];try{r[ve]=void 0;var o=!0}catch{}var a=Ir.call(r);return o&&(t?r[ve]=n:delete r[ve]),a}(e):function(r){return Mr.call(r)}(e)}function Y(e){return e!=null&&typeof e=="object"}var Wr="[object Symbol]";function ae(e){return typeof e=="symbol"||Y(e)&&se(e)==Wr}function ce(e,r){for(var t=-1,n=e==null?0:e.length,o=Array(n);++t<n;)o[t]=r(e[t],t,e);return o}var W=Array.isArray,_t=L?L.prototype:void 0,mt=_t?_t.toString:void 0;function bt(e){if(typeof e=="string")return e;if(W(e))return ce(e,bt)+"";if(ae(e))return mt?mt.call(e):"";var r=e+"";return r=="0"&&1/e==-1/0?"-0":r}function ee(e){var r=typeof e;return e!=null&&(r=="object"||r=="function")}function xe(e){return e}var Rr="[object AsyncFunction]",Cr="[object Function]",Dr="[object GeneratorFunction]",Lr="[object Proxy]";function jt(e){if(!ee(e))return!1;var r=se(e);return r==Cr||r==Dr||r==Rr||r==Lr}var St,Ue=J["__core-js_shared__"],Ot=(St=/[^.]+$/.exec(Ue&&Ue.keys&&Ue.keys.IE_PROTO||""))?"Symbol(src)_1."+St:"",Ur=Function.prototype.toString;function te(e){if(e!=null){try{return Ur.call(e)}catch{}try{return e+""}catch{}}return""}var Vr=/^\[object .+?Constructor\]$/,qr=RegExp("^"+Function.prototype.toString.call(Object.prototype.hasOwnProperty).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function re(e,r){var t=function(n,o){return n==null?void 0:n[o]}(e,r);return function(n){return!(!ee(n)||(o=n,Ot&&Ot in o))&&(jt(n)?qr:Vr).test(te(n));var o}(t)?t:void 0}var xt,Ve,qe,Be=re(J,"WeakMap"),kt=Object.create,Br=function(){function e(){}return function(r){if(!ee(r))return{};if(kt)return kt(r);e.prototype=r;var t=new e;return e.prototype=void 0,t}}(),Jr=Date.now,Hr=function(){try{var e=re(Object,"defineProperty");return e({},"",{}),e}catch{}}(),ke=Hr,Yr=ke?function(e,r){return ke(e,"toString",{configurable:!0,enumerable:!1,value:(t=r,function(){return t}),writable:!0});var t}:xe,Gr=(xt=Yr,Ve=0,qe=0,function(){var e=Jr(),r=16-(e-qe);if(qe=e,r>0){if(++Ve>=800)return arguments[0]}else Ve=0;return xt.apply(void 0,arguments)});function Kr(e){return e!=e}function Qr(e,r){return!(e==null||!e.length)&&function(t,n,o){return n==n?function(a,c,h){for(var d=-1,f=a.length;++d<f;)if(a[d]===c)return d;return-1}(t,n):function(a,c,h,d){for(var f=a.length,p=-1;++p<f;)if(c(a[p],p,a))return p;return-1}(t,Kr)}(e,r)>-1}var Xr=9007199254740991,Zr=/^(?:0|[1-9]\d*)$/;function Je(e,r){var t=typeof e;return!!(r=r??Xr)&&(t=="number"||t!="symbol"&&Zr.test(e))&&e>-1&&e%1==0&&e<r}function He(e,r,t){r=="__proto__"&&ke?ke(e,r,{configurable:!0,enumerable:!0,value:t,writable:!0}):e[r]=t}function Ae(e,r){return e===r||e!=e&&r!=r}var en=Object.prototype.hasOwnProperty;function At(e,r,t){var n=e[r];en.call(e,r)&&Ae(n,t)&&(t!==void 0||r in e)||He(e,r,t)}function Ee(e,r,t,n){var o=!t;t||(t={});for(var a=-1,c=r.length;++a<c;){var h=r[a],d=void 0;d===void 0&&(d=e[h]),o?He(t,h,d):At(t,h,d)}return t}var Et=Math.max;function zt(e,r){return Gr(function(t,n,o){return n=Et(n===void 0?t.length-1:n,0),function(){for(var a=arguments,c=-1,h=Et(a.length-n,0),d=Array(h);++c<h;)d[c]=a[n+c];c=-1;for(var f=Array(n+1);++c<n;)f[c]=a[c];return f[n]=o(d),function(p,y,g){switch(g.length){case 0:return p.call(y);case 1:return p.call(y,g[0]);case 2:return p.call(y,g[0],g[1]);case 3:return p.call(y,g[0],g[1],g[2])}return p.apply(y,g)}(t,this,f)}}(e,r,xe),e+"")}var tn=9007199254740991;function Ye(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=tn}function ue(e){return e!=null&&Ye(e.length)&&!jt(e)}function Pt(e,r,t){if(!ee(t))return!1;var n=typeof r;return!!(n=="number"?ue(t)&&Je(r,t.length):n=="string"&&r in t)&&Ae(t[r],e)}var rn=Object.prototype;function Ge(e){var r=e&&e.constructor;return e===(typeof r=="function"&&r.prototype||rn)}function Tt(e){return Y(e)&&se(e)=="[object Arguments]"}var Ft=Object.prototype,nn=Ft.hasOwnProperty,on=Ft.propertyIsEnumerable,Ke=Tt(function(){return arguments}())?Tt:function(e){return Y(e)&&nn.call(e,"callee")&&!on.call(e,"callee")},It=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Mt=It&&typeof module=="object"&&module&&!module.nodeType&&module,$t=Mt&&Mt.exports===It?J.Buffer:void 0,ze=($t?$t.isBuffer:void 0)||function(){return!1},F={};function Pe(e){return function(r){return e(r)}}F["[object Float32Array]"]=F["[object Float64Array]"]=F["[object Int8Array]"]=F["[object Int16Array]"]=F["[object Int32Array]"]=F["[object Uint8Array]"]=F["[object Uint8ClampedArray]"]=F["[object Uint16Array]"]=F["[object Uint32Array]"]=!0,F["[object Arguments]"]=F["[object Array]"]=F["[object ArrayBuffer]"]=F["[object Boolean]"]=F["[object DataView]"]=F["[object Date]"]=F["[object Error]"]=F["[object Function]"]=F["[object Map]"]=F["[object Number]"]=F["[object Object]"]=F["[object RegExp]"]=F["[object Set]"]=F["[object String]"]=F["[object WeakMap]"]=!1;var Nt=typeof exports=="object"&&exports&&!exports.nodeType&&exports,ye=Nt&&typeof module=="object"&&module&&!module.nodeType&&module,Qe=ye&&ye.exports===Nt&&gt.process,le=function(){try{return ye&&ye.require&&ye.require("util").types||Qe&&Qe.binding&&Qe.binding("util")}catch{}}(),Wt=le&&le.isTypedArray,Rt=Wt?Pe(Wt):function(e){return Y(e)&&Ye(e.length)&&!!F[se(e)]},sn=Object.prototype.hasOwnProperty;function Ct(e,r){var t=W(e),n=!t&&Ke(e),o=!t&&!n&&ze(e),a=!t&&!n&&!o&&Rt(e),c=t||n||o||a,h=c?function(p,y){for(var g=-1,l=Array(p);++g<p;)l[g]=y(g);return l}(e.length,String):[],d=h.length;for(var f in e)!r&&!sn.call(e,f)||c&&(f=="length"||o&&(f=="offset"||f=="parent")||a&&(f=="buffer"||f=="byteLength"||f=="byteOffset")||Je(f,d))||h.push(f);return h}function Dt(e,r){return function(t){return e(r(t))}}var an=Dt(Object.keys,Object),cn=Object.prototype.hasOwnProperty;function _e(e){return ue(e)?Ct(e):function(r){if(!Ge(r))return an(r);var t=[];for(var n in Object(r))cn.call(r,n)&&n!="constructor"&&t.push(n);return t}(e)}var un=Object.prototype.hasOwnProperty;function ln(e){return ue(e)?Ct(e,!0):function(r){if(!ee(r))return function(a){var c=[];if(a!=null)for(var h in Object(a))c.push(h);return c}(r);var t=Ge(r),n=[];for(var o in r)(o!="constructor"||!t&&un.call(r,o))&&n.push(o);return n}(e)}var fn=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,hn=/^\w*$/;function Xe(e,r){if(W(e))return!1;var t=typeof e;return!(t!="number"&&t!="symbol"&&t!="boolean"&&e!=null&&!ae(e))||hn.test(e)||!fn.test(e)||r!=null&&e in Object(r)}var me=re(Object,"create"),dn=Object.prototype.hasOwnProperty,pn=Object.prototype.hasOwnProperty;function ne(e){var r=-1,t=e==null?0:e.length;for(this.clear();++r<t;){var n=e[r];this.set(n[0],n[1])}}function Te(e,r){for(var t=e.length;t--;)if(Ae(e[t][0],r))return t;return-1}ne.prototype.clear=function(){this.__data__=me?me(null):{},this.size=0},ne.prototype.delete=function(e){var r=this.has(e)&&delete this.__data__[e];return this.size-=r?1:0,r},ne.prototype.get=function(e){var r=this.__data__;if(me){var t=r[e];return t==="__lodash_hash_undefined__"?void 0:t}return dn.call(r,e)?r[e]:void 0},ne.prototype.has=function(e){var r=this.__data__;return me?r[e]!==void 0:pn.call(r,e)},ne.prototype.set=function(e,r){var t=this.__data__;return this.size+=this.has(e)?0:1,t[e]=me&&r===void 0?"__lodash_hash_undefined__":r,this};var wn=Array.prototype.splice;function G(e){var r=-1,t=e==null?0:e.length;for(this.clear();++r<t;){var n=e[r];this.set(n[0],n[1])}}G.prototype.clear=function(){this.__data__=[],this.size=0},G.prototype.delete=function(e){var r=this.__data__,t=Te(r,e);return!(t<0||(t==r.length-1?r.pop():wn.call(r,t,1),--this.size,0))},G.prototype.get=function(e){var r=this.__data__,t=Te(r,e);return t<0?void 0:r[t][1]},G.prototype.has=function(e){return Te(this.__data__,e)>-1},G.prototype.set=function(e,r){var t=this.__data__,n=Te(t,e);return n<0?(++this.size,t.push([e,r])):t[n][1]=r,this};var be=re(J,"Map");function Fe(e,r){var t,n,o=e.__data__;return((n=typeof(t=r))=="string"||n=="number"||n=="symbol"||n=="boolean"?t!=="__proto__":t===null)?o[typeof r=="string"?"string":"hash"]:o.map}function K(e){var r=-1,t=e==null?0:e.length;for(this.clear();++r<t;){var n=e[r];this.set(n[0],n[1])}}function Ze(e,r){if(typeof e!="function"||r!=null&&typeof r!="function")throw new TypeError("Expected a function");var t=function(){var n=arguments,o=r?r.apply(this,n):n[0],a=t.cache;if(a.has(o))return a.get(o);var c=e.apply(this,n);return t.cache=a.set(o,c)||a,c};return t.cache=new(Ze.Cache||K),t}K.prototype.clear=function(){this.size=0,this.__data__={hash:new ne,map:new(be||G),string:new ne}},K.prototype.delete=function(e){var r=Fe(this,e).delete(e);return this.size-=r?1:0,r},K.prototype.get=function(e){return Fe(this,e).get(e)},K.prototype.has=function(e){return Fe(this,e).has(e)},K.prototype.set=function(e,r){var t=Fe(this,e),n=t.size;return t.set(e,r),this.size+=t.size==n?0:1,this},Ze.Cache=K;var et,tt,gn=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,vn=/\\(\\)?/g,yn=(et=Ze(function(e){var r=[];return e.charCodeAt(0)===46&&r.push(""),e.replace(gn,function(t,n,o,a){r.push(o?a.replace(vn,"$1"):n||t)}),r},function(e){return tt.size===500&&tt.clear(),e}),tt=et.cache,et);function Lt(e,r){return W(e)?e:Xe(e,r)?[e]:yn(function(t){return t==null?"":bt(t)}(e))}function Ie(e){if(typeof e=="string"||ae(e))return e;var r=e+"";return r=="0"&&1/e==-1/0?"-0":r}function rt(e,r){for(var t=0,n=(r=Lt(r,e)).length;e!=null&&t<n;)e=e[Ie(r[t++])];return t&&t==n?e:void 0}function nt(e,r){for(var t=-1,n=r.length,o=e.length;++t<n;)e[o+t]=r[t];return e}var Ut=L?L.isConcatSpreadable:void 0;function _n(e){return W(e)||Ke(e)||!!(Ut&&e&&e[Ut])}function mn(e,r,t,n,o){var a=-1,c=e.length;for(t||(t=_n),o||(o=[]);++a<c;){var h=e[a];t(h)?nt(o,h):o[o.length]=h}return o}var Vt=Dt(Object.getPrototypeOf,Object);function H(e){var r=this.__data__=new G(e);this.size=r.size}H.prototype.clear=function(){this.__data__=new G,this.size=0},H.prototype.delete=function(e){var r=this.__data__,t=r.delete(e);return this.size=r.size,t},H.prototype.get=function(e){return this.__data__.get(e)},H.prototype.has=function(e){return this.__data__.has(e)},H.prototype.set=function(e,r){var t=this.__data__;if(t instanceof G){var n=t.__data__;if(!be||n.length<199)return n.push([e,r]),this.size=++t.size,this;t=this.__data__=new K(n)}return t.set(e,r),this.size=t.size,this};var qt=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Bt=qt&&typeof module=="object"&&module&&!module.nodeType&&module,Jt=Bt&&Bt.exports===qt?J.Buffer:void 0,Ht=Jt?Jt.allocUnsafe:void 0;function Yt(){return[]}var bn=Object.prototype.propertyIsEnumerable,Gt=Object.getOwnPropertySymbols,jn=Gt?function(e){return e==null?[]:(e=Object(e),function(r,t){for(var n=-1,o=r==null?0:r.length,a=0,c=[];++n<o;){var h=r[n];bn.call(e,h)&&(c[a++]=h)}return c}(Gt(e)))}:Yt,ot=jn,Sn=Object.getOwnPropertySymbols?function(e){for(var r=[];e;)nt(r,ot(e)),e=Vt(e);return r}:Yt;function On(e,r,t){var n=r(e);return W(e)?n:nt(n,t(e))}function it(e){return On(e,_e,ot)}var st=re(J,"DataView"),at=re(J,"Promise"),ct=re(J,"Set"),Kt="[object Map]",Qt="[object Promise]",Xt="[object Set]",Zt="[object WeakMap]",er="[object DataView]",xn=te(st),kn=te(be),An=te(at),En=te(ct),zn=te(Be),oe=se;(st&&oe(new st(new ArrayBuffer(1)))!=er||be&&oe(new be)!=Kt||at&&oe(at.resolve())!=Qt||ct&&oe(new ct)!=Xt||Be&&oe(new Be)!=Zt)&&(oe=function(e){var r=se(e),t=r=="[object Object]"?e.constructor:void 0,n=t?te(t):"";if(n)switch(n){case xn:return er;case kn:return Kt;case An:return Qt;case En:return Xt;case zn:return Zt}return r});var je=oe,Pn=Object.prototype.hasOwnProperty,Me=J.Uint8Array;function Tn(e){var r=new e.constructor(e.byteLength);return new Me(r).set(new Me(e)),r}var Fn=/\w*$/,tr=L?L.prototype:void 0,rr=tr?tr.valueOf:void 0,In="[object Boolean]",Mn="[object Date]",$n="[object Map]",Nn="[object Number]",Wn="[object RegExp]",Rn="[object Set]",Cn="[object String]",Dn="[object Symbol]",Ln="[object ArrayBuffer]",Un="[object DataView]",Vn="[object Float32Array]",qn="[object Float64Array]",Bn="[object Int8Array]",Jn="[object Int16Array]",Hn="[object Int32Array]",Yn="[object Uint8Array]",Gn="[object Uint8ClampedArray]",Kn="[object Uint16Array]",Qn="[object Uint32Array]",nr=le&&le.isMap,Xn=nr?Pe(nr):function(e){return Y(e)&&je(e)=="[object Map]"},or=le&&le.isSet,Zn=or?Pe(or):function(e){return Y(e)&&je(e)=="[object Set]"},eo=2,ir="[object Arguments]",sr="[object Function]",to="[object GeneratorFunction]",ar="[object Object]",P={};function $e(e,r,t,n,o,a){var c,h=r&eo;if(c!==void 0)return c;if(!ee(e))return e;var d=W(e);if(d)return c=function(l){var v=l.length,_=new l.constructor(v);return v&&typeof l[0]=="string"&&Pn.call(l,"index")&&(_.index=l.index,_.input=l.input),_}(e),function(l,v){var _=-1,S=l.length;for(v||(v=Array(S));++_<S;)v[_]=l[_];return v}(e,c);var f=je(e),p=f==sr||f==to;if(ze(e))return function(l,v){var _=l.length,S=Ht?Ht(_):new l.constructor(_);return l.copy(S),S}(e);if(f==ar||f==ir||p&&!o)return c=p?{}:function(l){return typeof l.constructor!="function"||Ge(l)?{}:Br(Vt(l))}(e),h?function(l,v){return Ee(l,Sn(l),v)}(e,function(l,v){return l&&Ee(v,ln(v),l)}(c,e)):function(l,v){return Ee(l,ot(l),v)}(e,function(l,v){return l&&Ee(v,_e(v),l)}(c,e));if(!P[f])return o?e:{};c=function(l,v,_){var S,O,I=l.constructor;switch(v){case Ln:return Tn(l);case In:case Mn:return new I(+l);case Un:return function($,M){var D=$.buffer;return new $.constructor(D,$.byteOffset,$.byteLength)}(l);case Vn:case qn:case Bn:case Jn:case Hn:case Yn:case Gn:case Kn:case Qn:return function($,M){var D=$.buffer;return new $.constructor(D,$.byteOffset,$.length)}(l);case $n:return new I;case Nn:case Cn:return new I(l);case Wn:return(O=new(S=l).constructor(S.source,Fn.exec(S))).lastIndex=S.lastIndex,O;case Rn:return new I;case Dn:return rr?Object(rr.call(l)):{}}}(e,f),a||(a=new H);var y=a.get(e);if(y)return y;a.set(e,c),Zn(e)?e.forEach(function(l){c.add($e(l,r,t,l,e,a))}):Xn(e)&&e.forEach(function(l,v){c.set(v,$e(l,r,t,v,e,a))});var g=d?void 0:it(e);return function(l,v){for(var _=-1,S=l==null?0:l.length;++_<S&&v(l[_],_)!==!1;);}(g||e,function(l,v){g&&(l=e[v=l]),At(c,v,$e(l,r,t,v,e,a))}),c}function ut(e){return $e(e,4)}function Se(e){var r=-1,t=e==null?0:e.length;for(this.__data__=new K;++r<t;)this.add(e[r])}function ro(e,r){for(var t=-1,n=e==null?0:e.length;++t<n;)if(r(e[t],t,e))return!0;return!1}function lt(e,r){return e.has(r)}P[ir]=P["[object Array]"]=P["[object ArrayBuffer]"]=P["[object DataView]"]=P["[object Boolean]"]=P["[object Date]"]=P["[object Float32Array]"]=P["[object Float64Array]"]=P["[object Int8Array]"]=P["[object Int16Array]"]=P["[object Int32Array]"]=P["[object Map]"]=P["[object Number]"]=P[ar]=P["[object RegExp]"]=P["[object Set]"]=P["[object String]"]=P["[object Symbol]"]=P["[object Uint8Array]"]=P["[object Uint8ClampedArray]"]=P["[object Uint16Array]"]=P["[object Uint32Array]"]=!0,P["[object Error]"]=P[sr]=P["[object WeakMap]"]=!1,Se.prototype.add=Se.prototype.push=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},Se.prototype.has=function(e){return this.__data__.has(e)};var no=1,oo=2;function cr(e,r,t,n,o,a){var c=t&no,h=e.length,d=r.length;if(h!=d&&!(c&&d>h))return!1;var f=a.get(e),p=a.get(r);if(f&&p)return f==r&&p==e;var y=-1,g=!0,l=t&oo?new Se:void 0;for(a.set(e,r),a.set(r,e);++y<h;){var v=e[y],_=r[y];if(n)var S=c?n(_,v,y,r,e,a):n(v,_,y,e,r,a);if(S!==void 0){if(S)continue;g=!1;break}if(l){if(!ro(r,function(O,I){if(!lt(l,I)&&(v===O||o(v,O,t,n,a)))return l.push(I)})){g=!1;break}}else if(v!==_&&!o(v,_,t,n,a)){g=!1;break}}return a.delete(e),a.delete(r),g}function io(e){var r=-1,t=Array(e.size);return e.forEach(function(n,o){t[++r]=[o,n]}),t}function so(e){var r=-1,t=Array(e.size);return e.forEach(function(n){t[++r]=n}),t}var ao=1,co=2,uo="[object Boolean]",lo="[object Date]",fo="[object Error]",ho="[object Map]",po="[object Number]",wo="[object RegExp]",go="[object Set]",vo="[object String]",yo="[object Symbol]",_o="[object ArrayBuffer]",mo="[object DataView]",ur=L?L.prototype:void 0,ft=ur?ur.valueOf:void 0,bo=1,jo=Object.prototype.hasOwnProperty,So=1,lr="[object Arguments]",fr="[object Array]",Ne="[object Object]",hr=Object.prototype.hasOwnProperty;function ht(e,r,t,n,o){return e===r||(e==null||r==null||!Y(e)&&!Y(r)?e!=e&&r!=r:function(a,c,h,d,f,p){var y=W(a),g=W(c),l=y?fr:je(a),v=g?fr:je(c),_=(l=l==lr?Ne:l)==Ne,S=(v=v==lr?Ne:v)==Ne,O=l==v;if(O&&ze(a)){if(!ze(c))return!1;y=!0,_=!1}if(O&&!_)return p||(p=new H),y||Rt(a)?cr(a,c,h,d,f,p):function(x,A,V,q,fe,C,U){switch(V){case mo:if(x.byteLength!=A.byteLength||x.byteOffset!=A.byteOffset)return!1;x=x.buffer,A=A.buffer;case _o:return!(x.byteLength!=A.byteLength||!C(new Me(x),new Me(A)));case uo:case lo:case po:return Ae(+x,+A);case fo:return x.name==A.name&&x.message==A.message;case wo:case vo:return x==A+"";case ho:var B=io;case go:if(B||(B=so),x.size!=A.size&&!(q&ao))return!1;var Q=U.get(x);if(Q)return Q==A;q|=co,U.set(x,A);var X=cr(B(x),B(A),q,fe,C,U);return U.delete(x),X;case yo:if(ft)return ft.call(x)==ft.call(A)}return!1}(a,c,l,h,d,f,p);if(!(h&So)){var I=_&&hr.call(a,"__wrapped__"),$=S&&hr.call(c,"__wrapped__");if(I||$){var M=I?a.value():a,D=$?c.value():c;return p||(p=new H),f(M,D,h,d,p)}}return!!O&&(p||(p=new H),function(x,A,V,q,fe,C){var U=V&bo,B=it(x),Q=B.length;if(Q!=it(A).length&&!U)return!1;for(var X=Q;X--;){var u=B[X];if(!(U?u in A:jo.call(A,u)))return!1}var i=C.get(x),s=C.get(A);if(i&&s)return i==A&&s==x;var w=!0;C.set(x,A),C.set(A,x);for(var m=U;++X<Q;){var b=x[u=B[X]],j=A[u];if(q)var z=U?q(j,b,u,A,x,C):q(b,j,u,x,A,C);if(!(z===void 0?b===j||fe(b,j,V,q,C):z)){w=!1;break}m||(m=u=="constructor")}if(w&&!m){var N=x.constructor,T=A.constructor;N==T||!("constructor"in x)||!("constructor"in A)||typeof N=="function"&&N instanceof N&&typeof T=="function"&&T instanceof T||(w=!1)}return C.delete(x),C.delete(A),w}(a,c,h,d,f,p))}(e,r,t,n,ht,o))}var Oo=1,xo=2;function dr(e){return e==e&&!ee(e)}function pr(e,r){return function(t){return t!=null&&t[e]===r&&(r!==void 0||e in Object(t))}}function ko(e,r){return e!=null&&r in Object(e)}var Ao=1,Eo=2;function ie(e){return typeof e=="function"?e:e==null?xe:typeof e=="object"?W(e)?function(a,c){return Xe(a)&&dr(c)?pr(Ie(a),c):function(h){var d=function(f,p,y){var g=f==null?void 0:rt(f,p);return g===void 0?void 0:g}(h,a);return d===void 0&&d===c?function(f,p){return f!=null&&function(y,g,l){for(var v=-1,_=(g=Lt(g,y)).length,S=!1;++v<_;){var O=Ie(g[v]);if(!(S=y!=null&&l(y,O)))break;y=y[O]}return S||++v!=_?S:!!(_=y==null?0:y.length)&&Ye(_)&&Je(O,_)&&(W(y)||Ke(y))}(f,p,ko)}(h,a):ht(c,d,Ao|Eo)}}(e[0],e[1]):(o=function(a){for(var c=_e(a),h=c.length;h--;){var d=c[h],f=a[d];c[h]=[d,f,dr(f)]}return c}(n=e),o.length==1&&o[0][2]?pr(o[0][0],o[0][1]):function(a){return a===n||function(c,h,d,f){var p=d.length,y=p;if(c==null)return!y;for(c=Object(c);p--;){var g=d[p];if(g[2]?g[1]!==c[g[0]]:!(g[0]in c))return!1}for(;++p<y;){var l=(g=d[p])[0],v=c[l],_=g[1];if(g[2]){if(v===void 0&&!(l in c))return!1}else{var S=new H;if(!ht(_,v,Oo|xo,void 0,S))return!1}}return!0}(a,0,o)}):Xe(r=e)?(t=Ie(r),function(a){return a==null?void 0:a[t]}):function(a){return function(c){return rt(c,a)}}(r);var r,t,n,o}var zo=function(e,r,t){for(var n=-1,o=Object(e),a=t(e),c=a.length;c--;){var h=a[++n];if(r(o[h],h,o)===!1)break}return e};function wr(e,r){return e&&zo(e,r,_e)}var gr,Po=(gr=wr,function(e,r){if(e==null)return e;if(!ue(e))return gr(e,r);for(var t=e.length,n=-1,o=Object(e);++n<t&&r(o[n],n,o)!==!1;);return e});function vr(e,r){var t=-1,n=ue(e)?Array(e.length):[];return Po(e,function(o,a,c){n[++t]=r(o,a,c)}),n}function To(e,r){return e>r}var Fo=Math.min;function Io(e){return function(r){return Y(r)&&ue(r)}(e)?e:[]}var Mo=zt(function(e){var r=ce(e,Io);return r.length&&r[0]===e[0]?function(t,n,o){for(var a=Qr,c=t[0].length,h=t.length,d=h,f=Array(h),p=1/0,y=[];d--;){var g=t[d];p=Fo(g.length,p),f[d]=c>=120&&g.length>=120?new Se(d&&g):void 0}g=t[0];var l=-1,v=f[0];e:for(;++l<c&&y.length<p;){var _=g[l],S=_;if(_=_!==0?_:0,!(v?lt(v,S):a(y,S,o))){for(d=h;--d;){var O=f[d];if(!(O?lt(O,S):a(t[d],S,o)))continue e}v&&v.push(S),y.push(_)}}return y}(r):[]}),$o=Mo;function No(e,r){return e<r}function E(e,r){var t={};return r=ie(r),wr(e,function(n,o,a){He(t,o,r(n,o,a))}),t}function yr(e,r,t){for(var n=-1,o=e.length;++n<o;){var a=e[n],c=r(a);if(c!=null&&(h===void 0?c==c&&!ae(c):t(c,h)))var h=c,d=a}return d}function Wo(e,r){return e&&e.length?yr(e,ie(r),To):void 0}function _r(e,r){for(var t,n=-1,o=e.length;++n<o;){var a=r(e[n]);a!==void 0&&(t=t===void 0?a:t+a)}return t}function Ro(e,r){return function(t,n){var o=t==null?0:t.length;return o?_r(t,n)/o:NaN}(e,ie(r))}function Co(e,r){if(e!==r){var t=e!==void 0,n=e===null,o=e==e,a=ae(e),c=r!==void 0,h=r===null,d=r==r,f=ae(r);if(!h&&!f&&!a&&e>r||a&&c&&d&&!h&&!f||n&&c&&d||!t&&d||!o)return 1;if(!n&&!a&&!f&&e<r||f&&t&&o&&!n&&!a||h&&t&&o||!c&&o||!d)return-1}return 0}function mr(e,r,t){r=r.length?ce(r,function(o){return W(o)?function(a){return rt(a,o.length===1?o[0]:o)}:o}):[xe];var n=-1;return r=ce(r,Pe(ie)),function(o,a){var c=o.length;for(o.sort(function(h,d){return function(f,p,y){for(var g=-1,l=f.criteria,v=p.criteria,_=l.length,S=y.length;++g<_;){var O=Co(l[g],v[g]);if(O)return g>=S?O:O*(y[g]=="desc"?-1:1)}return f.index-p.index}(h,d,t)});c--;)o[c]=o[c].value;return o}(vr(e,function(o,a,c){return{criteria:ce(r,function(h){return h(o)}),index:++n,value:o}}))}function dt(e,r,t,n){return e==null?[]:(W(r)||(r=r==null?[]:[r]),W(t=t)||(t=t==null?[]:[t]),mr(e,r,t))}var Do=zt(function(e,r){if(e==null)return[];var t=r.length;return t>1&&Pt(e,r[0],r[1])?r=[]:t>2&&Pt(r[0],r[1],r[2])&&(r=[r[0]]),mr(e,mn(r),[])});function Lo(e,r){return e&&e.length?_r(e,ie(r)):0}function k(e){if(this.words=[],e)if(Symbol&&Symbol.iterator&&e[Symbol.iterator]!==void 0){const r=e[Symbol.iterator]();let t=r.next();for(;!t.done;)this.add(t.value),t=r.next()}else for(let r=0;r<e.length;r++)this.add(e[r])}k.fromWords=function(e){const r=Object.create(k.prototype);return r.words=e,r},k.prototype.add=function(e){this.resize(e),this.words[e>>>5]|=1<<e},k.prototype.flip=function(e){this.resize(e),this.words[e>>>5]^=1<<e},k.prototype.clear=function(){this.words.length=0},k.prototype.remove=function(e){this.resize(e),this.words[e>>>5]&=~(1<<e)},k.prototype.isEmpty=function(e){const r=this.words.length;for(let t=0;t<r;t++)if(this.words[t]!==0)return!1;return!0},k.prototype.has=function(e){return(this.words[e>>>5]&1<<e)!=0},k.prototype.checkedAdd=function(e){this.resize(e);const r=this.words[e>>>5],t=r|1<<e;return this.words[e>>>5]=t,(t^r)>>>e},k.prototype.trim=function(e){let r=this.words.length;for(;r>0&&this.words[r-1]===0;)r--;this.words.length=r},k.prototype.resize=function(e){const r=e+32>>>5;for(let t=this.words.length;t<r;t++)this.words[t]=0},k.prototype.hammingWeight=function(e){return 16843009*((e=(858993459&(e-=e>>>1&1431655765))+(e>>>2&858993459))+(e>>>4)&252645135)>>>24},k.prototype.hammingWeight4=function(e,r,t,n){return 16843009*((e=(e=(858993459&(e-=e>>>1&1431655765))+(e>>>2&858993459))+(e>>>4)&252645135)+(r=(r=(858993459&(r-=r>>>1&1431655765))+(r>>>2&858993459))+(r>>>4)&252645135)+(t=(t=(858993459&(t-=t>>>1&1431655765))+(t>>>2&858993459))+(t>>>4)&252645135)+(n=(n=(858993459&(n-=n>>>1&1431655765))+(n>>>2&858993459))+(n>>>4)&252645135))>>>24},k.prototype.size=function(){let e=0;const r=this.words.length,t=this.words;for(let n=0;n<r;n++)e+=this.hammingWeight(t[n]);return e},k.prototype.array=function(){const e=new Array(this.size());let r=0;const t=this.words.length;for(let n=0;n<t;++n){let o=this.words[n];for(;o!=0;){const a=o&-o;e[r++]=(n<<5)+this.hammingWeight(a-1|0),o^=a}}return e},k.prototype.forEach=function(e){const r=this.words.length;for(let t=0;t<r;++t){let n=this.words[t];for(;n!=0;){const o=n&-n;e((t<<5)+this.hammingWeight(o-1|0)),n^=o}}},k.prototype[Symbol.iterator]=function(){const e=this.words.length;let r=0,t=this.words[r],n=this.hammingWeight,o=this.words;return{[Symbol.iterator](){return this},next(){for(;r<e;){if(t!==0){const a=t&-t,c=(r<<5)+n(a-1|0);return t^=a,{done:!1,value:c}}r++,r<e&&(t=o[r])}return{done:!0,value:void 0}}}},k.prototype.clone=function(){const e=Object.create(k.prototype);return e.words=this.words.slice(),e},k.prototype.intersects=function(e){const r=Math.min(this.words.length,e.words.length);for(let t=0;t<r;++t)if((this.words[t]&e.words[t])!=0)return!0;return!1},k.prototype.intersection=function(e){const r=Math.min(this.words.length,e.words.length);let t=0;for(;t+7<r;t+=8)this.words[t]&=e.words[t],this.words[t+1]&=e.words[t+1],this.words[t+2]&=e.words[t+2],this.words[t+3]&=e.words[t+3],this.words[t+4]&=e.words[t+4],this.words[t+5]&=e.words[t+5],this.words[t+6]&=e.words[t+6],this.words[t+7]&=e.words[t+7];for(;t<r;++t)this.words[t]&=e.words[t];const n=this.words.length;for(t=r;t<n;++t)this.words[t]=0;return this},k.prototype.intersection_size=function(e){const r=Math.min(this.words.length,e.words.length);let t=0;for(let n=0;n<r;++n)t+=this.hammingWeight(this.words[n]&e.words[n]);return t},k.prototype.new_intersection=function(e){const r=Object.create(k.prototype),t=Math.min(this.words.length,e.words.length);r.words=new Array(t);let n=0;for(;n+7<t;n+=8)r.words[n]=this.words[n]&e.words[n],r.words[n+1]=this.words[n+1]&e.words[n+1],r.words[n+2]=this.words[n+2]&e.words[n+2],r.words[n+3]=this.words[n+3]&e.words[n+3],r.words[n+4]=this.words[n+4]&e.words[n+4],r.words[n+5]=this.words[n+5]&e.words[n+5],r.words[n+6]=this.words[n+6]&e.words[n+6],r.words[n+7]=this.words[n+7]&e.words[n+7];for(;n<t;++n)r.words[n]=this.words[n]&e.words[n];return r},k.prototype.equals=function(e){const r=Math.min(this.words.length,e.words.length);for(let t=0;t<r;++t)if(this.words[t]!=e.words[t])return!1;if(this.words.length<e.words.length){const t=e.words.length;for(let n=this.words.length;n<t;++n)if(e.words[n]!=0)return!1}else if(e.words.length<this.words.length){const t=this.words.length;for(let n=e.words.length;n<t;++n)if(this.words[n]!=0)return!1}return!0},k.prototype.difference=function(e){const r=Math.min(this.words.length,e.words.length);let t=0;for(;t+7<r;t+=8)this.words[t]&=~e.words[t],this.words[t+1]&=~e.words[t+1],this.words[t+2]&=~e.words[t+2],this.words[t+3]&=~e.words[t+3],this.words[t+4]&=~e.words[t+4],this.words[t+5]&=~e.words[t+5],this.words[t+6]&=~e.words[t+6],this.words[t+7]&=~e.words[t+7];for(;t<r;++t)this.words[t]&=~e.words[t];return this},k.prototype.new_difference=function(e){return this.clone().difference(e)},k.prototype.difference2=function(e){const r=Math.min(this.words.length,e.words.length);let t=0;for(;t+7<r;t+=8)e.words[t]=this.words[t]&~e.words[t],e.words[t+1]=this.words[t+1]&~e.words[t+1],e.words[t+2]=this.words[t+2]&~e.words[t+2],e.words[t+3]=this.words[t+3]&~e.words[t+3],e.words[t+4]=this.words[t+4]&~e.words[t+4],e.words[t+5]=this.words[t+5]&~e.words[t+5],e.words[t+6]=this.words[t+6]&~e.words[t+6],e.words[t+7]=this.words[t+7]&~e.words[t+7];for(;t<r;++t)e.words[t]=this.words[t]&~e.words[t];for(t=this.words.length-1;t>=r;--t)e.words[t]=this.words[t];return e.words.length=this.words.length,e},k.prototype.difference_size=function(e){const r=Math.min(this.words.length,e.words.length);let t=0,n=0;for(;n<r;++n)t+=this.hammingWeight(this.words[n]&~e.words[n]);const o=this.words.length;for(;n<o;++n)t+=this.hammingWeight(this.words[n]);return t},k.prototype.change=function(e){const r=Math.min(this.words.length,e.words.length);let t=0;for(;t+7<r;t+=8)this.words[t]^=e.words[t],this.words[t+1]^=e.words[t+1],this.words[t+2]^=e.words[t+2],this.words[t+3]^=e.words[t+3],this.words[t+4]^=e.words[t+4],this.words[t+5]^=e.words[t+5],this.words[t+6]^=e.words[t+6],this.words[t+7]^=e.words[t+7];for(;t<r;++t)this.words[t]^=e.words[t];for(t=e.words.length-1;t>=r;--t)this.words[t]=e.words[t];return this},k.prototype.new_change=function(e){const r=Object.create(k.prototype),t=Math.max(this.words.length,e.words.length);r.words=new Array(t);const n=Math.min(this.words.length,e.words.length);let o=0;for(;o+7<n;o+=8)r.words[o]=this.words[o]^e.words[o],r.words[o+1]=this.words[o+1]^e.words[o+1],r.words[o+2]=this.words[o+2]^e.words[o+2],r.words[o+3]=this.words[o+3]^e.words[o+3],r.words[o+4]=this.words[o+4]^e.words[o+4],r.words[o+5]=this.words[o+5]^e.words[o+5],r.words[o+6]=this.words[o+6]^e.words[o+6],r.words[o+7]=this.words[o+7]^e.words[o+7];for(;o<n;++o)r.words[o]=this.words[o]^e.words[o];const a=this.words.length;for(o=n;o<a;++o)r.words[o]=this.words[o];const c=e.words.length;for(o=n;o<c;++o)r.words[o]=e.words[o];return r},k.prototype.change_size=function(e){const r=Math.min(this.words.length,e.words.length);let t=0,n=0;for(;n<r;++n)t+=this.hammingWeight(this.words[n]^e.words[n]);const o=this.words.length>e.words.length?this:e,a=o.words.length;for(;n<a;++n)t+=this.hammingWeight(o.words[n]);return t},k.prototype.toString=function(){return"{"+this.array().join(",")+"}"},k.prototype.union=function(e){const r=Math.min(this.words.length,e.words.length);let t=0;for(;t+7<r;t+=8)this.words[t]|=e.words[t],this.words[t+1]|=e.words[t+1],this.words[t+2]|=e.words[t+2],this.words[t+3]|=e.words[t+3],this.words[t+4]|=e.words[t+4],this.words[t+5]|=e.words[t+5],this.words[t+6]|=e.words[t+6],this.words[t+7]|=e.words[t+7];for(;t<r;++t)this.words[t]|=e.words[t];if(this.words.length<e.words.length){this.resize((e.words.length<<5)-1);const n=e.words.length;for(let o=r;o<n;++o)this.words[o]=e.words[o]}return this},k.prototype.new_union=function(e){const r=Object.create(k.prototype),t=Math.max(this.words.length,e.words.length);r.words=new Array(t);const n=Math.min(this.words.length,e.words.length);let o=0;for(;o+7<n;o+=8)r.words[o]=this.words[o]|e.words[o],r.words[o+1]=this.words[o+1]|e.words[o+1],r.words[o+2]=this.words[o+2]|e.words[o+2],r.words[o+3]=this.words[o+3]|e.words[o+3],r.words[o+4]=this.words[o+4]|e.words[o+4],r.words[o+5]=this.words[o+5]|e.words[o+5],r.words[o+6]=this.words[o+6]|e.words[o+6],r.words[o+7]=this.words[o+7]|e.words[o+7];for(;o<n;++o)r.words[o]=this.words[o]|e.words[o];const a=this.words.length;for(o=n;o<a;++o)r.words[o]=this.words[o];const c=e.words.length;for(o=n;o<c;++o)r.words[o]=e.words[o];return r},k.prototype.union_size=function(e){const r=Math.min(this.words.length,e.words.length);let t=0;for(let n=0;n<r;++n)t+=this.hammingWeight(this.words[n]|e.words[n]);if(this.words.length<e.words.length){const n=e.words.length;for(let o=this.words.length;o<n;++o)t+=this.hammingWeight(0|e.words[o])}else{const n=this.words.length;for(let o=e.words.length;o<n;++o)t+=this.hammingWeight(0|this.words[o])}return t};var R=k;function pt(){return pt=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},pt.apply(this,arguments)}function Uo(e,r){var t=[];return e.forEach(function(n){r.forEach(function(o){t.push(n.concat(o))})}),t}function br(e){return!!~e.search(/\(|\)/)}function jr(e,r){for(var t=r.split(" "+e+" "),n=[],o=[],a=0;a<t.length;a++)if(br(t[a])||o.length>0){o.push(t[a]);var c=""+o;(c.match(/\(/g)||[]).length===(c.match(/\)/g)||[]).length&&(n.push(o.join(" "+e+" ")),o=[])}else n.push(t[a]);return n}var Vo=function e(r){return function(n){for(var o=n[0],a=1;a<n.length;a++)o=o.concat(n[a]);return o}(jr("OR",(t=r=function(n){if(n.charAt(0)==="("){for(var o=0,a=0;a<n.length;a++)if(n.charAt(a)==="("?o++:n.charAt(a)===")"&&o--,o===0)return a!==n.length-1?n:n.substring(1,n.length-1)}return n}(r),r=t.replace(/[\s]+/g," "))).map(function(n){for(var o=jr("AND",n),a=[],c=[],h=0;h<o.length;h++)br(o[h])?a.push(e(o[h])):c.push(o[h]);return a.push([c]),function(d){for(var f=[[]],p=0;p<d.length;p++)f=Uo(f,d[p]);return f}(a)}));var t};const Sr=function(e){try{return structuredClone(e)}catch{try{return JSON.parse(JSON.stringify(e))}catch{return e}}},Or=function(e,r){let t=new R([]),n=0;return E(r,function(o,a){o.forEach(c=>{++n,t=t.new_union(e[a][c]||new R([]))})}),n===0?null:t},qo=function(e,r,t){let n=1;return E(e.bits_data_temp,(o,a)=>{let c,h,d,f,p,y,g;t[a]&&(c=t[a].order,h=t[a].sort,d=t[a].size,f=t[a].title,p=t[a].show_facet_stats||!1,y=t[a].chosen_filters_on_top!==!1,g=t[a].hide_zero_doc_count||!1);let l,v,_,S,O=Object.entries(o).map(M=>{let D=[];r&&r.filters&&r.filters[a]&&(D=r.filters[a]);const x=M[1].array().length;if(!g||x!==0||D.indexOf(M[0])!==-1)return{key:M[0],doc_count:x,selected:D.indexOf(M[0])!==-1}}).filter(Boolean);var I,$;return W(h)?(l=h||["key"],v=c||["asc"]):(h==="term"||h==="key"?(l=["key"],v=[c||"asc"]):(l=["doc_count","key"],v=[c||"desc","asc"]),y&&(l.unshift("selected"),v.unshift("desc"))),O=dt(O,l,v),O=O.slice(0,d||10),p&&(_=[],Object.entries(o).forEach(M=>{if(isNaN(M[0]))throw new Error("You cant use chars to calculate the facet_stats.");M[1].array().length>0&&M[1].forEach(()=>{_.push(parseInt(M[0]))})}),S={min:(I=_,I&&I.length?yr(I,ie(void 0),No):void 0),max:Wo(_),avg:Ro(_),sum:Lo(_)}),pt({name:a,title:f||($=a,$.replace(/^[\s_]+|[\s_]+$/g,"").replace(/[_\s]+/g," ").replace(/^[a-z]/,function(M){return M.toUpperCase()})),position:n++,buckets:O},p&&{facet_stats:S})})};function xr(e,r,t,n,o){r=r||Object.create(null);const a=parseInt(r.per_page||12),c=parseInt(r.page||1),h=r.is_all_filtered_items||!1;if(t.native_search_enabled===!1&&(r.query||r.filter))throw new Error('"query" and "filter" options are not working once native search is disabled');let d=0;const f=new Date().getTime();let p,y,g,l=o.bits_ids();if(r._ids)p=new R(r._ids),y=r._ids;else if(r.ids)y=o.internal_ids_from_ids_map(r.ids),p=new R(y);else if(n&&(r.query||r.filter)){const x=new Date().getTime();y=n.search(r.query,r.filter),d=new Date().getTime()-x,p=new R(y)}let v=new Date().getTime();const _=o.search(r,{query_ids:p});v=new Date().getTime()-v,p&&(l=p),_.ids&&(l=l.new_intersection(_.ids)),_.not_ids&&(l=l.new_difference(_.not_ids));let S=l.array(),O=S.map(x=>o.get_item(x)),I=!1;const $=new Date().getTime();let M=0;r.sort?O=function(x,A,V){return V&&V[A]&&(A=V[A]),A.field?dt(x,A.field,A.order||"asc"):x}(O,r.sort,t.sortings):y&&(S=y.filter(x=>l.has(x)),O=S.slice((c-1)*a,c*a).map(x=>o.get_item(x)),I=!0),I||(g=h?O:null,O=O.slice((c-1)*a,c*a)),M=new Date().getTime()-$;const D=new Date().getTime()-f;return{pagination:{per_page:a,page:c,total:S.length},timings:{total:D,facets:v,search:d,sorting:M},data:{items:O,allFilteredItems:g,aggregations:qo(_,r,t.aggregations)}}}var We=function(e){var r={exports:{}};return function(t,n){(function(){var o,a,c,h,d,f,p,y,g,l,v,_,S,O,I,$,M,D,x,A,V,q,fe,C,U,B,Q,X,u=function(i){var s=new u.Index;return s.pipeline.add(u.trimmer,u.stopWordFilter,u.stemmer),i&&i.call(s,s),s};u.version="1.0.0",u.utils={},u.utils.warn=function(i){return function(s){i.console&&console.warn&&console.warn(s)}}(this),u.utils.asString=function(i){return i==null?"":i.toString()},u.EventEmitter=function(){this.events={}},u.EventEmitter.prototype.addListener=function(){var i=Array.prototype.slice.call(arguments),s=i.pop(),w=i;if(typeof s!="function")throw new TypeError("last argument must be a function");w.forEach(function(m){this.hasHandler(m)||(this.events[m]=[]),this.events[m].push(s)},this)},u.EventEmitter.prototype.removeListener=function(i,s){if(this.hasHandler(i)){var w=this.events[i].indexOf(s);this.events[i].splice(w,1),this.events[i].length||delete this.events[i]}},u.EventEmitter.prototype.emit=function(i){if(this.hasHandler(i)){var s=Array.prototype.slice.call(arguments,1);this.events[i].forEach(function(w){w.apply(void 0,s)})}},u.EventEmitter.prototype.hasHandler=function(i){return i in this.events},u.tokenizer=function(i){return arguments.length&&i!=null&&i!=null?Array.isArray(i)?i.map(function(s){return u.utils.asString(s).toLowerCase()}):i.toString().trim().toLowerCase().split(u.tokenizer.separator):[]},u.tokenizer.separator=/[\s\-]+/,u.tokenizer.load=function(i){var s=this.registeredFunctions[i];if(!s)throw new Error("Cannot load un-registered function: "+i);return s},u.tokenizer.label="default",u.tokenizer.registeredFunctions={default:u.tokenizer},u.tokenizer.registerFunction=function(i,s){s in this.registeredFunctions&&u.utils.warn("Overwriting existing tokenizer: "+s),i.label=s,this.registeredFunctions[s]=i},u.Pipeline=function(){this._stack=[]},u.Pipeline.registeredFunctions={},u.Pipeline.registerFunction=function(i,s){s in this.registeredFunctions&&u.utils.warn("Overwriting existing registered function: "+s),i.label=s,u.Pipeline.registeredFunctions[i.label]=i},u.Pipeline.warnIfFunctionNotRegistered=function(i){i.label&&i.label in this.registeredFunctions||u.utils.warn(`Function is not registered with pipeline. This may cause problems when serialising the index.
`,i)},u.Pipeline.load=function(i){var s=new u.Pipeline;return i.forEach(function(w){var m=u.Pipeline.registeredFunctions[w];if(!m)throw new Error("Cannot load un-registered function: "+w);s.add(m)}),s},u.Pipeline.prototype.add=function(){Array.prototype.slice.call(arguments).forEach(function(i){u.Pipeline.warnIfFunctionNotRegistered(i),this._stack.push(i)},this)},u.Pipeline.prototype.after=function(i,s){u.Pipeline.warnIfFunctionNotRegistered(s);var w=this._stack.indexOf(i);if(w==-1)throw new Error("Cannot find existingFn");this._stack.splice(w+=1,0,s)},u.Pipeline.prototype.before=function(i,s){u.Pipeline.warnIfFunctionNotRegistered(s);var w=this._stack.indexOf(i);if(w==-1)throw new Error("Cannot find existingFn");this._stack.splice(w,0,s)},u.Pipeline.prototype.remove=function(i){var s=this._stack.indexOf(i);s!=-1&&this._stack.splice(s,1)},u.Pipeline.prototype.run=function(i){for(var s=[],w=i.length,m=this._stack.length,b=0;b<w;b++){for(var j=i[b],z=0;z<m&&(j=this._stack[z](j,b,i))!==void 0&&j!=="";z++);j!==void 0&&j!==""&&s.push(j)}return s},u.Pipeline.prototype.reset=function(){this._stack=[]},u.Pipeline.prototype.toJSON=function(){return this._stack.map(function(i){return u.Pipeline.warnIfFunctionNotRegistered(i),i.label})},u.Vector=function(){this._magnitude=null,this.list=void 0,this.length=0},u.Vector.Node=function(i,s,w){this.idx=i,this.val=s,this.next=w},u.Vector.prototype.insert=function(i,s){this._magnitude=void 0;var w=this.list;if(!w)return this.list=new u.Vector.Node(i,s,w),this.length++;if(i<w.idx)return this.list=new u.Vector.Node(i,s,w),this.length++;for(var m=w,b=w.next;b!=null;){if(i<b.idx)return m.next=new u.Vector.Node(i,s,b),this.length++;m=b,b=b.next}return m.next=new u.Vector.Node(i,s,b),this.length++},u.Vector.prototype.magnitude=function(){if(this._magnitude)return this._magnitude;for(var i,s=this.list,w=0;s;)w+=(i=s.val)*i,s=s.next;return this._magnitude=Math.sqrt(w)},u.Vector.prototype.dot=function(i){for(var s=this.list,w=i.list,m=0;s&&w;)s.idx<w.idx?s=s.next:(s.idx>w.idx||(m+=s.val*w.val,s=s.next),w=w.next);return m},u.Vector.prototype.similarity=function(i){return this.dot(i)/(this.magnitude()*i.magnitude())},u.SortedSet=function(){this.length=0,this.elements=[]},u.SortedSet.load=function(i){var s=new this;return s.elements=i,s.length=i.length,s},u.SortedSet.prototype.add=function(){var i,s;for(i=0;i<arguments.length;i++)~this.indexOf(s=arguments[i])||this.elements.splice(this.locationFor(s),0,s);this.length=this.elements.length},u.SortedSet.prototype.toArray=function(){return this.elements.slice()},u.SortedSet.prototype.map=function(i,s){return this.elements.map(i,s)},u.SortedSet.prototype.forEach=function(i,s){return this.elements.forEach(i,s)},u.SortedSet.prototype.indexOf=function(i){for(var s=0,w=this.elements.length,m=w-s,b=s+Math.floor(m/2),j=this.elements[b];m>1;){if(j===i)return b;j<i&&(s=b),j>i&&(w=b),m=w-s,b=s+Math.floor(m/2),j=this.elements[b]}return j===i?b:-1},u.SortedSet.prototype.locationFor=function(i){for(var s=0,w=this.elements.length,m=w-s,b=s+Math.floor(m/2),j=this.elements[b];m>1;)j<i&&(s=b),j>i&&(w=b),m=w-s,b=s+Math.floor(m/2),j=this.elements[b];return j>i?b:j<i?b+1:void 0},u.SortedSet.prototype.intersect=function(i){for(var s=new u.SortedSet,w=0,m=0,b=this.length,j=i.length,z=this.elements,N=i.elements;!(w>b-1||m>j-1);)z[w]!==N[m]?z[w]<N[m]?w++:z[w]>N[m]&&m++:(s.add(z[w]),w++,m++);return s},u.SortedSet.prototype.clone=function(){var i=new u.SortedSet;return i.elements=this.toArray(),i.length=i.elements.length,i},u.SortedSet.prototype.union=function(i){var s,w,m;this.length>=i.length?(s=this,w=i):(s=i,w=this),m=s.clone();for(var b=0,j=w.toArray();b<j.length;b++)m.add(j[b]);return m},u.SortedSet.prototype.toJSON=function(){return this.toArray()},u.Index=function(){this._fields=[],this._ref="id",this.pipeline=new u.Pipeline,this.documentStore=new u.Store,this.tokenStore=new u.TokenStore,this.corpusTokens=new u.SortedSet,this.eventEmitter=new u.EventEmitter,this.tokenizerFn=u.tokenizer,this._idfCache={},this.on("add","remove","update",(function(){this._idfCache={}}).bind(this))},u.Index.prototype.on=function(){var i=Array.prototype.slice.call(arguments);return this.eventEmitter.addListener.apply(this.eventEmitter,i)},u.Index.prototype.off=function(i,s){return this.eventEmitter.removeListener(i,s)},u.Index.load=function(i){i.version!==u.version&&u.utils.warn("version mismatch: current "+u.version+" importing "+i.version);var s=new this;return s._fields=i.fields,s._ref=i.ref,s.tokenizer(u.tokenizer.load(i.tokenizer)),s.documentStore=u.Store.load(i.documentStore),s.tokenStore=u.TokenStore.load(i.tokenStore),s.corpusTokens=u.SortedSet.load(i.corpusTokens),s.pipeline=u.Pipeline.load(i.pipeline),s},u.Index.prototype.field=function(i,s){return this._fields.push({name:i,boost:(s=s||{}).boost||1}),this},u.Index.prototype.ref=function(i){return this._ref=i,this},u.Index.prototype.tokenizer=function(i){return i.label&&i.label in u.tokenizer.registeredFunctions||u.utils.warn("Function is not a registered tokenizer. This may cause problems when serialising the index"),this.tokenizerFn=i,this},u.Index.prototype.add=function(i,s){var w={},m=new u.SortedSet,b=i[this._ref];s=s===void 0||s,this._fields.forEach(function(De){var pe=this.pipeline.run(this.tokenizerFn(i[De.name]));w[De.name]=pe;for(var we=0;we<pe.length;we++){var Le=pe[we];m.add(Le),this.corpusTokens.add(Le)}},this),this.documentStore.set(b,m);for(var j=0;j<m.length;j++){for(var z=m.elements[j],N=0,T=0;T<this._fields.length;T++){var he=this._fields[T],Ce=w[he.name],Oe=Ce.length;if(Oe){for(var Z=0,de=0;de<Oe;de++)Ce[de]===z&&Z++;N+=Z/Oe*he.boost}}this.tokenStore.add(z,{ref:b,tf:N})}s&&this.eventEmitter.emit("add",i,this)},u.Index.prototype.remove=function(i,s){var w=i[this._ref];if(s=s===void 0||s,this.documentStore.has(w)){var m=this.documentStore.get(w);this.documentStore.remove(w),m.forEach(function(b){this.tokenStore.remove(b,w)},this),s&&this.eventEmitter.emit("remove",i,this)}},u.Index.prototype.update=function(i,s){s=s===void 0||s,this.remove(i,!1),this.add(i,!1),s&&this.eventEmitter.emit("update",i,this)},u.Index.prototype.idf=function(i){var s="@"+i;if(Object.prototype.hasOwnProperty.call(this._idfCache,s))return this._idfCache[s];var w=this.tokenStore.count(i),m=1;return w>0&&(m=1+Math.log(this.documentStore.length/w)),this._idfCache[s]=m},u.Index.prototype.search=function(i){var s=this.pipeline.run(this.tokenizerFn(i)),w=new u.Vector,m=[],b=this._fields.reduce(function(j,z){return j+z.boost},0);return s.some(function(j){return this.tokenStore.has(j)},this)?(s.forEach(function(j,z,N){var T=1/N.length*this._fields.length*b,he=this,Ce=this.tokenStore.expand(j).reduce(function(Oe,Z){var de=he.corpusTokens.indexOf(Z),De=he.idf(Z),pe=1,we=new u.SortedSet;if(Z!==j){var Le=Math.max(3,Z.length-j.length);pe=1/Math.log(Le)}de>-1&&w.insert(de,T*De*pe);for(var zr=he.tokenStore.get(Z),Pr=Object.keys(zr),Yo=Pr.length,wt=0;wt<Yo;wt++)we.add(zr[Pr[wt]].ref);return Oe.union(we)},new u.SortedSet);m.push(Ce)},this),m.reduce(function(j,z){return j.intersect(z)}).map(function(j){return{ref:j,score:w.similarity(this.documentVector(j))}},this).sort(function(j,z){return z.score-j.score})):[]},u.Index.prototype.documentVector=function(i){for(var s=this.documentStore.get(i),w=s.length,m=new u.Vector,b=0;b<w;b++){var j=s.elements[b],z=this.tokenStore.get(j)[i].tf,N=this.idf(j);m.insert(this.corpusTokens.indexOf(j),z*N)}return m},u.Index.prototype.toJSON=function(){return{version:u.version,fields:this._fields,ref:this._ref,tokenizer:this.tokenizerFn.label,documentStore:this.documentStore.toJSON(),tokenStore:this.tokenStore.toJSON(),corpusTokens:this.corpusTokens.toJSON(),pipeline:this.pipeline.toJSON()}},u.Index.prototype.use=function(i){var s=Array.prototype.slice.call(arguments,1);s.unshift(this),i.apply(this,s)},u.Store=function(){this.store={},this.length=0},u.Store.load=function(i){var s=new this;return s.length=i.length,s.store=Object.keys(i.store).reduce(function(w,m){return w[m]=u.SortedSet.load(i.store[m]),w},{}),s},u.Store.prototype.set=function(i,s){this.has(i)||this.length++,this.store[i]=s},u.Store.prototype.get=function(i){return this.store[i]},u.Store.prototype.has=function(i){return i in this.store},u.Store.prototype.remove=function(i){this.has(i)&&(delete this.store[i],this.length--)},u.Store.prototype.toJSON=function(){return{store:this.store,length:this.length}},u.stemmer=(o={ational:"ate",tional:"tion",enci:"ence",anci:"ance",izer:"ize",bli:"ble",alli:"al",entli:"ent",eli:"e",ousli:"ous",ization:"ize",ation:"ate",ator:"ate",alism:"al",iveness:"ive",fulness:"ful",ousness:"ous",aliti:"al",iviti:"ive",biliti:"ble",logi:"log"},a={icate:"ic",ative:"",alize:"al",iciti:"ic",ical:"ic",ful:"",ness:""},f="^("+(h="[^aeiou][^aeiouy]*")+")?"+(d=(c="[aeiouy]")+"[aeiou]*")+h+"("+d+")?$",p="^("+h+")?"+d+h+d+h,y="^("+h+")?"+c,g=new RegExp("^("+h+")?"+d+h),l=new RegExp(p),v=new RegExp(f),_=new RegExp(y),S=/^(.+?)(ss|i)es$/,O=/^(.+?)([^s])s$/,I=/^(.+?)eed$/,$=/^(.+?)(ed|ing)$/,M=/.$/,D=/(at|bl|iz)$/,x=new RegExp("([^aeiouylsz])\\1$"),A=new RegExp("^"+h+c+"[^aeiouwxy]$"),V=/^(.+?[^aeiou])y$/,q=/^(.+?)(ational|tional|enci|anci|izer|bli|alli|entli|eli|ousli|ization|ation|ator|alism|iveness|fulness|ousness|aliti|iviti|biliti|logi)$/,fe=/^(.+?)(icate|ative|alize|iciti|ical|ful|ness)$/,C=/^(.+?)(al|ance|ence|er|ic|able|ible|ant|ement|ment|ent|ou|ism|ate|iti|ous|ive|ize)$/,U=/^(.+?)(s|t)(ion)$/,B=/^(.+?)e$/,Q=/ll$/,X=new RegExp("^"+h+c+"[^aeiouwxy]$"),function(i){var s,w,m,b,j,z,N;if(i.length<3)return i;if((m=i.substr(0,1))=="y"&&(i=m.toUpperCase()+i.substr(1)),j=O,(b=S).test(i)?i=i.replace(b,"$1$2"):j.test(i)&&(i=i.replace(j,"$1$2")),j=$,(b=I).test(i)){var T=b.exec(i);(b=g).test(T[1])&&(i=i.replace(b=M,""))}else j.test(i)&&(T=j.exec(i),(j=_).test(s=T[1])&&(z=x,N=A,(j=D).test(i=s)?i+="e":z.test(i)?i=i.replace(b=M,""):N.test(i)&&(i+="e")));return(b=V).test(i)&&(i=(s=(T=b.exec(i))[1])+"i"),(b=q).test(i)&&(w=(T=b.exec(i))[2],(b=g).test(s=T[1])&&(i=s+o[w])),(b=fe).test(i)&&(w=(T=b.exec(i))[2],(b=g).test(s=T[1])&&(i=s+a[w])),j=U,(b=C).test(i)?(T=b.exec(i),(b=l).test(s=T[1])&&(i=s)):j.test(i)&&(T=j.exec(i),(j=l).test(s=T[1]+T[2])&&(i=s)),(b=B).test(i)&&(T=b.exec(i),j=v,z=X,((b=l).test(s=T[1])||j.test(s)&&!z.test(s))&&(i=s)),j=l,(b=Q).test(i)&&j.test(i)&&(i=i.replace(b=M,"")),m=="y"&&(i=m.toLowerCase()+i.substr(1)),i}),u.Pipeline.registerFunction(u.stemmer,"stemmer"),u.generateStopWordFilter=function(i){var s=i.reduce(function(w,m){return w[m]=m,w},{});return function(w){if(w&&s[w]!==w)return w}},u.stopWordFilter=u.generateStopWordFilter(["a","able","about","across","after","all","almost","also","am","among","an","and","any","are","as","at","be","because","been","but","by","can","cannot","could","dear","did","do","does","either","else","ever","every","for","from","get","got","had","has","have","he","her","hers","him","his","how","however","i","if","in","into","is","it","its","just","least","let","like","likely","may","me","might","most","must","my","neither","no","nor","not","of","off","often","on","only","or","other","our","own","rather","said","say","says","she","should","since","so","some","than","that","the","their","them","then","there","these","they","this","tis","to","too","twas","us","wants","was","we","were","what","when","where","which","while","who","whom","why","will","with","would","yet","you","your"]),u.Pipeline.registerFunction(u.stopWordFilter,"stopWordFilter"),u.trimmer=function(i){return i.replace(/^\W+/,"").replace(/\W+$/,"")},u.Pipeline.registerFunction(u.trimmer,"trimmer"),u.TokenStore=function(){this.root={docs:{}},this.length=0},u.TokenStore.load=function(i){var s=new this;return s.root=i.root,s.length=i.length,s},u.TokenStore.prototype.add=function(i,s,w){w=w||this.root;var m=i.charAt(0),b=i.slice(1);return m in w||(w[m]={docs:{}}),b.length===0?(w[m].docs[s.ref]=s,void(this.length+=1)):this.add(b,s,w[m])},u.TokenStore.prototype.has=function(i){if(!i)return!1;for(var s=this.root,w=0;w<i.length;w++){if(!s[i.charAt(w)])return!1;s=s[i.charAt(w)]}return!0},u.TokenStore.prototype.getNode=function(i){if(!i)return{};for(var s=this.root,w=0;w<i.length;w++){if(!s[i.charAt(w)])return{};s=s[i.charAt(w)]}return s},u.TokenStore.prototype.get=function(i,s){return this.getNode(i,s).docs||{}},u.TokenStore.prototype.count=function(i,s){return Object.keys(this.get(i,s)).length},u.TokenStore.prototype.remove=function(i,s){if(i){for(var w=this.root,m=0;m<i.length;m++){if(!(i.charAt(m)in w))return;w=w[i.charAt(m)]}delete w.docs[s]}},u.TokenStore.prototype.expand=function(i,s){var w=this.getNode(i);return s=s||[],Object.keys(w.docs||{}).length&&s.push(i),Object.keys(w).forEach(function(m){m!=="docs"&&s.concat(this.expand(i+m,s))},this),s},u.TokenStore.prototype.toJSON=function(){return{root:this.root,length:this.length}},t.exports=u})()}(r),r.exports}();class kr{constructor(r,t){this.store=new Map,this.idx=We(function(){this.field("name",{boost:10}),((t==null?void 0:t.searchableFields)||[]).forEach(o=>this.field(o)),this.ref("_id"),t!=null&&t.isExactSearch&&(this.pipeline.remove(We.stemmer),this.pipeline.remove(We.stopWordFilter)),t!=null&&t.removeStopWordFilter&&this.pipeline.remove(We.stopWordFilter)});let n=1;(r||[]).map(o=>{o._id=n,++n,this.idx.add(o),this.store.set(o._id,o)})}search_full(r,t){return this.search(r,t).map(n=>this.store.get(n))}search(r,t){return t instanceof Function?(r?this.idx.search(r).map(n=>this.store.get(n.ref)):[...this.store.values()]).filter(t).map(n=>n._id):r?this.idx.search(r).map(n=>n.ref):[...this.store.keys()]}}class Ar{constructor(r,t){(t=t||Object.create(null)).aggregations=t.aggregations||Object.create(null),this._items=r,this.config=t.aggregations,this.facets=function(c,h){h=h||[];const d={data:Object.create(null),bits_data:Object.create(null),bits_data_temp:Object.create(null)};let f=1;return h.forEach(p=>{d.data[p]=Object.create(null)}),c&&c.map(p=>(p._id||(p._id=f,++f),p)),c&&c.map(p=>(h.forEach(y=>{if(p){if(Array.isArray(p[y]))p[y].forEach(g=>{p[y]&&(d.data[y][g]||(d.data[y][g]=[]),d.data[y][g].push(parseInt(p._id)))});else if(p[y]!==void 0){const g=p[y];d.data[y][g]||(d.data[y][g]=[]),d.data[y][g].push(parseInt(p._id))}}}),p)),d.data=E(d.data,function(p,y){return d.bits_data[y]||(d.bits_data[y]=Object.create(null),d.bits_data_temp[y]=Object.create(null)),E(p,function(g,l){const v=Do(g);return d.bits_data[y][l]=new R(v),v})}),d}(r,_e(t.aggregations)),this._items_map=Object.create(null),this._ids=[];let n=1;var o,a;a=c=>{this._ids.push(n),this._items_map[n]=c,c._id=n,++n},(W(o=r)?ce:vr)(o,ie(a)),this.ids_map=Object.create(null),r&&r.forEach(c=>{const h=t.custom_id_field||"id";c[h]&&c._id&&(this.ids_map[c[h]]=c._id)}),this._bits_ids=new R(this._ids)}items(){return this._items}bits_ids(r){return r?new R(r):this._bits_ids}internal_ids_from_ids_map(r){return r.map(t=>this.ids_map[t])}index(){return this.facets}get_item(r){return this._items_map[r]}search(r,t){const n=this.config;t=t||Object.create(null);const o=ut(this.facets);let a;o.not_ids=Or(o.bits_data,r.not_filters);const c=function(h,d){const f=[];return E(h.filters,function(p,y){if(p&&p.length)if(d[y].conjunction!==!1)E(p,function(g){f.push([y,g])});else{const g=[];E(p,function(l){g.push([y,l])}),f.push(g)}}),E(h.not_filters,function(p,y){p&&p.length&&E(p,function(g){f.push([y,"-",g])})}),f}(r,n);return a=function(h,d){const f=ut(h);let p;d=d||[],E(f.bits_data,function(g,l){E(f.bits_data[l],function(v,_){f.bits_data_temp[l][_]=f.bits_data[l][_]})}),f.is_temp_copied=!0;const y=function(g,l){const v=Object.create(null);return E(l,function(_){if(Array.isArray(_[0])){let S=new R([]);E(_,function(O){const I=O[0];S=S.new_union(g.bits_data[I][O[1]]||new R([])),v[I]=S})}}),v}(h,d);return E(d,function(g){if(!Array.isArray(g[0])){const l=g[0],v=g[1];p=p&&f.bits_data_temp[l][v]?f.bits_data_temp[l][v].new_intersection(p):p&&!f.bits_data_temp[l][v]?new R([]):f.bits_data_temp[l][v]}}),p&&E(f.bits_data_temp,function(g,l){E(f.bits_data_temp[l],function(v,_){f.bits_data_temp[l][_]=f.bits_data_temp[l][_].new_intersection(p)})}),E(d,function(g){if(g.length===3&&g[1]==="-"){const l=f.bits_data_temp[g[0]][g[2]].clone();E(f.bits_data_temp,function(v,_){E(f.bits_data_temp[_],function(S,O){f.bits_data_temp[_][O]=f.bits_data_temp[_][O].new_difference(l)})})}}),E(f.bits_data_temp,function(g,l){E(f.bits_data_temp[l],function(v,_){E(y,function(S,O){O!==l&&(f.bits_data_temp[l][_]=f.bits_data_temp[l][_].new_intersection(S))})})}),f}(this.facets,c),r.filters_query&&(a=function(h,d){const f=ut(h);f.is_temp_copied||E(f.bits_data,function(y,g){E(f.bits_data[g],function(l,v){f.bits_data_temp[g][v]=f.bits_data[g][v]})});let p=null;return E(d,function(y){let g=null;E(y,function(l){const v=l[0],_=l[1];if(!f.bits_data_temp[v])throw new Error("Panic. The key does not exist in facets lists.");g=g&&f.bits_data_temp[v][_]?f.bits_data_temp[v][_].new_intersection(g):g&&!f.bits_data_temp[v][_]?new R([]):f.bits_data_temp[v][_]}),p=(p||new R([])).new_union(g||new R([]))}),p!==null&&E(f.bits_data_temp,function(y,g){E(f.bits_data_temp[g],function(l,v){f.bits_data_temp[g][v]=f.bits_data_temp[g][v].new_intersection(p)})}),f}(a,Vo(r.filters_query).map(h=>Array.isArray(h)?h.map(d=>Array.isArray(d)?d.map(f=>f):d.split(":")):h.split(":")))),o.bits_data_temp=a.bits_data_temp,E(o.bits_data_temp,function(h,d){E(o.bits_data_temp[d],function(f,p){t.query_ids&&(o.bits_data_temp[d][p]=t.query_ids.new_intersection(o.bits_data_temp[d][p])),t.test&&(o.data[d][p]=o.bits_data_temp[d][p].array())})}),o.ids=r.filters_query?function(h){let d=new R([]);return E(h,function(f,p){E(h[p],function(y,g){d=d.new_union(h[p][g])})}),d}(o.bits_data_temp):Or(o.bits_data_temp,r.filters),o}}function Er(e,r){let t;(r=r||Object.create(null)).native_search_enabled!==!1&&(t=new kr(e,r));let n=new Ar(e,r);return{search:function(o){return(o=o||Object.create(null)).aggregations=function(a,c){return E(Sr(a),(h,d)=>{h.field||(h.field=d);let f=[];c.filters&&c.filters[d]&&(f=c.filters[d]),h.filters=f;let p=[];return c.not_filters&&c.not_filters[d]&&(p=c.not_filters[d]),c.exclude_filters&&c.exclude_filters[d]&&(p=c.exclude_filters[d]),h.not_filters=p,h})}(r.aggregations,o),xr(0,o,r,t,n)},similar:function(o,a){return function(c,h,d){const f=d.per_page||10,p=d.minimum||0,y=d.page||1;let g;for(let _=0;_<c.length;++_)if(c[_].id==h){g=c[_];break}if(!d.field)throw new Error("Please define field in options");const l=d.field;let v=[];for(let _=0;_<c.length;++_)if(c[_].id!==h){const S=$o(g[l],c[_][l]);S.length>=p&&(v.push(c[_]),v[v.length-1].intersection_length=S.length)}return v=dt(v,["intersection_length"],["desc"]),{pagination:{per_page:f,page:y,total:v.length},data:{items:v.slice((y-1)*f,y*f)}}}(e,o,a)},aggregation:function(o){return function(a,c,h,d,f){const p=c.per_page||10,y=c.page||1;if(c.name&&(!h.aggregations||!h.aggregations[c.name]))throw new Error('Please define aggregation "'.concat(c.name,'" in config'));const g=Sr(c);if(g.page=1,g.per_page=0,!c.name)throw new Error("field name is required");h.aggregations[c.name].size=1e4;const l=xr(0,g,h,d,f).data.aggregations[c.name].buckets;return{pagination:{per_page:p,page:y,total:l.length},data:{buckets:l.slice((y-1)*p,y*p)}}}(0,o,r,t,n)},reindex:function(o){t=new kr(e=o,r),n=new Ar(e,r)}}}const Re={};function Bo(e,r,t){Re[e]||(Re[e]=Er(r,t))}function Jo(e,r,t){Re[e]=Er(r,t)}function Ho({dataSource:e,query:r,page:t=1,perPage:n=25,sort:o="title_asc",filters:a={}}){const c=Re[e];if(!c)throw new Error(`Search engine for ${e} is not initialised`);return c.search({per_page:n,page:t,query:r,sort:o,filters:a})}addEventListener("message",async e=>{const{action:r,payload:t}=e.data;switch(r){case ge.LOAD:{postMessage({action:ge.LOAD});const{basePath:n,dataSource:o,config:a,reload:c=!1}=t,h=await fetch(`${n}/api/search/${o}.json`).then(d=>d.json());c?Jo(o,h,a):Bo(o,h,a),postMessage({action:ge.READY});break}case ge.SEARCH:{const n=Ho(t);postMessage({action:ge.RESULTS,payload:{query:t.query,results:n}});break}}})})();
