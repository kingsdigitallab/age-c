(function(){"use strict";const wt={type:{title:"Type",hide_zero_doc_count:!0,size:2,sort:"key"},releaseType:{title:"Release type",hide_zero_doc_count:!0,size:5,sort:"key"},filmType:{title:"Film type",hide_zero_doc_count:!0,size:5,sort:"key"},genre:{title:"Genre",hide_zero_doc_count:!0,size:100,sort:"key"},productionCountry:{title:"Production country",hide_zero_doc_count:!0,size:100,sort:"key"},productionShare:{title:"Production share",hide_zero_doc_count:!0,size:5,sort:"key"},role:{title:"Role",hide_zero_doc_count:!0,size:100,sort:"key"},gender:{title:"Person gender",hide_zero_doc_count:!0,size:10,sort:"key"},nationality:{title:"Person nationality",hide_zero_doc_count:!0,size:300,sort:"key"},tags:{title:"Tags",hide_zero_doc_count:!0,size:500,sort:"key"},characterAge:{title:"Character age",hide_zero_doc_count:!0,size:10,sort:"key"},characterGender:{title:"Character gender",hide_zero_doc_count:!0,size:10,sort:"key"},characterSexuality:{title:"Character sexuality",hide_zero_doc_count:!0,size:10,sort:"key"},characterOrigin:{title:"Character origin",hide_zero_doc_count:!0,size:50,sort:"key"},characterClass:{title:"Character class",hide_zero_doc_count:!0,size:20,sort:"key"},characterProfession:{title:"Character profession",hide_zero_doc_count:!0,size:10,sort:"key"},characterAbility:{title:"Character ability",hide_zero_doc_count:!0,size:10,sort:"key"},assistedMobility:{title:"Assisted mobility",hide_zero_doc_count:!0,size:10,sort:"key"}},Tr={corpus:{aggregations:wt,searchableFields:["title","name","synopsis",...Object.keys(wt)],sortings:{person_name_asc:{label:"Person name (A-Z)",field:"name",order:"asc"},person_name_desc:{label:"Person name (Z-A)",field:"name",order:"desc"},film_title_asc:{label:"Film title (A-Z)",field:"title",order:"asc"},film_title_desc:{label:"Film title (Z-A)",field:"title",order:"desc"}}}},Oe={LOAD:"load",READY:"ready",SEARCH:"search",RESULTS:"results"};var _t=typeof global=="object"&&global&&global.Object===Object&&global,Fr=typeof self=="object"&&self&&self.Object===Object&&self,J=_t||Fr||Function("return this")(),U=J.Symbol,yt=Object.prototype,Ir=yt.hasOwnProperty,Mr=yt.toString,we=U?U.toStringTag:void 0,$r=Object.prototype.toString,Cr="[object Null]",Nr="[object Undefined]",vt=U?U.toStringTag:void 0;function se(e){return e==null?e===void 0?Nr:Cr:vt&&vt in Object(e)?function(r){var t=Ir.call(r,we),n=r[we];try{r[we]=void 0;var o=!0}catch{}var a=Mr.call(r);return o&&(t?r[we]=n:delete r[we]),a}(e):function(r){return $r.call(r)}(e)}function G(e){return e!=null&&typeof e=="object"}var Wr="[object Symbol]";function ae(e){return typeof e=="symbol"||G(e)&&se(e)==Wr}function ce(e,r){for(var t=-1,n=e==null?0:e.length,o=Array(n);++t<n;)o[t]=r(e[t],t,e);return o}var N=Array.isArray,mt=U?U.prototype:void 0,bt=mt?mt.toString:void 0;function jt(e){if(typeof e=="string")return e;if(N(e))return ce(e,jt)+"";if(ae(e))return bt?bt.call(e):"";var r=e+"";return r=="0"&&1/e==-1/0?"-0":r}function ee(e){var r=typeof e;return e!=null&&(r=="object"||r=="function")}function xe(e){return e}var Rr="[object AsyncFunction]",Dr="[object Function]",Ur="[object GeneratorFunction]",Vr="[object Proxy]";function St(e){if(!ee(e))return!1;var r=se(e);return r==Dr||r==Ur||r==Rr||r==Vr}var Ot,Ue=J["__core-js_shared__"],xt=(Ot=/[^.]+$/.exec(Ue&&Ue.keys&&Ue.keys.IE_PROTO||""))?"Symbol(src)_1."+Ot:"",Lr=Function.prototype.toString;function te(e){if(e!=null){try{return Lr.call(e)}catch{}try{return e+""}catch{}}return""}var qr=/^\[object .+?Constructor\]$/,Br=RegExp("^"+Function.prototype.toString.call(Object.prototype.hasOwnProperty).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function re(e,r){var t=function(n,o){return n==null?void 0:n[o]}(e,r);return function(n){return!(!ee(n)||(o=n,xt&&xt in o))&&(St(n)?Br:qr).test(te(n));var o}(t)?t:void 0}var kt,Ve,Le,qe=re(J,"WeakMap"),zt=Object.create,Jr=function(){function e(){}return function(r){if(!ee(r))return{};if(zt)return zt(r);e.prototype=r;var t=new e;return e.prototype=void 0,t}}(),Hr=Date.now,Gr=function(){try{var e=re(Object,"defineProperty");return e({},"",{}),e}catch{}}(),ke=Gr,Zr=ke?function(e,r){return ke(e,"toString",{configurable:!0,enumerable:!1,value:(t=r,function(){return t}),writable:!0});var t}:xe,Yr=(kt=Zr,Ve=0,Le=0,function(){var e=Hr(),r=16-(e-Le);if(Le=e,r>0){if(++Ve>=800)return arguments[0]}else Ve=0;return kt.apply(void 0,arguments)});function Kr(e){return e!=e}function Qr(e,r){return!(e==null||!e.length)&&function(t,n,o){return n==n?function(a,c,f){for(var d=-1,h=a.length;++d<h;)if(a[d]===c)return d;return-1}(t,n):function(a,c,f,d){for(var h=a.length,p=-1;++p<h;)if(c(a[p],p,a))return p;return-1}(t,Kr)}(e,r)>-1}var Xr=9007199254740991,en=/^(?:0|[1-9]\d*)$/;function Be(e,r){var t=typeof e;return!!(r=r??Xr)&&(t=="number"||t!="symbol"&&en.test(e))&&e>-1&&e%1==0&&e<r}function Je(e,r,t){r=="__proto__"&&ke?ke(e,r,{configurable:!0,enumerable:!0,value:t,writable:!0}):e[r]=t}function ze(e,r){return e===r||e!=e&&r!=r}var tn=Object.prototype.hasOwnProperty;function At(e,r,t){var n=e[r];tn.call(e,r)&&ze(n,t)&&(t!==void 0||r in e)||Je(e,r,t)}function Ae(e,r,t,n){var o=!t;t||(t={});for(var a=-1,c=r.length;++a<c;){var f=r[a],d=void 0;d===void 0&&(d=e[f]),o?Je(t,f,d):At(t,f,d)}return t}var Et=Math.max;function Pt(e,r){return Yr(function(t,n,o){return n=Et(n===void 0?t.length-1:n,0),function(){for(var a=arguments,c=-1,f=Et(a.length-n,0),d=Array(f);++c<f;)d[c]=a[n+c];c=-1;for(var h=Array(n+1);++c<n;)h[c]=a[c];return h[n]=o(d),function(p,y,w){switch(w.length){case 0:return p.call(y);case 1:return p.call(y,w[0]);case 2:return p.call(y,w[0],w[1]);case 3:return p.call(y,w[0],w[1],w[2])}return p.apply(y,w)}(t,this,h)}}(e,r,xe),e+"")}var rn=9007199254740991;function He(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=rn}function ue(e){return e!=null&&He(e.length)&&!St(e)}function Tt(e,r,t){if(!ee(t))return!1;var n=typeof r;return!!(n=="number"?ue(t)&&Be(r,t.length):n=="string"&&r in t)&&ze(t[r],e)}var nn=Object.prototype;function Ge(e){var r=e&&e.constructor;return e===(typeof r=="function"&&r.prototype||nn)}function Ft(e){return G(e)&&se(e)=="[object Arguments]"}var It=Object.prototype,on=It.hasOwnProperty,sn=It.propertyIsEnumerable,Ze=Ft(function(){return arguments}())?Ft:function(e){return G(e)&&on.call(e,"callee")&&!sn.call(e,"callee")},Mt=typeof exports=="object"&&exports&&!exports.nodeType&&exports,$t=Mt&&typeof module=="object"&&module&&!module.nodeType&&module,Ct=$t&&$t.exports===Mt?J.Buffer:void 0,Ee=(Ct?Ct.isBuffer:void 0)||function(){return!1},F={};function Pe(e){return function(r){return e(r)}}F["[object Float32Array]"]=F["[object Float64Array]"]=F["[object Int8Array]"]=F["[object Int16Array]"]=F["[object Int32Array]"]=F["[object Uint8Array]"]=F["[object Uint8ClampedArray]"]=F["[object Uint16Array]"]=F["[object Uint32Array]"]=!0,F["[object Arguments]"]=F["[object Array]"]=F["[object ArrayBuffer]"]=F["[object Boolean]"]=F["[object DataView]"]=F["[object Date]"]=F["[object Error]"]=F["[object Function]"]=F["[object Map]"]=F["[object Number]"]=F["[object Object]"]=F["[object RegExp]"]=F["[object Set]"]=F["[object String]"]=F["[object WeakMap]"]=!1;var Nt=typeof exports=="object"&&exports&&!exports.nodeType&&exports,_e=Nt&&typeof module=="object"&&module&&!module.nodeType&&module,Ye=_e&&_e.exports===Nt&&_t.process,le=function(){try{return _e&&_e.require&&_e.require("util").types||Ye&&Ye.binding&&Ye.binding("util")}catch{}}(),Wt=le&&le.isTypedArray,Rt=Wt?Pe(Wt):function(e){return G(e)&&He(e.length)&&!!F[se(e)]},an=Object.prototype.hasOwnProperty;function Dt(e,r){var t=N(e),n=!t&&Ze(e),o=!t&&!n&&Ee(e),a=!t&&!n&&!o&&Rt(e),c=t||n||o||a,f=c?function(p,y){for(var w=-1,l=Array(p);++w<p;)l[w]=y(w);return l}(e.length,String):[],d=f.length;for(var h in e)!r&&!an.call(e,h)||c&&(h=="length"||o&&(h=="offset"||h=="parent")||a&&(h=="buffer"||h=="byteLength"||h=="byteOffset")||Be(h,d))||f.push(h);return f}function Ut(e,r){return function(t){return e(r(t))}}var cn=Ut(Object.keys,Object),un=Object.prototype.hasOwnProperty;function ye(e){return ue(e)?Dt(e):function(r){if(!Ge(r))return cn(r);var t=[];for(var n in Object(r))un.call(r,n)&&n!="constructor"&&t.push(n);return t}(e)}var ln=Object.prototype.hasOwnProperty;function hn(e){return ue(e)?Dt(e,!0):function(r){if(!ee(r))return function(a){var c=[];if(a!=null)for(var f in Object(a))c.push(f);return c}(r);var t=Ge(r),n=[];for(var o in r)(o!="constructor"||!t&&ln.call(r,o))&&n.push(o);return n}(e)}var fn=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,dn=/^\w*$/;function Ke(e,r){if(N(e))return!1;var t=typeof e;return!(t!="number"&&t!="symbol"&&t!="boolean"&&e!=null&&!ae(e))||dn.test(e)||!fn.test(e)||r!=null&&e in Object(r)}var ve=re(Object,"create"),pn=Object.prototype.hasOwnProperty,gn=Object.prototype.hasOwnProperty;function ne(e){var r=-1,t=e==null?0:e.length;for(this.clear();++r<t;){var n=e[r];this.set(n[0],n[1])}}function Te(e,r){for(var t=e.length;t--;)if(ze(e[t][0],r))return t;return-1}ne.prototype.clear=function(){this.__data__=ve?ve(null):{},this.size=0},ne.prototype.delete=function(e){var r=this.has(e)&&delete this.__data__[e];return this.size-=r?1:0,r},ne.prototype.get=function(e){var r=this.__data__;if(ve){var t=r[e];return t==="__lodash_hash_undefined__"?void 0:t}return pn.call(r,e)?r[e]:void 0},ne.prototype.has=function(e){var r=this.__data__;return ve?r[e]!==void 0:gn.call(r,e)},ne.prototype.set=function(e,r){var t=this.__data__;return this.size+=this.has(e)?0:1,t[e]=ve&&r===void 0?"__lodash_hash_undefined__":r,this};var wn=Array.prototype.splice;function Z(e){var r=-1,t=e==null?0:e.length;for(this.clear();++r<t;){var n=e[r];this.set(n[0],n[1])}}Z.prototype.clear=function(){this.__data__=[],this.size=0},Z.prototype.delete=function(e){var r=this.__data__,t=Te(r,e);return!(t<0||(t==r.length-1?r.pop():wn.call(r,t,1),--this.size,0))},Z.prototype.get=function(e){var r=this.__data__,t=Te(r,e);return t<0?void 0:r[t][1]},Z.prototype.has=function(e){return Te(this.__data__,e)>-1},Z.prototype.set=function(e,r){var t=this.__data__,n=Te(t,e);return n<0?(++this.size,t.push([e,r])):t[n][1]=r,this};var me=re(J,"Map");function Fe(e,r){var t,n,o=e.__data__;return((n=typeof(t=r))=="string"||n=="number"||n=="symbol"||n=="boolean"?t!=="__proto__":t===null)?o[typeof r=="string"?"string":"hash"]:o.map}function Y(e){var r=-1,t=e==null?0:e.length;for(this.clear();++r<t;){var n=e[r];this.set(n[0],n[1])}}function Qe(e,r){if(typeof e!="function"||r!=null&&typeof r!="function")throw new TypeError("Expected a function");var t=function(){var n=arguments,o=r?r.apply(this,n):n[0],a=t.cache;if(a.has(o))return a.get(o);var c=e.apply(this,n);return t.cache=a.set(o,c)||a,c};return t.cache=new(Qe.Cache||Y),t}Y.prototype.clear=function(){this.size=0,this.__data__={hash:new ne,map:new(me||Z),string:new ne}},Y.prototype.delete=function(e){var r=Fe(this,e).delete(e);return this.size-=r?1:0,r},Y.prototype.get=function(e){return Fe(this,e).get(e)},Y.prototype.has=function(e){return Fe(this,e).has(e)},Y.prototype.set=function(e,r){var t=Fe(this,e),n=t.size;return t.set(e,r),this.size+=t.size==n?0:1,this},Qe.Cache=Y;var Xe,et,_n=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,yn=/\\(\\)?/g,vn=(Xe=Qe(function(e){var r=[];return e.charCodeAt(0)===46&&r.push(""),e.replace(_n,function(t,n,o,a){r.push(o?a.replace(yn,"$1"):n||t)}),r},function(e){return et.size===500&&et.clear(),e}),et=Xe.cache,Xe);function Vt(e,r){return N(e)?e:Ke(e,r)?[e]:vn(function(t){return t==null?"":jt(t)}(e))}function Ie(e){if(typeof e=="string"||ae(e))return e;var r=e+"";return r=="0"&&1/e==-1/0?"-0":r}function tt(e,r){for(var t=0,n=(r=Vt(r,e)).length;e!=null&&t<n;)e=e[Ie(r[t++])];return t&&t==n?e:void 0}function rt(e,r){for(var t=-1,n=r.length,o=e.length;++t<n;)e[o+t]=r[t];return e}var Lt=U?U.isConcatSpreadable:void 0;function mn(e){return N(e)||Ze(e)||!!(Lt&&e&&e[Lt])}function bn(e,r,t,n,o){var a=-1,c=e.length;for(t||(t=mn),o||(o=[]);++a<c;){var f=e[a];t(f)?rt(o,f):o[o.length]=f}return o}var qt=Ut(Object.getPrototypeOf,Object);function H(e){var r=this.__data__=new Z(e);this.size=r.size}H.prototype.clear=function(){this.__data__=new Z,this.size=0},H.prototype.delete=function(e){var r=this.__data__,t=r.delete(e);return this.size=r.size,t},H.prototype.get=function(e){return this.__data__.get(e)},H.prototype.has=function(e){return this.__data__.has(e)},H.prototype.set=function(e,r){var t=this.__data__;if(t instanceof Z){var n=t.__data__;if(!me||n.length<199)return n.push([e,r]),this.size=++t.size,this;t=this.__data__=new Y(n)}return t.set(e,r),this.size=t.size,this};var Bt=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Jt=Bt&&typeof module=="object"&&module&&!module.nodeType&&module,Ht=Jt&&Jt.exports===Bt?J.Buffer:void 0,Gt=Ht?Ht.allocUnsafe:void 0;function Zt(){return[]}var jn=Object.prototype.propertyIsEnumerable,Yt=Object.getOwnPropertySymbols,Sn=Yt?function(e){return e==null?[]:(e=Object(e),function(r,t){for(var n=-1,o=r==null?0:r.length,a=0,c=[];++n<o;){var f=r[n];jn.call(e,f)&&(c[a++]=f)}return c}(Yt(e)))}:Zt,nt=Sn,On=Object.getOwnPropertySymbols?function(e){for(var r=[];e;)rt(r,nt(e)),e=qt(e);return r}:Zt;function xn(e,r,t){var n=r(e);return N(e)?n:rt(n,t(e))}function ot(e){return xn(e,ye,nt)}var it=re(J,"DataView"),st=re(J,"Promise"),at=re(J,"Set"),Kt="[object Map]",Qt="[object Promise]",Xt="[object Set]",er="[object WeakMap]",tr="[object DataView]",kn=te(it),zn=te(me),An=te(st),En=te(at),Pn=te(qe),oe=se;(it&&oe(new it(new ArrayBuffer(1)))!=tr||me&&oe(new me)!=Kt||st&&oe(st.resolve())!=Qt||at&&oe(new at)!=Xt||qe&&oe(new qe)!=er)&&(oe=function(e){var r=se(e),t=r=="[object Object]"?e.constructor:void 0,n=t?te(t):"";if(n)switch(n){case kn:return tr;case zn:return Kt;case An:return Qt;case En:return Xt;case Pn:return er}return r});var be=oe,Tn=Object.prototype.hasOwnProperty,Me=J.Uint8Array;function Fn(e){var r=new e.constructor(e.byteLength);return new Me(r).set(new Me(e)),r}var In=/\w*$/,rr=U?U.prototype:void 0,nr=rr?rr.valueOf:void 0,Mn="[object Boolean]",$n="[object Date]",Cn="[object Map]",Nn="[object Number]",Wn="[object RegExp]",Rn="[object Set]",Dn="[object String]",Un="[object Symbol]",Vn="[object ArrayBuffer]",Ln="[object DataView]",qn="[object Float32Array]",Bn="[object Float64Array]",Jn="[object Int8Array]",Hn="[object Int16Array]",Gn="[object Int32Array]",Zn="[object Uint8Array]",Yn="[object Uint8ClampedArray]",Kn="[object Uint16Array]",Qn="[object Uint32Array]",or=le&&le.isMap,Xn=or?Pe(or):function(e){return G(e)&&be(e)=="[object Map]"},ir=le&&le.isSet,eo=ir?Pe(ir):function(e){return G(e)&&be(e)=="[object Set]"},to=2,sr="[object Arguments]",ar="[object Function]",ro="[object GeneratorFunction]",cr="[object Object]",P={};function $e(e,r,t,n,o,a){var c,f=r&to;if(c!==void 0)return c;if(!ee(e))return e;var d=N(e);if(d)return c=function(l){var _=l.length,v=new l.constructor(_);return _&&typeof l[0]=="string"&&Tn.call(l,"index")&&(v.index=l.index,v.input=l.input),v}(e),function(l,_){var v=-1,S=l.length;for(_||(_=Array(S));++v<S;)_[v]=l[v];return _}(e,c);var h=be(e),p=h==ar||h==ro;if(Ee(e))return function(l,_){var v=l.length,S=Gt?Gt(v):new l.constructor(v);return l.copy(S),S}(e);if(h==cr||h==sr||p&&!o)return c=p?{}:function(l){return typeof l.constructor!="function"||Ge(l)?{}:Jr(qt(l))}(e),f?function(l,_){return Ae(l,On(l),_)}(e,function(l,_){return l&&Ae(_,hn(_),l)}(c,e)):function(l,_){return Ae(l,nt(l),_)}(e,function(l,_){return l&&Ae(_,ye(_),l)}(c,e));if(!P[h])return o?e:{};c=function(l,_,v){var S,O,I=l.constructor;switch(_){case Vn:return Fn(l);case Mn:case $n:return new I(+l);case Ln:return function($,M){var D=$.buffer;return new $.constructor(D,$.byteOffset,$.byteLength)}(l);case qn:case Bn:case Jn:case Hn:case Gn:case Zn:case Yn:case Kn:case Qn:return function($,M){var D=$.buffer;return new $.constructor(D,$.byteOffset,$.length)}(l);case Cn:return new I;case Nn:case Dn:return new I(l);case Wn:return(O=new(S=l).constructor(S.source,In.exec(S))).lastIndex=S.lastIndex,O;case Rn:return new I;case Un:return nr?Object(nr.call(l)):{}}}(e,h),a||(a=new H);var y=a.get(e);if(y)return y;a.set(e,c),eo(e)?e.forEach(function(l){c.add($e(l,r,t,l,e,a))}):Xn(e)&&e.forEach(function(l,_){c.set(_,$e(l,r,t,_,e,a))});var w=d?void 0:ot(e);return function(l,_){for(var v=-1,S=l==null?0:l.length;++v<S&&_(l[v],v)!==!1;);}(w||e,function(l,_){w&&(l=e[_=l]),At(c,_,$e(l,r,t,_,e,a))}),c}function ct(e){return $e(e,4)}function je(e){var r=-1,t=e==null?0:e.length;for(this.__data__=new Y;++r<t;)this.add(e[r])}function no(e,r){for(var t=-1,n=e==null?0:e.length;++t<n;)if(r(e[t],t,e))return!0;return!1}function ut(e,r){return e.has(r)}P[sr]=P["[object Array]"]=P["[object ArrayBuffer]"]=P["[object DataView]"]=P["[object Boolean]"]=P["[object Date]"]=P["[object Float32Array]"]=P["[object Float64Array]"]=P["[object Int8Array]"]=P["[object Int16Array]"]=P["[object Int32Array]"]=P["[object Map]"]=P["[object Number]"]=P[cr]=P["[object RegExp]"]=P["[object Set]"]=P["[object String]"]=P["[object Symbol]"]=P["[object Uint8Array]"]=P["[object Uint8ClampedArray]"]=P["[object Uint16Array]"]=P["[object Uint32Array]"]=!0,P["[object Error]"]=P[ar]=P["[object WeakMap]"]=!1,je.prototype.add=je.prototype.push=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},je.prototype.has=function(e){return this.__data__.has(e)};var oo=1,io=2;function ur(e,r,t,n,o,a){var c=t&oo,f=e.length,d=r.length;if(f!=d&&!(c&&d>f))return!1;var h=a.get(e),p=a.get(r);if(h&&p)return h==r&&p==e;var y=-1,w=!0,l=t&io?new je:void 0;for(a.set(e,r),a.set(r,e);++y<f;){var _=e[y],v=r[y];if(n)var S=c?n(v,_,y,r,e,a):n(_,v,y,e,r,a);if(S!==void 0){if(S)continue;w=!1;break}if(l){if(!no(r,function(O,I){if(!ut(l,I)&&(_===O||o(_,O,t,n,a)))return l.push(I)})){w=!1;break}}else if(_!==v&&!o(_,v,t,n,a)){w=!1;break}}return a.delete(e),a.delete(r),w}function so(e){var r=-1,t=Array(e.size);return e.forEach(function(n,o){t[++r]=[o,n]}),t}function ao(e){var r=-1,t=Array(e.size);return e.forEach(function(n){t[++r]=n}),t}var co=1,uo=2,lo="[object Boolean]",ho="[object Date]",fo="[object Error]",po="[object Map]",go="[object Number]",wo="[object RegExp]",_o="[object Set]",yo="[object String]",vo="[object Symbol]",mo="[object ArrayBuffer]",bo="[object DataView]",lr=U?U.prototype:void 0,lt=lr?lr.valueOf:void 0,jo=1,So=Object.prototype.hasOwnProperty,Oo=1,hr="[object Arguments]",fr="[object Array]",Ce="[object Object]",dr=Object.prototype.hasOwnProperty;function ht(e,r,t,n,o){return e===r||(e==null||r==null||!G(e)&&!G(r)?e!=e&&r!=r:function(a,c,f,d,h,p){var y=N(a),w=N(c),l=y?fr:be(a),_=w?fr:be(c),v=(l=l==hr?Ce:l)==Ce,S=(_=_==hr?Ce:_)==Ce,O=l==_;if(O&&Ee(a)){if(!Ee(c))return!1;y=!0,v=!1}if(O&&!v)return p||(p=new H),y||Rt(a)?ur(a,c,f,d,h,p):function(x,z,L,q,he,R,V){switch(L){case bo:if(x.byteLength!=z.byteLength||x.byteOffset!=z.byteOffset)return!1;x=x.buffer,z=z.buffer;case mo:return!(x.byteLength!=z.byteLength||!R(new Me(x),new Me(z)));case lo:case ho:case go:return ze(+x,+z);case fo:return x.name==z.name&&x.message==z.message;case wo:case yo:return x==z+"";case po:var B=so;case _o:if(B||(B=ao),x.size!=z.size&&!(q&co))return!1;var K=V.get(x);if(K)return K==z;q|=uo,V.set(x,z);var Q=ur(B(x),B(z),q,he,R,V);return V.delete(x),Q;case vo:if(lt)return lt.call(x)==lt.call(z)}return!1}(a,c,l,f,d,h,p);if(!(f&Oo)){var I=v&&dr.call(a,"__wrapped__"),$=S&&dr.call(c,"__wrapped__");if(I||$){var M=I?a.value():a,D=$?c.value():c;return p||(p=new H),h(M,D,f,d,p)}}return!!O&&(p||(p=new H),function(x,z,L,q,he,R){var V=L&jo,B=ot(x),K=B.length;if(K!=ot(z).length&&!V)return!1;for(var Q=K;Q--;){var u=B[Q];if(!(V?u in z:So.call(z,u)))return!1}var i=R.get(x),s=R.get(z);if(i&&s)return i==z&&s==x;var g=!0;R.set(x,z),R.set(z,x);for(var m=V;++Q<K;){var b=x[u=B[Q]],j=z[u];if(q)var E=V?q(j,b,u,z,x,R):q(b,j,u,x,z,R);if(!(E===void 0?b===j||he(b,j,L,q,R):E)){g=!1;break}m||(m=u=="constructor")}if(g&&!m){var C=x.constructor,T=z.constructor;C==T||!("constructor"in x)||!("constructor"in z)||typeof C=="function"&&C instanceof C&&typeof T=="function"&&T instanceof T||(g=!1)}return R.delete(x),R.delete(z),g}(a,c,f,d,h,p))}(e,r,t,n,ht,o))}var xo=1,ko=2;function pr(e){return e==e&&!ee(e)}function gr(e,r){return function(t){return t!=null&&t[e]===r&&(r!==void 0||e in Object(t))}}function zo(e,r){return e!=null&&r in Object(e)}var Ao=1,Eo=2;function ie(e){return typeof e=="function"?e:e==null?xe:typeof e=="object"?N(e)?function(a,c){return Ke(a)&&pr(c)?gr(Ie(a),c):function(f){var d=function(h,p,y){var w=h==null?void 0:tt(h,p);return w===void 0?void 0:w}(f,a);return d===void 0&&d===c?function(h,p){return h!=null&&function(y,w,l){for(var _=-1,v=(w=Vt(w,y)).length,S=!1;++_<v;){var O=Ie(w[_]);if(!(S=y!=null&&l(y,O)))break;y=y[O]}return S||++_!=v?S:!!(v=y==null?0:y.length)&&He(v)&&Be(O,v)&&(N(y)||Ze(y))}(h,p,zo)}(f,a):ht(c,d,Ao|Eo)}}(e[0],e[1]):(o=function(a){for(var c=ye(a),f=c.length;f--;){var d=c[f],h=a[d];c[f]=[d,h,pr(h)]}return c}(n=e),o.length==1&&o[0][2]?gr(o[0][0],o[0][1]):function(a){return a===n||function(c,f,d,h){var p=d.length,y=p;if(c==null)return!y;for(c=Object(c);p--;){var w=d[p];if(w[2]?w[1]!==c[w[0]]:!(w[0]in c))return!1}for(;++p<y;){var l=(w=d[p])[0],_=c[l],v=w[1];if(w[2]){if(_===void 0&&!(l in c))return!1}else{var S=new H;if(!ht(v,_,xo|ko,void 0,S))return!1}}return!0}(a,0,o)}):Ke(r=e)?(t=Ie(r),function(a){return a==null?void 0:a[t]}):function(a){return function(c){return tt(c,a)}}(r);var r,t,n,o}var Po=function(e,r,t){for(var n=-1,o=Object(e),a=t(e),c=a.length;c--;){var f=a[++n];if(r(o[f],f,o)===!1)break}return e};function wr(e,r){return e&&Po(e,r,ye)}var _r,To=(_r=wr,function(e,r){if(e==null)return e;if(!ue(e))return _r(e,r);for(var t=e.length,n=-1,o=Object(e);++n<t&&r(o[n],n,o)!==!1;);return e});function yr(e,r){var t=-1,n=ue(e)?Array(e.length):[];return To(e,function(o,a,c){n[++t]=r(o,a,c)}),n}function Fo(e,r){return e>r}var Io=Math.min;function Mo(e){return function(r){return G(r)&&ue(r)}(e)?e:[]}var $o=Pt(function(e){var r=ce(e,Mo);return r.length&&r[0]===e[0]?function(t,n,o){for(var a=Qr,c=t[0].length,f=t.length,d=f,h=Array(f),p=1/0,y=[];d--;){var w=t[d];p=Io(w.length,p),h[d]=c>=120&&w.length>=120?new je(d&&w):void 0}w=t[0];var l=-1,_=h[0];e:for(;++l<c&&y.length<p;){var v=w[l],S=v;if(v=v!==0?v:0,!(_?ut(_,S):a(y,S,o))){for(d=f;--d;){var O=h[d];if(!(O?ut(O,S):a(t[d],S,o)))continue e}_&&_.push(S),y.push(v)}}return y}(r):[]}),Co=$o;function No(e,r){return e<r}function A(e,r){var t={};return r=ie(r),wr(e,function(n,o,a){Je(t,o,r(n,o,a))}),t}function vr(e,r,t){for(var n=-1,o=e.length;++n<o;){var a=e[n],c=r(a);if(c!=null&&(f===void 0?c==c&&!ae(c):t(c,f)))var f=c,d=a}return d}function Wo(e,r){return e&&e.length?vr(e,ie(r),Fo):void 0}function mr(e,r){for(var t,n=-1,o=e.length;++n<o;){var a=r(e[n]);a!==void 0&&(t=t===void 0?a:t+a)}return t}function Ro(e,r){return function(t,n){var o=t==null?0:t.length;return o?mr(t,n)/o:NaN}(e,ie(r))}function Do(e,r){if(e!==r){var t=e!==void 0,n=e===null,o=e==e,a=ae(e),c=r!==void 0,f=r===null,d=r==r,h=ae(r);if(!f&&!h&&!a&&e>r||a&&c&&d&&!f&&!h||n&&c&&d||!t&&d||!o)return 1;if(!n&&!a&&!h&&e<r||h&&t&&o&&!n&&!a||f&&t&&o||!c&&o||!d)return-1}return 0}function br(e,r,t){r=r.length?ce(r,function(o){return N(o)?function(a){return tt(a,o.length===1?o[0]:o)}:o}):[xe];var n=-1;return r=ce(r,Pe(ie)),function(o,a){var c=o.length;for(o.sort(function(f,d){return function(h,p,y){for(var w=-1,l=h.criteria,_=p.criteria,v=l.length,S=y.length;++w<v;){var O=Do(l[w],_[w]);if(O)return w>=S?O:O*(y[w]=="desc"?-1:1)}return h.index-p.index}(f,d,t)});c--;)o[c]=o[c].value;return o}(yr(e,function(o,a,c){return{criteria:ce(r,function(f){return f(o)}),index:++n,value:o}}))}function ft(e,r,t,n){return e==null?[]:(N(r)||(r=r==null?[]:[r]),N(t=t)||(t=t==null?[]:[t]),br(e,r,t))}var Uo=Pt(function(e,r){if(e==null)return[];var t=r.length;return t>1&&Tt(e,r[0],r[1])?r=[]:t>2&&Tt(r[0],r[1],r[2])&&(r=[r[0]]),br(e,bn(r),[])});function Vo(e,r){return e&&e.length?mr(e,ie(r)):0}function k(e){if(this.words=[],e)if(Symbol&&Symbol.iterator&&e[Symbol.iterator]!==void 0){const r=e[Symbol.iterator]();let t=r.next();for(;!t.done;)this.add(t.value),t=r.next()}else for(let r=0;r<e.length;r++)this.add(e[r])}k.fromWords=function(e){const r=Object.create(k.prototype);return r.words=e,r},k.prototype.add=function(e){this.resize(e),this.words[e>>>5]|=1<<e},k.prototype.flip=function(e){this.resize(e),this.words[e>>>5]^=1<<e},k.prototype.clear=function(){this.words.length=0},k.prototype.remove=function(e){this.resize(e),this.words[e>>>5]&=~(1<<e)},k.prototype.isEmpty=function(e){const r=this.words.length;for(let t=0;t<r;t++)if(this.words[t]!==0)return!1;return!0},k.prototype.has=function(e){return(this.words[e>>>5]&1<<e)!=0},k.prototype.checkedAdd=function(e){this.resize(e);const r=this.words[e>>>5],t=r|1<<e;return this.words[e>>>5]=t,(t^r)>>>e},k.prototype.trim=function(e){let r=this.words.length;for(;r>0&&this.words[r-1]===0;)r--;this.words.length=r},k.prototype.resize=function(e){const r=e+32>>>5;for(let t=this.words.length;t<r;t++)this.words[t]=0},k.prototype.hammingWeight=function(e){return 16843009*((e=(858993459&(e-=e>>>1&1431655765))+(e>>>2&858993459))+(e>>>4)&252645135)>>>24},k.prototype.hammingWeight4=function(e,r,t,n){return 16843009*((e=(e=(858993459&(e-=e>>>1&1431655765))+(e>>>2&858993459))+(e>>>4)&252645135)+(r=(r=(858993459&(r-=r>>>1&1431655765))+(r>>>2&858993459))+(r>>>4)&252645135)+(t=(t=(858993459&(t-=t>>>1&1431655765))+(t>>>2&858993459))+(t>>>4)&252645135)+(n=(n=(858993459&(n-=n>>>1&1431655765))+(n>>>2&858993459))+(n>>>4)&252645135))>>>24},k.prototype.size=function(){let e=0;const r=this.words.length,t=this.words;for(let n=0;n<r;n++)e+=this.hammingWeight(t[n]);return e},k.prototype.array=function(){const e=new Array(this.size());let r=0;const t=this.words.length;for(let n=0;n<t;++n){let o=this.words[n];for(;o!=0;){const a=o&-o;e[r++]=(n<<5)+this.hammingWeight(a-1|0),o^=a}}return e},k.prototype.forEach=function(e){const r=this.words.length;for(let t=0;t<r;++t){let n=this.words[t];for(;n!=0;){const o=n&-n;e((t<<5)+this.hammingWeight(o-1|0)),n^=o}}},k.prototype[Symbol.iterator]=function(){const e=this.words.length;let r=0,t=this.words[r],n=this.hammingWeight,o=this.words;return{[Symbol.iterator](){return this},next(){for(;r<e;){if(t!==0){const a=t&-t,c=(r<<5)+n(a-1|0);return t^=a,{done:!1,value:c}}r++,r<e&&(t=o[r])}return{done:!0,value:void 0}}}},k.prototype.clone=function(){const e=Object.create(k.prototype);return e.words=this.words.slice(),e},k.prototype.intersects=function(e){const r=Math.min(this.words.length,e.words.length);for(let t=0;t<r;++t)if((this.words[t]&e.words[t])!=0)return!0;return!1},k.prototype.intersection=function(e){const r=Math.min(this.words.length,e.words.length);let t=0;for(;t+7<r;t+=8)this.words[t]&=e.words[t],this.words[t+1]&=e.words[t+1],this.words[t+2]&=e.words[t+2],this.words[t+3]&=e.words[t+3],this.words[t+4]&=e.words[t+4],this.words[t+5]&=e.words[t+5],this.words[t+6]&=e.words[t+6],this.words[t+7]&=e.words[t+7];for(;t<r;++t)this.words[t]&=e.words[t];const n=this.words.length;for(t=r;t<n;++t)this.words[t]=0;return this},k.prototype.intersection_size=function(e){const r=Math.min(this.words.length,e.words.length);let t=0;for(let n=0;n<r;++n)t+=this.hammingWeight(this.words[n]&e.words[n]);return t},k.prototype.new_intersection=function(e){const r=Object.create(k.prototype),t=Math.min(this.words.length,e.words.length);r.words=new Array(t);let n=0;for(;n+7<t;n+=8)r.words[n]=this.words[n]&e.words[n],r.words[n+1]=this.words[n+1]&e.words[n+1],r.words[n+2]=this.words[n+2]&e.words[n+2],r.words[n+3]=this.words[n+3]&e.words[n+3],r.words[n+4]=this.words[n+4]&e.words[n+4],r.words[n+5]=this.words[n+5]&e.words[n+5],r.words[n+6]=this.words[n+6]&e.words[n+6],r.words[n+7]=this.words[n+7]&e.words[n+7];for(;n<t;++n)r.words[n]=this.words[n]&e.words[n];return r},k.prototype.equals=function(e){const r=Math.min(this.words.length,e.words.length);for(let t=0;t<r;++t)if(this.words[t]!=e.words[t])return!1;if(this.words.length<e.words.length){const t=e.words.length;for(let n=this.words.length;n<t;++n)if(e.words[n]!=0)return!1}else if(e.words.length<this.words.length){const t=this.words.length;for(let n=e.words.length;n<t;++n)if(this.words[n]!=0)return!1}return!0},k.prototype.difference=function(e){const r=Math.min(this.words.length,e.words.length);let t=0;for(;t+7<r;t+=8)this.words[t]&=~e.words[t],this.words[t+1]&=~e.words[t+1],this.words[t+2]&=~e.words[t+2],this.words[t+3]&=~e.words[t+3],this.words[t+4]&=~e.words[t+4],this.words[t+5]&=~e.words[t+5],this.words[t+6]&=~e.words[t+6],this.words[t+7]&=~e.words[t+7];for(;t<r;++t)this.words[t]&=~e.words[t];return this},k.prototype.new_difference=function(e){return this.clone().difference(e)},k.prototype.difference2=function(e){const r=Math.min(this.words.length,e.words.length);let t=0;for(;t+7<r;t+=8)e.words[t]=this.words[t]&~e.words[t],e.words[t+1]=this.words[t+1]&~e.words[t+1],e.words[t+2]=this.words[t+2]&~e.words[t+2],e.words[t+3]=this.words[t+3]&~e.words[t+3],e.words[t+4]=this.words[t+4]&~e.words[t+4],e.words[t+5]=this.words[t+5]&~e.words[t+5],e.words[t+6]=this.words[t+6]&~e.words[t+6],e.words[t+7]=this.words[t+7]&~e.words[t+7];for(;t<r;++t)e.words[t]=this.words[t]&~e.words[t];for(t=this.words.length-1;t>=r;--t)e.words[t]=this.words[t];return e.words.length=this.words.length,e},k.prototype.difference_size=function(e){const r=Math.min(this.words.length,e.words.length);let t=0,n=0;for(;n<r;++n)t+=this.hammingWeight(this.words[n]&~e.words[n]);const o=this.words.length;for(;n<o;++n)t+=this.hammingWeight(this.words[n]);return t},k.prototype.change=function(e){const r=Math.min(this.words.length,e.words.length);let t=0;for(;t+7<r;t+=8)this.words[t]^=e.words[t],this.words[t+1]^=e.words[t+1],this.words[t+2]^=e.words[t+2],this.words[t+3]^=e.words[t+3],this.words[t+4]^=e.words[t+4],this.words[t+5]^=e.words[t+5],this.words[t+6]^=e.words[t+6],this.words[t+7]^=e.words[t+7];for(;t<r;++t)this.words[t]^=e.words[t];for(t=e.words.length-1;t>=r;--t)this.words[t]=e.words[t];return this},k.prototype.new_change=function(e){const r=Object.create(k.prototype),t=Math.max(this.words.length,e.words.length);r.words=new Array(t);const n=Math.min(this.words.length,e.words.length);let o=0;for(;o+7<n;o+=8)r.words[o]=this.words[o]^e.words[o],r.words[o+1]=this.words[o+1]^e.words[o+1],r.words[o+2]=this.words[o+2]^e.words[o+2],r.words[o+3]=this.words[o+3]^e.words[o+3],r.words[o+4]=this.words[o+4]^e.words[o+4],r.words[o+5]=this.words[o+5]^e.words[o+5],r.words[o+6]=this.words[o+6]^e.words[o+6],r.words[o+7]=this.words[o+7]^e.words[o+7];for(;o<n;++o)r.words[o]=this.words[o]^e.words[o];const a=this.words.length;for(o=n;o<a;++o)r.words[o]=this.words[o];const c=e.words.length;for(o=n;o<c;++o)r.words[o]=e.words[o];return r},k.prototype.change_size=function(e){const r=Math.min(this.words.length,e.words.length);let t=0,n=0;for(;n<r;++n)t+=this.hammingWeight(this.words[n]^e.words[n]);const o=this.words.length>e.words.length?this:e,a=o.words.length;for(;n<a;++n)t+=this.hammingWeight(o.words[n]);return t},k.prototype.toString=function(){return"{"+this.array().join(",")+"}"},k.prototype.union=function(e){const r=Math.min(this.words.length,e.words.length);let t=0;for(;t+7<r;t+=8)this.words[t]|=e.words[t],this.words[t+1]|=e.words[t+1],this.words[t+2]|=e.words[t+2],this.words[t+3]|=e.words[t+3],this.words[t+4]|=e.words[t+4],this.words[t+5]|=e.words[t+5],this.words[t+6]|=e.words[t+6],this.words[t+7]|=e.words[t+7];for(;t<r;++t)this.words[t]|=e.words[t];if(this.words.length<e.words.length){this.resize((e.words.length<<5)-1);const n=e.words.length;for(let o=r;o<n;++o)this.words[o]=e.words[o]}return this},k.prototype.new_union=function(e){const r=Object.create(k.prototype),t=Math.max(this.words.length,e.words.length);r.words=new Array(t);const n=Math.min(this.words.length,e.words.length);let o=0;for(;o+7<n;o+=8)r.words[o]=this.words[o]|e.words[o],r.words[o+1]=this.words[o+1]|e.words[o+1],r.words[o+2]=this.words[o+2]|e.words[o+2],r.words[o+3]=this.words[o+3]|e.words[o+3],r.words[o+4]=this.words[o+4]|e.words[o+4],r.words[o+5]=this.words[o+5]|e.words[o+5],r.words[o+6]=this.words[o+6]|e.words[o+6],r.words[o+7]=this.words[o+7]|e.words[o+7];for(;o<n;++o)r.words[o]=this.words[o]|e.words[o];const a=this.words.length;for(o=n;o<a;++o)r.words[o]=this.words[o];const c=e.words.length;for(o=n;o<c;++o)r.words[o]=e.words[o];return r},k.prototype.union_size=function(e){const r=Math.min(this.words.length,e.words.length);let t=0;for(let n=0;n<r;++n)t+=this.hammingWeight(this.words[n]|e.words[n]);if(this.words.length<e.words.length){const n=e.words.length;for(let o=this.words.length;o<n;++o)t+=this.hammingWeight(0|e.words[o])}else{const n=this.words.length;for(let o=e.words.length;o<n;++o)t+=this.hammingWeight(0|this.words[o])}return t};var W=k;function dt(){return dt=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},dt.apply(this,arguments)}function Lo(e,r){var t=[];return e.forEach(function(n){r.forEach(function(o){t.push(n.concat(o))})}),t}function jr(e){return!!~e.search(/\(|\)/)}function Sr(e,r){for(var t=r.split(" "+e+" "),n=[],o=[],a=0;a<t.length;a++)if(jr(t[a])||o.length>0){o.push(t[a]);var c=""+o;(c.match(/\(/g)||[]).length===(c.match(/\)/g)||[]).length&&(n.push(o.join(" "+e+" ")),o=[])}else n.push(t[a]);return n}var qo=function e(r){return function(n){for(var o=n[0],a=1;a<n.length;a++)o=o.concat(n[a]);return o}(Sr("OR",(t=r=function(n){if(n.charAt(0)==="("){for(var o=0,a=0;a<n.length;a++)if(n.charAt(a)==="("?o++:n.charAt(a)===")"&&o--,o===0)return a!==n.length-1?n:n.substring(1,n.length-1)}return n}(r),r=t.replace(/[\s]+/g," "))).map(function(n){for(var o=Sr("AND",n),a=[],c=[],f=0;f<o.length;f++)jr(o[f])?a.push(e(o[f])):c.push(o[f]);return a.push([c]),function(d){for(var h=[[]],p=0;p<d.length;p++)h=Lo(h,d[p]);return h}(a)}));var t};const Or=function(e){try{return structuredClone(e)}catch{try{return JSON.parse(JSON.stringify(e))}catch{return e}}},xr=function(e,r){let t=new W([]),n=0;return A(r,function(o,a){o.forEach(c=>{++n,t=t.new_union(e[a][c]||new W([]))})}),n===0?null:t},Bo=function(e,r,t){let n=1;return A(e.bits_data_temp,(o,a)=>{let c,f,d,h,p,y,w;t[a]&&(c=t[a].order,f=t[a].sort,d=t[a].size,h=t[a].title,p=t[a].show_facet_stats||!1,y=t[a].chosen_filters_on_top!==!1,w=t[a].hide_zero_doc_count||!1);let l,_,v,S,O=Object.entries(o).map(M=>{let D=[];r&&r.filters&&r.filters[a]&&(D=r.filters[a]);const x=M[1].array().length;if(!w||x!==0||D.indexOf(M[0])!==-1)return{key:M[0],doc_count:x,selected:D.indexOf(M[0])!==-1}}).filter(Boolean);var I,$;return N(f)?(l=f||["key"],_=c||["asc"]):(f==="term"||f==="key"?(l=["key"],_=[c||"asc"]):(l=["doc_count","key"],_=[c||"desc","asc"]),y&&(l.unshift("selected"),_.unshift("desc"))),O=ft(O,l,_),O=O.slice(0,d||10),p&&(v=[],Object.entries(o).forEach(M=>{if(isNaN(M[0]))throw new Error("You cant use chars to calculate the facet_stats.");M[1].array().length>0&&M[1].forEach(()=>{v.push(parseInt(M[0]))})}),S={min:(I=v,I&&I.length?vr(I,ie(void 0),No):void 0),max:Wo(v),avg:Ro(v),sum:Vo(v)}),dt({name:a,title:h||($=a,$.replace(/^[\s_]+|[\s_]+$/g,"").replace(/[_\s]+/g," ").replace(/^[a-z]/,function(M){return M.toUpperCase()})),position:n++,buckets:O},p&&{facet_stats:S})})};function kr(e,r,t,n,o){r=r||Object.create(null);const a=parseInt(r.per_page||12),c=parseInt(r.page||1),f=r.is_all_filtered_items||!1;if(t.native_search_enabled===!1&&(r.query||r.filter))throw new Error('"query" and "filter" options are not working once native search is disabled');let d=0;const h=new Date().getTime();let p,y,w,l=o.bits_ids();if(r._ids)p=new W(r._ids),y=r._ids;else if(r.ids)y=o.internal_ids_from_ids_map(r.ids),p=new W(y);else if(n&&(r.query||r.filter)){const x=new Date().getTime();y=n.search(r.query,r.filter),d=new Date().getTime()-x,p=new W(y)}let _=new Date().getTime();const v=o.search(r,{query_ids:p});_=new Date().getTime()-_,p&&(l=p),v.ids&&(l=l.new_intersection(v.ids)),v.not_ids&&(l=l.new_difference(v.not_ids));let S=l.array(),O=S.map(x=>o.get_item(x)),I=!1;const $=new Date().getTime();let M=0;r.sort?O=function(x,z,L){return L&&L[z]&&(z=L[z]),z.field?ft(x,z.field,z.order||"asc"):x}(O,r.sort,t.sortings):y&&(S=y.filter(x=>l.has(x)),O=S.slice((c-1)*a,c*a).map(x=>o.get_item(x)),I=!0),I||(w=f?O:null,O=O.slice((c-1)*a,c*a)),M=new Date().getTime()-$;const D=new Date().getTime()-h;return{pagination:{per_page:a,page:c,total:S.length},timings:{total:D,facets:_,search:d,sorting:M},data:{items:O,allFilteredItems:w,aggregations:Bo(v,r,t.aggregations)}}}var Ne=function(e){var r={exports:{}};return function(t,n){(function(){var o,a,c,f,d,h,p,y,w,l,_,v,S,O,I,$,M,D,x,z,L,q,he,R,V,B,K,Q,u=function(i){var s=new u.Index;return s.pipeline.add(u.trimmer,u.stopWordFilter,u.stemmer),i&&i.call(s,s),s};u.version="1.0.0",u.utils={},u.utils.warn=function(i){return function(s){i.console&&console.warn&&console.warn(s)}}(this),u.utils.asString=function(i){return i==null?"":i.toString()},u.EventEmitter=function(){this.events={}},u.EventEmitter.prototype.addListener=function(){var i=Array.prototype.slice.call(arguments),s=i.pop(),g=i;if(typeof s!="function")throw new TypeError("last argument must be a function");g.forEach(function(m){this.hasHandler(m)||(this.events[m]=[]),this.events[m].push(s)},this)},u.EventEmitter.prototype.removeListener=function(i,s){if(this.hasHandler(i)){var g=this.events[i].indexOf(s);this.events[i].splice(g,1),this.events[i].length||delete this.events[i]}},u.EventEmitter.prototype.emit=function(i){if(this.hasHandler(i)){var s=Array.prototype.slice.call(arguments,1);this.events[i].forEach(function(g){g.apply(void 0,s)})}},u.EventEmitter.prototype.hasHandler=function(i){return i in this.events},u.tokenizer=function(i){return arguments.length&&i!=null&&i!=null?Array.isArray(i)?i.map(function(s){return u.utils.asString(s).toLowerCase()}):i.toString().trim().toLowerCase().split(u.tokenizer.separator):[]},u.tokenizer.separator=/[\s\-]+/,u.tokenizer.load=function(i){var s=this.registeredFunctions[i];if(!s)throw new Error("Cannot load un-registered function: "+i);return s},u.tokenizer.label="default",u.tokenizer.registeredFunctions={default:u.tokenizer},u.tokenizer.registerFunction=function(i,s){s in this.registeredFunctions&&u.utils.warn("Overwriting existing tokenizer: "+s),i.label=s,this.registeredFunctions[s]=i},u.Pipeline=function(){this._stack=[]},u.Pipeline.registeredFunctions={},u.Pipeline.registerFunction=function(i,s){s in this.registeredFunctions&&u.utils.warn("Overwriting existing registered function: "+s),i.label=s,u.Pipeline.registeredFunctions[i.label]=i},u.Pipeline.warnIfFunctionNotRegistered=function(i){i.label&&i.label in this.registeredFunctions||u.utils.warn(`Function is not registered with pipeline. This may cause problems when serialising the index.
`,i)},u.Pipeline.load=function(i){var s=new u.Pipeline;return i.forEach(function(g){var m=u.Pipeline.registeredFunctions[g];if(!m)throw new Error("Cannot load un-registered function: "+g);s.add(m)}),s},u.Pipeline.prototype.add=function(){Array.prototype.slice.call(arguments).forEach(function(i){u.Pipeline.warnIfFunctionNotRegistered(i),this._stack.push(i)},this)},u.Pipeline.prototype.after=function(i,s){u.Pipeline.warnIfFunctionNotRegistered(s);var g=this._stack.indexOf(i);if(g==-1)throw new Error("Cannot find existingFn");this._stack.splice(g+=1,0,s)},u.Pipeline.prototype.before=function(i,s){u.Pipeline.warnIfFunctionNotRegistered(s);var g=this._stack.indexOf(i);if(g==-1)throw new Error("Cannot find existingFn");this._stack.splice(g,0,s)},u.Pipeline.prototype.remove=function(i){var s=this._stack.indexOf(i);s!=-1&&this._stack.splice(s,1)},u.Pipeline.prototype.run=function(i){for(var s=[],g=i.length,m=this._stack.length,b=0;b<g;b++){for(var j=i[b],E=0;E<m&&(j=this._stack[E](j,b,i))!==void 0&&j!=="";E++);j!==void 0&&j!==""&&s.push(j)}return s},u.Pipeline.prototype.reset=function(){this._stack=[]},u.Pipeline.prototype.toJSON=function(){return this._stack.map(function(i){return u.Pipeline.warnIfFunctionNotRegistered(i),i.label})},u.Vector=function(){this._magnitude=null,this.list=void 0,this.length=0},u.Vector.Node=function(i,s,g){this.idx=i,this.val=s,this.next=g},u.Vector.prototype.insert=function(i,s){this._magnitude=void 0;var g=this.list;if(!g)return this.list=new u.Vector.Node(i,s,g),this.length++;if(i<g.idx)return this.list=new u.Vector.Node(i,s,g),this.length++;for(var m=g,b=g.next;b!=null;){if(i<b.idx)return m.next=new u.Vector.Node(i,s,b),this.length++;m=b,b=b.next}return m.next=new u.Vector.Node(i,s,b),this.length++},u.Vector.prototype.magnitude=function(){if(this._magnitude)return this._magnitude;for(var i,s=this.list,g=0;s;)g+=(i=s.val)*i,s=s.next;return this._magnitude=Math.sqrt(g)},u.Vector.prototype.dot=function(i){for(var s=this.list,g=i.list,m=0;s&&g;)s.idx<g.idx?s=s.next:(s.idx>g.idx||(m+=s.val*g.val,s=s.next),g=g.next);return m},u.Vector.prototype.similarity=function(i){return this.dot(i)/(this.magnitude()*i.magnitude())},u.SortedSet=function(){this.length=0,this.elements=[]},u.SortedSet.load=function(i){var s=new this;return s.elements=i,s.length=i.length,s},u.SortedSet.prototype.add=function(){var i,s;for(i=0;i<arguments.length;i++)~this.indexOf(s=arguments[i])||this.elements.splice(this.locationFor(s),0,s);this.length=this.elements.length},u.SortedSet.prototype.toArray=function(){return this.elements.slice()},u.SortedSet.prototype.map=function(i,s){return this.elements.map(i,s)},u.SortedSet.prototype.forEach=function(i,s){return this.elements.forEach(i,s)},u.SortedSet.prototype.indexOf=function(i){for(var s=0,g=this.elements.length,m=g-s,b=s+Math.floor(m/2),j=this.elements[b];m>1;){if(j===i)return b;j<i&&(s=b),j>i&&(g=b),m=g-s,b=s+Math.floor(m/2),j=this.elements[b]}return j===i?b:-1},u.SortedSet.prototype.locationFor=function(i){for(var s=0,g=this.elements.length,m=g-s,b=s+Math.floor(m/2),j=this.elements[b];m>1;)j<i&&(s=b),j>i&&(g=b),m=g-s,b=s+Math.floor(m/2),j=this.elements[b];return j>i?b:j<i?b+1:void 0},u.SortedSet.prototype.intersect=function(i){for(var s=new u.SortedSet,g=0,m=0,b=this.length,j=i.length,E=this.elements,C=i.elements;!(g>b-1||m>j-1);)E[g]!==C[m]?E[g]<C[m]?g++:E[g]>C[m]&&m++:(s.add(E[g]),g++,m++);return s},u.SortedSet.prototype.clone=function(){var i=new u.SortedSet;return i.elements=this.toArray(),i.length=i.elements.length,i},u.SortedSet.prototype.union=function(i){var s,g,m;this.length>=i.length?(s=this,g=i):(s=i,g=this),m=s.clone();for(var b=0,j=g.toArray();b<j.length;b++)m.add(j[b]);return m},u.SortedSet.prototype.toJSON=function(){return this.toArray()},u.Index=function(){this._fields=[],this._ref="id",this.pipeline=new u.Pipeline,this.documentStore=new u.Store,this.tokenStore=new u.TokenStore,this.corpusTokens=new u.SortedSet,this.eventEmitter=new u.EventEmitter,this.tokenizerFn=u.tokenizer,this._idfCache={},this.on("add","remove","update",(function(){this._idfCache={}}).bind(this))},u.Index.prototype.on=function(){var i=Array.prototype.slice.call(arguments);return this.eventEmitter.addListener.apply(this.eventEmitter,i)},u.Index.prototype.off=function(i,s){return this.eventEmitter.removeListener(i,s)},u.Index.load=function(i){i.version!==u.version&&u.utils.warn("version mismatch: current "+u.version+" importing "+i.version);var s=new this;return s._fields=i.fields,s._ref=i.ref,s.tokenizer(u.tokenizer.load(i.tokenizer)),s.documentStore=u.Store.load(i.documentStore),s.tokenStore=u.TokenStore.load(i.tokenStore),s.corpusTokens=u.SortedSet.load(i.corpusTokens),s.pipeline=u.Pipeline.load(i.pipeline),s},u.Index.prototype.field=function(i,s){return this._fields.push({name:i,boost:(s=s||{}).boost||1}),this},u.Index.prototype.ref=function(i){return this._ref=i,this},u.Index.prototype.tokenizer=function(i){return i.label&&i.label in u.tokenizer.registeredFunctions||u.utils.warn("Function is not a registered tokenizer. This may cause problems when serialising the index"),this.tokenizerFn=i,this},u.Index.prototype.add=function(i,s){var g={},m=new u.SortedSet,b=i[this._ref];s=s===void 0||s,this._fields.forEach(function(Re){var pe=this.pipeline.run(this.tokenizerFn(i[Re.name]));g[Re.name]=pe;for(var ge=0;ge<pe.length;ge++){var De=pe[ge];m.add(De),this.corpusTokens.add(De)}},this),this.documentStore.set(b,m);for(var j=0;j<m.length;j++){for(var E=m.elements[j],C=0,T=0;T<this._fields.length;T++){var fe=this._fields[T],We=g[fe.name],Se=We.length;if(Se){for(var X=0,de=0;de<Se;de++)We[de]===E&&X++;C+=X/Se*fe.boost}}this.tokenStore.add(E,{ref:b,tf:C})}s&&this.eventEmitter.emit("add",i,this)},u.Index.prototype.remove=function(i,s){var g=i[this._ref];if(s=s===void 0||s,this.documentStore.has(g)){var m=this.documentStore.get(g);this.documentStore.remove(g),m.forEach(function(b){this.tokenStore.remove(b,g)},this),s&&this.eventEmitter.emit("remove",i,this)}},u.Index.prototype.update=function(i,s){s=s===void 0||s,this.remove(i,!1),this.add(i,!1),s&&this.eventEmitter.emit("update",i,this)},u.Index.prototype.idf=function(i){var s="@"+i;if(Object.prototype.hasOwnProperty.call(this._idfCache,s))return this._idfCache[s];var g=this.tokenStore.count(i),m=1;return g>0&&(m=1+Math.log(this.documentStore.length/g)),this._idfCache[s]=m},u.Index.prototype.search=function(i){var s=this.pipeline.run(this.tokenizerFn(i)),g=new u.Vector,m=[],b=this._fields.reduce(function(j,E){return j+E.boost},0);return s.some(function(j){return this.tokenStore.has(j)},this)?(s.forEach(function(j,E,C){var T=1/C.length*this._fields.length*b,fe=this,We=this.tokenStore.expand(j).reduce(function(Se,X){var de=fe.corpusTokens.indexOf(X),Re=fe.idf(X),pe=1,ge=new u.SortedSet;if(X!==j){var De=Math.max(3,X.length-j.length);pe=1/Math.log(De)}de>-1&&g.insert(de,T*Re*pe);for(var Er=fe.tokenStore.get(X),Pr=Object.keys(Er),Zo=Pr.length,gt=0;gt<Zo;gt++)ge.add(Er[Pr[gt]].ref);return Se.union(ge)},new u.SortedSet);m.push(We)},this),m.reduce(function(j,E){return j.intersect(E)}).map(function(j){return{ref:j,score:g.similarity(this.documentVector(j))}},this).sort(function(j,E){return E.score-j.score})):[]},u.Index.prototype.documentVector=function(i){for(var s=this.documentStore.get(i),g=s.length,m=new u.Vector,b=0;b<g;b++){var j=s.elements[b],E=this.tokenStore.get(j)[i].tf,C=this.idf(j);m.insert(this.corpusTokens.indexOf(j),E*C)}return m},u.Index.prototype.toJSON=function(){return{version:u.version,fields:this._fields,ref:this._ref,tokenizer:this.tokenizerFn.label,documentStore:this.documentStore.toJSON(),tokenStore:this.tokenStore.toJSON(),corpusTokens:this.corpusTokens.toJSON(),pipeline:this.pipeline.toJSON()}},u.Index.prototype.use=function(i){var s=Array.prototype.slice.call(arguments,1);s.unshift(this),i.apply(this,s)},u.Store=function(){this.store={},this.length=0},u.Store.load=function(i){var s=new this;return s.length=i.length,s.store=Object.keys(i.store).reduce(function(g,m){return g[m]=u.SortedSet.load(i.store[m]),g},{}),s},u.Store.prototype.set=function(i,s){this.has(i)||this.length++,this.store[i]=s},u.Store.prototype.get=function(i){return this.store[i]},u.Store.prototype.has=function(i){return i in this.store},u.Store.prototype.remove=function(i){this.has(i)&&(delete this.store[i],this.length--)},u.Store.prototype.toJSON=function(){return{store:this.store,length:this.length}},u.stemmer=(o={ational:"ate",tional:"tion",enci:"ence",anci:"ance",izer:"ize",bli:"ble",alli:"al",entli:"ent",eli:"e",ousli:"ous",ization:"ize",ation:"ate",ator:"ate",alism:"al",iveness:"ive",fulness:"ful",ousness:"ous",aliti:"al",iviti:"ive",biliti:"ble",logi:"log"},a={icate:"ic",ative:"",alize:"al",iciti:"ic",ical:"ic",ful:"",ness:""},h="^("+(f="[^aeiou][^aeiouy]*")+")?"+(d=(c="[aeiouy]")+"[aeiou]*")+f+"("+d+")?$",p="^("+f+")?"+d+f+d+f,y="^("+f+")?"+c,w=new RegExp("^("+f+")?"+d+f),l=new RegExp(p),_=new RegExp(h),v=new RegExp(y),S=/^(.+?)(ss|i)es$/,O=/^(.+?)([^s])s$/,I=/^(.+?)eed$/,$=/^(.+?)(ed|ing)$/,M=/.$/,D=/(at|bl|iz)$/,x=new RegExp("([^aeiouylsz])\\1$"),z=new RegExp("^"+f+c+"[^aeiouwxy]$"),L=/^(.+?[^aeiou])y$/,q=/^(.+?)(ational|tional|enci|anci|izer|bli|alli|entli|eli|ousli|ization|ation|ator|alism|iveness|fulness|ousness|aliti|iviti|biliti|logi)$/,he=/^(.+?)(icate|ative|alize|iciti|ical|ful|ness)$/,R=/^(.+?)(al|ance|ence|er|ic|able|ible|ant|ement|ment|ent|ou|ism|ate|iti|ous|ive|ize)$/,V=/^(.+?)(s|t)(ion)$/,B=/^(.+?)e$/,K=/ll$/,Q=new RegExp("^"+f+c+"[^aeiouwxy]$"),function(i){var s,g,m,b,j,E,C;if(i.length<3)return i;if((m=i.substr(0,1))=="y"&&(i=m.toUpperCase()+i.substr(1)),j=O,(b=S).test(i)?i=i.replace(b,"$1$2"):j.test(i)&&(i=i.replace(j,"$1$2")),j=$,(b=I).test(i)){var T=b.exec(i);(b=w).test(T[1])&&(i=i.replace(b=M,""))}else j.test(i)&&(T=j.exec(i),(j=v).test(s=T[1])&&(E=x,C=z,(j=D).test(i=s)?i+="e":E.test(i)?i=i.replace(b=M,""):C.test(i)&&(i+="e")));return(b=L).test(i)&&(i=(s=(T=b.exec(i))[1])+"i"),(b=q).test(i)&&(g=(T=b.exec(i))[2],(b=w).test(s=T[1])&&(i=s+o[g])),(b=he).test(i)&&(g=(T=b.exec(i))[2],(b=w).test(s=T[1])&&(i=s+a[g])),j=V,(b=R).test(i)?(T=b.exec(i),(b=l).test(s=T[1])&&(i=s)):j.test(i)&&(T=j.exec(i),(j=l).test(s=T[1]+T[2])&&(i=s)),(b=B).test(i)&&(T=b.exec(i),j=_,E=Q,((b=l).test(s=T[1])||j.test(s)&&!E.test(s))&&(i=s)),j=l,(b=K).test(i)&&j.test(i)&&(i=i.replace(b=M,"")),m=="y"&&(i=m.toLowerCase()+i.substr(1)),i}),u.Pipeline.registerFunction(u.stemmer,"stemmer"),u.generateStopWordFilter=function(i){var s=i.reduce(function(g,m){return g[m]=m,g},{});return function(g){if(g&&s[g]!==g)return g}},u.stopWordFilter=u.generateStopWordFilter(["a","able","about","across","after","all","almost","also","am","among","an","and","any","are","as","at","be","because","been","but","by","can","cannot","could","dear","did","do","does","either","else","ever","every","for","from","get","got","had","has","have","he","her","hers","him","his","how","however","i","if","in","into","is","it","its","just","least","let","like","likely","may","me","might","most","must","my","neither","no","nor","not","of","off","often","on","only","or","other","our","own","rather","said","say","says","she","should","since","so","some","than","that","the","their","them","then","there","these","they","this","tis","to","too","twas","us","wants","was","we","were","what","when","where","which","while","who","whom","why","will","with","would","yet","you","your"]),u.Pipeline.registerFunction(u.stopWordFilter,"stopWordFilter"),u.trimmer=function(i){return i.replace(/^\W+/,"").replace(/\W+$/,"")},u.Pipeline.registerFunction(u.trimmer,"trimmer"),u.TokenStore=function(){this.root={docs:{}},this.length=0},u.TokenStore.load=function(i){var s=new this;return s.root=i.root,s.length=i.length,s},u.TokenStore.prototype.add=function(i,s,g){g=g||this.root;var m=i.charAt(0),b=i.slice(1);return m in g||(g[m]={docs:{}}),b.length===0?(g[m].docs[s.ref]=s,void(this.length+=1)):this.add(b,s,g[m])},u.TokenStore.prototype.has=function(i){if(!i)return!1;for(var s=this.root,g=0;g<i.length;g++){if(!s[i.charAt(g)])return!1;s=s[i.charAt(g)]}return!0},u.TokenStore.prototype.getNode=function(i){if(!i)return{};for(var s=this.root,g=0;g<i.length;g++){if(!s[i.charAt(g)])return{};s=s[i.charAt(g)]}return s},u.TokenStore.prototype.get=function(i,s){return this.getNode(i,s).docs||{}},u.TokenStore.prototype.count=function(i,s){return Object.keys(this.get(i,s)).length},u.TokenStore.prototype.remove=function(i,s){if(i){for(var g=this.root,m=0;m<i.length;m++){if(!(i.charAt(m)in g))return;g=g[i.charAt(m)]}delete g.docs[s]}},u.TokenStore.prototype.expand=function(i,s){var g=this.getNode(i);return s=s||[],Object.keys(g.docs||{}).length&&s.push(i),Object.keys(g).forEach(function(m){m!=="docs"&&s.concat(this.expand(i+m,s))},this),s},u.TokenStore.prototype.toJSON=function(){return{root:this.root,length:this.length}},t.exports=u})()}(r),r.exports}();class zr{constructor(r,t){this.store=new Map,this.idx=Ne(function(){this.field("name",{boost:10}),((t==null?void 0:t.searchableFields)||[]).forEach(o=>this.field(o)),this.ref("_id"),t!=null&&t.isExactSearch&&(this.pipeline.remove(Ne.stemmer),this.pipeline.remove(Ne.stopWordFilter)),t!=null&&t.removeStopWordFilter&&this.pipeline.remove(Ne.stopWordFilter)});let n=1;(r||[]).map(o=>{o._id=n,++n,this.idx.add(o),this.store.set(o._id,o)})}search_full(r,t){return this.search(r,t).map(n=>this.store.get(n))}search(r,t){return t instanceof Function?(r?this.idx.search(r).map(n=>this.store.get(n.ref)):[...this.store.values()]).filter(t).map(n=>n._id):r?this.idx.search(r).map(n=>n.ref):[...this.store.keys()]}}class Ar{constructor(r,t){(t=t||Object.create(null)).aggregations=t.aggregations||Object.create(null),this._items=r,this.config=t.aggregations,this.facets=function(c,f){f=f||[];const d={data:Object.create(null),bits_data:Object.create(null),bits_data_temp:Object.create(null)};let h=1;return f.forEach(p=>{d.data[p]=Object.create(null)}),c&&c.map(p=>(p._id||(p._id=h,++h),p)),c&&c.map(p=>(f.forEach(y=>{if(p){if(Array.isArray(p[y]))p[y].forEach(w=>{p[y]&&(d.data[y][w]||(d.data[y][w]=[]),d.data[y][w].push(parseInt(p._id)))});else if(p[y]!==void 0){const w=p[y];d.data[y][w]||(d.data[y][w]=[]),d.data[y][w].push(parseInt(p._id))}}}),p)),d.data=A(d.data,function(p,y){return d.bits_data[y]||(d.bits_data[y]=Object.create(null),d.bits_data_temp[y]=Object.create(null)),A(p,function(w,l){const _=Uo(w);return d.bits_data[y][l]=new W(_),_})}),d}(r,ye(t.aggregations)),this._items_map=Object.create(null),this._ids=[];let n=1;var o,a;a=c=>{this._ids.push(n),this._items_map[n]=c,c._id=n,++n},(N(o=r)?ce:yr)(o,ie(a)),this.ids_map=Object.create(null),r&&r.forEach(c=>{const f=t.custom_id_field||"id";c[f]&&c._id&&(this.ids_map[c[f]]=c._id)}),this._bits_ids=new W(this._ids)}items(){return this._items}bits_ids(r){return r?new W(r):this._bits_ids}internal_ids_from_ids_map(r){return r.map(t=>this.ids_map[t])}index(){return this.facets}get_item(r){return this._items_map[r]}search(r,t){const n=this.config;t=t||Object.create(null);const o=ct(this.facets);let a;o.not_ids=xr(o.bits_data,r.not_filters);const c=function(f,d){const h=[];return A(f.filters,function(p,y){if(p&&p.length)if(d[y].conjunction!==!1)A(p,function(w){h.push([y,w])});else{const w=[];A(p,function(l){w.push([y,l])}),h.push(w)}}),A(f.not_filters,function(p,y){p&&p.length&&A(p,function(w){h.push([y,"-",w])})}),h}(r,n);return a=function(f,d){const h=ct(f);let p;d=d||[],A(h.bits_data,function(w,l){A(h.bits_data[l],function(_,v){h.bits_data_temp[l][v]=h.bits_data[l][v]})}),h.is_temp_copied=!0;const y=function(w,l){const _=Object.create(null);return A(l,function(v){if(Array.isArray(v[0])){let S=new W([]);A(v,function(O){const I=O[0];S=S.new_union(w.bits_data[I][O[1]]||new W([])),_[I]=S})}}),_}(f,d);return A(d,function(w){if(!Array.isArray(w[0])){const l=w[0],_=w[1];p=p&&h.bits_data_temp[l][_]?h.bits_data_temp[l][_].new_intersection(p):p&&!h.bits_data_temp[l][_]?new W([]):h.bits_data_temp[l][_]}}),p&&A(h.bits_data_temp,function(w,l){A(h.bits_data_temp[l],function(_,v){h.bits_data_temp[l][v]=h.bits_data_temp[l][v].new_intersection(p)})}),A(d,function(w){if(w.length===3&&w[1]==="-"){const l=h.bits_data_temp[w[0]][w[2]].clone();A(h.bits_data_temp,function(_,v){A(h.bits_data_temp[v],function(S,O){h.bits_data_temp[v][O]=h.bits_data_temp[v][O].new_difference(l)})})}}),A(h.bits_data_temp,function(w,l){A(h.bits_data_temp[l],function(_,v){A(y,function(S,O){O!==l&&(h.bits_data_temp[l][v]=h.bits_data_temp[l][v].new_intersection(S))})})}),h}(this.facets,c),r.filters_query&&(a=function(f,d){const h=ct(f);h.is_temp_copied||A(h.bits_data,function(y,w){A(h.bits_data[w],function(l,_){h.bits_data_temp[w][_]=h.bits_data[w][_]})});let p=null;return A(d,function(y){let w=null;A(y,function(l){const _=l[0],v=l[1];if(!h.bits_data_temp[_])throw new Error("Panic. The key does not exist in facets lists.");w=w&&h.bits_data_temp[_][v]?h.bits_data_temp[_][v].new_intersection(w):w&&!h.bits_data_temp[_][v]?new W([]):h.bits_data_temp[_][v]}),p=(p||new W([])).new_union(w||new W([]))}),p!==null&&A(h.bits_data_temp,function(y,w){A(h.bits_data_temp[w],function(l,_){h.bits_data_temp[w][_]=h.bits_data_temp[w][_].new_intersection(p)})}),h}(a,qo(r.filters_query).map(f=>Array.isArray(f)?f.map(d=>Array.isArray(d)?d.map(h=>h):d.split(":")):f.split(":")))),o.bits_data_temp=a.bits_data_temp,A(o.bits_data_temp,function(f,d){A(o.bits_data_temp[d],function(h,p){t.query_ids&&(o.bits_data_temp[d][p]=t.query_ids.new_intersection(o.bits_data_temp[d][p])),t.test&&(o.data[d][p]=o.bits_data_temp[d][p].array())})}),o.ids=r.filters_query?function(f){let d=new W([]);return A(f,function(h,p){A(f[p],function(y,w){d=d.new_union(f[p][w])})}),d}(o.bits_data_temp):xr(o.bits_data_temp,r.filters),o}}function Jo(e,r){let t;(r=r||Object.create(null)).native_search_enabled!==!1&&(t=new zr(e,r));let n=new Ar(e,r);return{search:function(o){return(o=o||Object.create(null)).aggregations=function(a,c){return A(Or(a),(f,d)=>{f.field||(f.field=d);let h=[];c.filters&&c.filters[d]&&(h=c.filters[d]),f.filters=h;let p=[];return c.not_filters&&c.not_filters[d]&&(p=c.not_filters[d]),c.exclude_filters&&c.exclude_filters[d]&&(p=c.exclude_filters[d]),f.not_filters=p,f})}(r.aggregations,o),kr(0,o,r,t,n)},similar:function(o,a){return function(c,f,d){const h=d.per_page||10,p=d.minimum||0,y=d.page||1;let w;for(let v=0;v<c.length;++v)if(c[v].id==f){w=c[v];break}if(!d.field)throw new Error("Please define field in options");const l=d.field;let _=[];for(let v=0;v<c.length;++v)if(c[v].id!==f){const S=Co(w[l],c[v][l]);S.length>=p&&(_.push(c[v]),_[_.length-1].intersection_length=S.length)}return _=ft(_,["intersection_length"],["desc"]),{pagination:{per_page:h,page:y,total:_.length},data:{items:_.slice((y-1)*h,y*h)}}}(e,o,a)},aggregation:function(o){return function(a,c,f,d,h){const p=c.per_page||10,y=c.page||1;if(c.name&&(!f.aggregations||!f.aggregations[c.name]))throw new Error('Please define aggregation "'.concat(c.name,'" in config'));const w=Or(c);if(w.page=1,w.per_page=0,!c.name)throw new Error("field name is required");f.aggregations[c.name].size=1e4;const l=kr(0,w,f,d,h).data.aggregations[c.name].buckets;return{pagination:{per_page:p,page:y,total:l.length},data:{buckets:l.slice((y-1)*p,y*p)}}}(0,o,r,t,n)},reindex:function(o){t=new zr(e=o,r),n=new Ar(e,r)}}}const pt={};function Ho(e,r,t){pt[e]||(pt[e]=Jo(r,t))}function Go({dataSource:e,query:r,page:t=1,perPage:n=25,sort:o="title_asc",filters:a={}}){const c=pt[e];if(!c)throw new Error(`Search engine for ${e} is not initialised`);return c.search({per_page:n,page:t,query:r,sort:o,filters:a})}addEventListener("message",async e=>{const{action:r,payload:t}=e.data;if(r===Oe.LOAD){const{basePath:n,dataSource:o}=t,a=Tr[o],c=await fetch(`${n}/api/search/${o}.json`).then(f=>f.json());Ho(o,c,a),postMessage({action:Oe.READY})}else if(r===Oe.SEARCH){const n=Go(t);postMessage({action:Oe.RESULTS,payload:{query:t.query,results:n}})}})})();
