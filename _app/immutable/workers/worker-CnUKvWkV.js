(function(){"use strict";const gt={type:{title:"Type",hide_zero_doc_count:!0,size:2,sort:"key"},filmType:{title:"Film type",hide_zero_doc_count:!0,size:5,sort:"key"},genre:{title:"Genre",hide_zero_doc_count:!0,size:100,sort:"key"},tags:{title:"Tags",hide_zero_doc_count:!0,size:500,sort:"key"},gender:{title:"Person gender",hide_zero_doc_count:!0,size:10,sort:"key"},directorGender:{title:"Director gender",hide_zero_doc_count:!0,size:10,sort:"key"},directorNationality:{title:"Director nationality",hide_zero_doc_count:!0,size:300,sort:"key"},characterAge:{title:"Character age",hide_zero_doc_count:!0,size:10,sort:"key"},characterGender:{title:"Character gender",hide_zero_doc_count:!0,size:10,sort:"key"},characterSexuality:{title:"Character sexuality",hide_zero_doc_count:!0,size:10,sort:"key"},characterOrigin:{title:"Character origin",hide_zero_doc_count:!0,size:50,sort:"key"},characterClass:{title:"Character class",hide_zero_doc_count:!0,size:20,sort:"key"},characterProfession:{title:"Character profession",hide_zero_doc_count:!0,size:10,sort:"key"},characterAbility:{title:"Character ability",hide_zero_doc_count:!0,size:10,sort:"key"},assistedMobility:{title:"Assisted mobility",hide_zero_doc_count:!0,size:10,sort:"key"}},Pr={corpus:{aggregations:gt,searchableFields:["title","name","synopsis",...Object.keys(gt)],sortings:{default_asc:{field:"title",order:"asc"},default_desc:{field:"title",order:"desc"},name_asc:{field:"name",order:"asc"},name_desc:{field:"name",order:"desc"},title_asc:{field:"title",order:"asc"},title_desc:{field:"title",order:"desc"}}}};var wt=typeof global=="object"&&global&&global.Object===Object&&global,Fr=typeof self=="object"&&self&&self.Object===Object&&self,J=wt||Fr||Function("return this")(),R=J.Symbol,_t=Object.prototype,Tr=_t.hasOwnProperty,Ir=_t.toString,we=R?R.toStringTag:void 0,Mr=Object.prototype.toString,$r="[object Null]",Nr="[object Undefined]",yt=R?R.toStringTag:void 0;function se(e){return e==null?e===void 0?Nr:$r:yt&&yt in Object(e)?function(r){var t=Tr.call(r,we),n=r[we];try{r[we]=void 0;var o=!0}catch{}var a=Ir.call(r);return o&&(t?r[we]=n:delete r[we]),a}(e):function(r){return Mr.call(r)}(e)}function H(e){return e!=null&&typeof e=="object"}var Cr="[object Symbol]";function ae(e){return typeof e=="symbol"||H(e)&&se(e)==Cr}function ce(e,r){for(var t=-1,n=e==null?0:e.length,o=Array(n);++t<n;)o[t]=r(e[t],t,e);return o}var C=Array.isArray,vt=R?R.prototype:void 0,mt=vt?vt.toString:void 0;function bt(e){if(typeof e=="string")return e;if(C(e))return ce(e,bt)+"";if(ae(e))return mt?mt.call(e):"";var r=e+"";return r=="0"&&1/e==-1/0?"-0":r}function ee(e){var r=typeof e;return e!=null&&(r=="object"||r=="function")}function Oe(e){return e}var Wr="[object AsyncFunction]",Dr="[object Function]",Vr="[object GeneratorFunction]",Rr="[object Proxy]";function jt(e){if(!ee(e))return!1;var r=se(e);return r==Dr||r==Vr||r==Wr||r==Rr}var St,Ve=J["__core-js_shared__"],Ot=(St=/[^.]+$/.exec(Ve&&Ve.keys&&Ve.keys.IE_PROTO||""))?"Symbol(src)_1."+St:"",Ur=Function.prototype.toString;function te(e){if(e!=null){try{return Ur.call(e)}catch{}try{return e+""}catch{}}return""}var qr=/^\[object .+?Constructor\]$/,Lr=RegExp("^"+Function.prototype.toString.call(Object.prototype.hasOwnProperty).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function re(e,r){var t=function(n,o){return n==null?void 0:n[o]}(e,r);return function(n){return!(!ee(n)||(o=n,Ot&&Ot in o))&&(jt(n)?Lr:qr).test(te(n));var o}(t)?t:void 0}var xt,Re,Ue,qe=re(J,"WeakMap"),kt=Object.create,Br=function(){function e(){}return function(r){if(!ee(r))return{};if(kt)return kt(r);e.prototype=r;var t=new e;return e.prototype=void 0,t}}(),Jr=Date.now,Gr=function(){try{var e=re(Object,"defineProperty");return e({},"",{}),e}catch{}}(),xe=Gr,Hr=xe?function(e,r){return xe(e,"toString",{configurable:!0,enumerable:!1,value:(t=r,function(){return t}),writable:!0});var t}:Oe,Yr=(xt=Hr,Re=0,Ue=0,function(){var e=Jr(),r=16-(e-Ue);if(Ue=e,r>0){if(++Re>=800)return arguments[0]}else Re=0;return xt.apply(void 0,arguments)});function Kr(e){return e!=e}function Qr(e,r){return!(e==null||!e.length)&&function(t,n,o){return n==n?function(a,c,h){for(var d=-1,f=a.length;++d<f;)if(a[d]===c)return d;return-1}(t,n):function(a,c,h,d){for(var f=a.length,p=-1;++p<f;)if(c(a[p],p,a))return p;return-1}(t,Kr)}(e,r)>-1}var Xr=9007199254740991,Zr=/^(?:0|[1-9]\d*)$/;function Le(e,r){var t=typeof e;return!!(r=r??Xr)&&(t=="number"||t!="symbol"&&Zr.test(e))&&e>-1&&e%1==0&&e<r}function Be(e,r,t){r=="__proto__"&&xe?xe(e,r,{configurable:!0,enumerable:!0,value:t,writable:!0}):e[r]=t}function ke(e,r){return e===r||e!=e&&r!=r}var en=Object.prototype.hasOwnProperty;function zt(e,r,t){var n=e[r];en.call(e,r)&&ke(n,t)&&(t!==void 0||r in e)||Be(e,r,t)}function ze(e,r,t,n){var o=!t;t||(t={});for(var a=-1,c=r.length;++a<c;){var h=r[a],d=void 0;d===void 0&&(d=e[h]),o?Be(t,h,d):zt(t,h,d)}return t}var At=Math.max;function Et(e,r){return Yr(function(t,n,o){return n=At(n===void 0?t.length-1:n,0),function(){for(var a=arguments,c=-1,h=At(a.length-n,0),d=Array(h);++c<h;)d[c]=a[n+c];c=-1;for(var f=Array(n+1);++c<n;)f[c]=a[c];return f[n]=o(d),function(p,y,w){switch(w.length){case 0:return p.call(y);case 1:return p.call(y,w[0]);case 2:return p.call(y,w[0],w[1]);case 3:return p.call(y,w[0],w[1],w[2])}return p.apply(y,w)}(t,this,f)}}(e,r,Oe),e+"")}var tn=9007199254740991;function Je(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=tn}function ue(e){return e!=null&&Je(e.length)&&!jt(e)}function Pt(e,r,t){if(!ee(t))return!1;var n=typeof r;return!!(n=="number"?ue(t)&&Le(r,t.length):n=="string"&&r in t)&&ke(t[r],e)}var rn=Object.prototype;function Ge(e){var r=e&&e.constructor;return e===(typeof r=="function"&&r.prototype||rn)}function Ft(e){return H(e)&&se(e)=="[object Arguments]"}var Tt=Object.prototype,nn=Tt.hasOwnProperty,on=Tt.propertyIsEnumerable,He=Ft(function(){return arguments}())?Ft:function(e){return H(e)&&nn.call(e,"callee")&&!on.call(e,"callee")},It=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Mt=It&&typeof module=="object"&&module&&!module.nodeType&&module,$t=Mt&&Mt.exports===It?J.Buffer:void 0,Ae=($t?$t.isBuffer:void 0)||function(){return!1},T={};function Ee(e){return function(r){return e(r)}}T["[object Float32Array]"]=T["[object Float64Array]"]=T["[object Int8Array]"]=T["[object Int16Array]"]=T["[object Int32Array]"]=T["[object Uint8Array]"]=T["[object Uint8ClampedArray]"]=T["[object Uint16Array]"]=T["[object Uint32Array]"]=!0,T["[object Arguments]"]=T["[object Array]"]=T["[object ArrayBuffer]"]=T["[object Boolean]"]=T["[object DataView]"]=T["[object Date]"]=T["[object Error]"]=T["[object Function]"]=T["[object Map]"]=T["[object Number]"]=T["[object Object]"]=T["[object RegExp]"]=T["[object Set]"]=T["[object String]"]=T["[object WeakMap]"]=!1;var Nt=typeof exports=="object"&&exports&&!exports.nodeType&&exports,_e=Nt&&typeof module=="object"&&module&&!module.nodeType&&module,Ye=_e&&_e.exports===Nt&&wt.process,le=function(){try{return _e&&_e.require&&_e.require("util").types||Ye&&Ye.binding&&Ye.binding("util")}catch{}}(),Ct=le&&le.isTypedArray,Wt=Ct?Ee(Ct):function(e){return H(e)&&Je(e.length)&&!!T[se(e)]},sn=Object.prototype.hasOwnProperty;function Dt(e,r){var t=C(e),n=!t&&He(e),o=!t&&!n&&Ae(e),a=!t&&!n&&!o&&Wt(e),c=t||n||o||a,h=c?function(p,y){for(var w=-1,l=Array(p);++w<p;)l[w]=y(w);return l}(e.length,String):[],d=h.length;for(var f in e)!r&&!sn.call(e,f)||c&&(f=="length"||o&&(f=="offset"||f=="parent")||a&&(f=="buffer"||f=="byteLength"||f=="byteOffset")||Le(f,d))||h.push(f);return h}function Vt(e,r){return function(t){return e(r(t))}}var an=Vt(Object.keys,Object),cn=Object.prototype.hasOwnProperty;function ye(e){return ue(e)?Dt(e):function(r){if(!Ge(r))return an(r);var t=[];for(var n in Object(r))cn.call(r,n)&&n!="constructor"&&t.push(n);return t}(e)}var un=Object.prototype.hasOwnProperty;function ln(e){return ue(e)?Dt(e,!0):function(r){if(!ee(r))return function(a){var c=[];if(a!=null)for(var h in Object(a))c.push(h);return c}(r);var t=Ge(r),n=[];for(var o in r)(o!="constructor"||!t&&un.call(r,o))&&n.push(o);return n}(e)}var hn=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,fn=/^\w*$/;function Ke(e,r){if(C(e))return!1;var t=typeof e;return!(t!="number"&&t!="symbol"&&t!="boolean"&&e!=null&&!ae(e))||fn.test(e)||!hn.test(e)||r!=null&&e in Object(r)}var ve=re(Object,"create"),dn=Object.prototype.hasOwnProperty,pn=Object.prototype.hasOwnProperty;function ne(e){var r=-1,t=e==null?0:e.length;for(this.clear();++r<t;){var n=e[r];this.set(n[0],n[1])}}function Pe(e,r){for(var t=e.length;t--;)if(ke(e[t][0],r))return t;return-1}ne.prototype.clear=function(){this.__data__=ve?ve(null):{},this.size=0},ne.prototype.delete=function(e){var r=this.has(e)&&delete this.__data__[e];return this.size-=r?1:0,r},ne.prototype.get=function(e){var r=this.__data__;if(ve){var t=r[e];return t==="__lodash_hash_undefined__"?void 0:t}return dn.call(r,e)?r[e]:void 0},ne.prototype.has=function(e){var r=this.__data__;return ve?r[e]!==void 0:pn.call(r,e)},ne.prototype.set=function(e,r){var t=this.__data__;return this.size+=this.has(e)?0:1,t[e]=ve&&r===void 0?"__lodash_hash_undefined__":r,this};var gn=Array.prototype.splice;function Y(e){var r=-1,t=e==null?0:e.length;for(this.clear();++r<t;){var n=e[r];this.set(n[0],n[1])}}Y.prototype.clear=function(){this.__data__=[],this.size=0},Y.prototype.delete=function(e){var r=this.__data__,t=Pe(r,e);return!(t<0||(t==r.length-1?r.pop():gn.call(r,t,1),--this.size,0))},Y.prototype.get=function(e){var r=this.__data__,t=Pe(r,e);return t<0?void 0:r[t][1]},Y.prototype.has=function(e){return Pe(this.__data__,e)>-1},Y.prototype.set=function(e,r){var t=this.__data__,n=Pe(t,e);return n<0?(++this.size,t.push([e,r])):t[n][1]=r,this};var me=re(J,"Map");function Fe(e,r){var t,n,o=e.__data__;return((n=typeof(t=r))=="string"||n=="number"||n=="symbol"||n=="boolean"?t!=="__proto__":t===null)?o[typeof r=="string"?"string":"hash"]:o.map}function K(e){var r=-1,t=e==null?0:e.length;for(this.clear();++r<t;){var n=e[r];this.set(n[0],n[1])}}function Qe(e,r){if(typeof e!="function"||r!=null&&typeof r!="function")throw new TypeError("Expected a function");var t=function(){var n=arguments,o=r?r.apply(this,n):n[0],a=t.cache;if(a.has(o))return a.get(o);var c=e.apply(this,n);return t.cache=a.set(o,c)||a,c};return t.cache=new(Qe.Cache||K),t}K.prototype.clear=function(){this.size=0,this.__data__={hash:new ne,map:new(me||Y),string:new ne}},K.prototype.delete=function(e){var r=Fe(this,e).delete(e);return this.size-=r?1:0,r},K.prototype.get=function(e){return Fe(this,e).get(e)},K.prototype.has=function(e){return Fe(this,e).has(e)},K.prototype.set=function(e,r){var t=Fe(this,e),n=t.size;return t.set(e,r),this.size+=t.size==n?0:1,this},Qe.Cache=K;var Xe,Ze,wn=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,_n=/\\(\\)?/g,yn=(Xe=Qe(function(e){var r=[];return e.charCodeAt(0)===46&&r.push(""),e.replace(wn,function(t,n,o,a){r.push(o?a.replace(_n,"$1"):n||t)}),r},function(e){return Ze.size===500&&Ze.clear(),e}),Ze=Xe.cache,Xe);function Rt(e,r){return C(e)?e:Ke(e,r)?[e]:yn(function(t){return t==null?"":bt(t)}(e))}function Te(e){if(typeof e=="string"||ae(e))return e;var r=e+"";return r=="0"&&1/e==-1/0?"-0":r}function et(e,r){for(var t=0,n=(r=Rt(r,e)).length;e!=null&&t<n;)e=e[Te(r[t++])];return t&&t==n?e:void 0}function tt(e,r){for(var t=-1,n=r.length,o=e.length;++t<n;)e[o+t]=r[t];return e}var Ut=R?R.isConcatSpreadable:void 0;function vn(e){return C(e)||He(e)||!!(Ut&&e&&e[Ut])}function mn(e,r,t,n,o){var a=-1,c=e.length;for(t||(t=vn),o||(o=[]);++a<c;){var h=e[a];t(h)?tt(o,h):o[o.length]=h}return o}var qt=Vt(Object.getPrototypeOf,Object);function G(e){var r=this.__data__=new Y(e);this.size=r.size}G.prototype.clear=function(){this.__data__=new Y,this.size=0},G.prototype.delete=function(e){var r=this.__data__,t=r.delete(e);return this.size=r.size,t},G.prototype.get=function(e){return this.__data__.get(e)},G.prototype.has=function(e){return this.__data__.has(e)},G.prototype.set=function(e,r){var t=this.__data__;if(t instanceof Y){var n=t.__data__;if(!me||n.length<199)return n.push([e,r]),this.size=++t.size,this;t=this.__data__=new K(n)}return t.set(e,r),this.size=t.size,this};var Lt=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Bt=Lt&&typeof module=="object"&&module&&!module.nodeType&&module,Jt=Bt&&Bt.exports===Lt?J.Buffer:void 0,Gt=Jt?Jt.allocUnsafe:void 0;function Ht(){return[]}var bn=Object.prototype.propertyIsEnumerable,Yt=Object.getOwnPropertySymbols,jn=Yt?function(e){return e==null?[]:(e=Object(e),function(r,t){for(var n=-1,o=r==null?0:r.length,a=0,c=[];++n<o;){var h=r[n];bn.call(e,h)&&(c[a++]=h)}return c}(Yt(e)))}:Ht,rt=jn,Sn=Object.getOwnPropertySymbols?function(e){for(var r=[];e;)tt(r,rt(e)),e=qt(e);return r}:Ht;function On(e,r,t){var n=r(e);return C(e)?n:tt(n,t(e))}function nt(e){return On(e,ye,rt)}var ot=re(J,"DataView"),it=re(J,"Promise"),st=re(J,"Set"),Kt="[object Map]",Qt="[object Promise]",Xt="[object Set]",Zt="[object WeakMap]",er="[object DataView]",xn=te(ot),kn=te(me),zn=te(it),An=te(st),En=te(qe),oe=se;(ot&&oe(new ot(new ArrayBuffer(1)))!=er||me&&oe(new me)!=Kt||it&&oe(it.resolve())!=Qt||st&&oe(new st)!=Xt||qe&&oe(new qe)!=Zt)&&(oe=function(e){var r=se(e),t=r=="[object Object]"?e.constructor:void 0,n=t?te(t):"";if(n)switch(n){case xn:return er;case kn:return Kt;case zn:return Qt;case An:return Xt;case En:return Zt}return r});var be=oe,Pn=Object.prototype.hasOwnProperty,Ie=J.Uint8Array;function Fn(e){var r=new e.constructor(e.byteLength);return new Ie(r).set(new Ie(e)),r}var Tn=/\w*$/,tr=R?R.prototype:void 0,rr=tr?tr.valueOf:void 0,In="[object Boolean]",Mn="[object Date]",$n="[object Map]",Nn="[object Number]",Cn="[object RegExp]",Wn="[object Set]",Dn="[object String]",Vn="[object Symbol]",Rn="[object ArrayBuffer]",Un="[object DataView]",qn="[object Float32Array]",Ln="[object Float64Array]",Bn="[object Int8Array]",Jn="[object Int16Array]",Gn="[object Int32Array]",Hn="[object Uint8Array]",Yn="[object Uint8ClampedArray]",Kn="[object Uint16Array]",Qn="[object Uint32Array]",nr=le&&le.isMap,Xn=nr?Ee(nr):function(e){return H(e)&&be(e)=="[object Map]"},or=le&&le.isSet,Zn=or?Ee(or):function(e){return H(e)&&be(e)=="[object Set]"},eo=2,ir="[object Arguments]",sr="[object Function]",to="[object GeneratorFunction]",ar="[object Object]",P={};function Me(e,r,t,n,o,a){var c,h=r&eo;if(c!==void 0)return c;if(!ee(e))return e;var d=C(e);if(d)return c=function(l){var _=l.length,v=new l.constructor(_);return _&&typeof l[0]=="string"&&Pn.call(l,"index")&&(v.index=l.index,v.input=l.input),v}(e),function(l,_){var v=-1,S=l.length;for(_||(_=Array(S));++v<S;)_[v]=l[v];return _}(e,c);var f=be(e),p=f==sr||f==to;if(Ae(e))return function(l,_){var v=l.length,S=Gt?Gt(v):new l.constructor(v);return l.copy(S),S}(e);if(f==ar||f==ir||p&&!o)return c=p?{}:function(l){return typeof l.constructor!="function"||Ge(l)?{}:Br(qt(l))}(e),h?function(l,_){return ze(l,Sn(l),_)}(e,function(l,_){return l&&ze(_,ln(_),l)}(c,e)):function(l,_){return ze(l,rt(l),_)}(e,function(l,_){return l&&ze(_,ye(_),l)}(c,e));if(!P[f])return o?e:{};c=function(l,_,v){var S,O,I=l.constructor;switch(_){case Rn:return Fn(l);case In:case Mn:return new I(+l);case Un:return function($,M){var V=$.buffer;return new $.constructor(V,$.byteOffset,$.byteLength)}(l);case qn:case Ln:case Bn:case Jn:case Gn:case Hn:case Yn:case Kn:case Qn:return function($,M){var V=$.buffer;return new $.constructor(V,$.byteOffset,$.length)}(l);case $n:return new I;case Nn:case Dn:return new I(l);case Cn:return(O=new(S=l).constructor(S.source,Tn.exec(S))).lastIndex=S.lastIndex,O;case Wn:return new I;case Vn:return rr?Object(rr.call(l)):{}}}(e,f),a||(a=new G);var y=a.get(e);if(y)return y;a.set(e,c),Zn(e)?e.forEach(function(l){c.add(Me(l,r,t,l,e,a))}):Xn(e)&&e.forEach(function(l,_){c.set(_,Me(l,r,t,_,e,a))});var w=d?void 0:nt(e);return function(l,_){for(var v=-1,S=l==null?0:l.length;++v<S&&_(l[v],v)!==!1;);}(w||e,function(l,_){w&&(l=e[_=l]),zt(c,_,Me(l,r,t,_,e,a))}),c}function at(e){return Me(e,4)}function je(e){var r=-1,t=e==null?0:e.length;for(this.__data__=new K;++r<t;)this.add(e[r])}function ro(e,r){for(var t=-1,n=e==null?0:e.length;++t<n;)if(r(e[t],t,e))return!0;return!1}function ct(e,r){return e.has(r)}P[ir]=P["[object Array]"]=P["[object ArrayBuffer]"]=P["[object DataView]"]=P["[object Boolean]"]=P["[object Date]"]=P["[object Float32Array]"]=P["[object Float64Array]"]=P["[object Int8Array]"]=P["[object Int16Array]"]=P["[object Int32Array]"]=P["[object Map]"]=P["[object Number]"]=P[ar]=P["[object RegExp]"]=P["[object Set]"]=P["[object String]"]=P["[object Symbol]"]=P["[object Uint8Array]"]=P["[object Uint8ClampedArray]"]=P["[object Uint16Array]"]=P["[object Uint32Array]"]=!0,P["[object Error]"]=P[sr]=P["[object WeakMap]"]=!1,je.prototype.add=je.prototype.push=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},je.prototype.has=function(e){return this.__data__.has(e)};var no=1,oo=2;function cr(e,r,t,n,o,a){var c=t&no,h=e.length,d=r.length;if(h!=d&&!(c&&d>h))return!1;var f=a.get(e),p=a.get(r);if(f&&p)return f==r&&p==e;var y=-1,w=!0,l=t&oo?new je:void 0;for(a.set(e,r),a.set(r,e);++y<h;){var _=e[y],v=r[y];if(n)var S=c?n(v,_,y,r,e,a):n(_,v,y,e,r,a);if(S!==void 0){if(S)continue;w=!1;break}if(l){if(!ro(r,function(O,I){if(!ct(l,I)&&(_===O||o(_,O,t,n,a)))return l.push(I)})){w=!1;break}}else if(_!==v&&!o(_,v,t,n,a)){w=!1;break}}return a.delete(e),a.delete(r),w}function io(e){var r=-1,t=Array(e.size);return e.forEach(function(n,o){t[++r]=[o,n]}),t}function so(e){var r=-1,t=Array(e.size);return e.forEach(function(n){t[++r]=n}),t}var ao=1,co=2,uo="[object Boolean]",lo="[object Date]",ho="[object Error]",fo="[object Map]",po="[object Number]",go="[object RegExp]",wo="[object Set]",_o="[object String]",yo="[object Symbol]",vo="[object ArrayBuffer]",mo="[object DataView]",ur=R?R.prototype:void 0,ut=ur?ur.valueOf:void 0,bo=1,jo=Object.prototype.hasOwnProperty,So=1,lr="[object Arguments]",hr="[object Array]",$e="[object Object]",fr=Object.prototype.hasOwnProperty;function lt(e,r,t,n,o){return e===r||(e==null||r==null||!H(e)&&!H(r)?e!=e&&r!=r:function(a,c,h,d,f,p){var y=C(a),w=C(c),l=y?hr:be(a),_=w?hr:be(c),v=(l=l==lr?$e:l)==$e,S=(_=_==lr?$e:_)==$e,O=l==_;if(O&&Ae(a)){if(!Ae(c))return!1;y=!0,v=!1}if(O&&!v)return p||(p=new G),y||Wt(a)?cr(a,c,h,d,f,p):function(x,z,q,L,he,D,U){switch(q){case mo:if(x.byteLength!=z.byteLength||x.byteOffset!=z.byteOffset)return!1;x=x.buffer,z=z.buffer;case vo:return!(x.byteLength!=z.byteLength||!D(new Ie(x),new Ie(z)));case uo:case lo:case po:return ke(+x,+z);case ho:return x.name==z.name&&x.message==z.message;case go:case _o:return x==z+"";case fo:var B=io;case wo:if(B||(B=so),x.size!=z.size&&!(L&ao))return!1;var Q=U.get(x);if(Q)return Q==z;L|=co,U.set(x,z);var X=cr(B(x),B(z),L,he,D,U);return U.delete(x),X;case yo:if(ut)return ut.call(x)==ut.call(z)}return!1}(a,c,l,h,d,f,p);if(!(h&So)){var I=v&&fr.call(a,"__wrapped__"),$=S&&fr.call(c,"__wrapped__");if(I||$){var M=I?a.value():a,V=$?c.value():c;return p||(p=new G),f(M,V,h,d,p)}}return!!O&&(p||(p=new G),function(x,z,q,L,he,D){var U=q&bo,B=nt(x),Q=B.length;if(Q!=nt(z).length&&!U)return!1;for(var X=Q;X--;){var u=B[X];if(!(U?u in z:jo.call(z,u)))return!1}var i=D.get(x),s=D.get(z);if(i&&s)return i==z&&s==x;var g=!0;D.set(x,z),D.set(z,x);for(var m=U;++X<Q;){var b=x[u=B[X]],j=z[u];if(L)var E=U?L(j,b,u,z,x,D):L(b,j,u,x,z,D);if(!(E===void 0?b===j||he(b,j,q,L,D):E)){g=!1;break}m||(m=u=="constructor")}if(g&&!m){var N=x.constructor,F=z.constructor;N==F||!("constructor"in x)||!("constructor"in z)||typeof N=="function"&&N instanceof N&&typeof F=="function"&&F instanceof F||(g=!1)}return D.delete(x),D.delete(z),g}(a,c,h,d,f,p))}(e,r,t,n,lt,o))}var Oo=1,xo=2;function dr(e){return e==e&&!ee(e)}function pr(e,r){return function(t){return t!=null&&t[e]===r&&(r!==void 0||e in Object(t))}}function ko(e,r){return e!=null&&r in Object(e)}var zo=1,Ao=2;function ie(e){return typeof e=="function"?e:e==null?Oe:typeof e=="object"?C(e)?function(a,c){return Ke(a)&&dr(c)?pr(Te(a),c):function(h){var d=function(f,p,y){var w=f==null?void 0:et(f,p);return w===void 0?void 0:w}(h,a);return d===void 0&&d===c?function(f,p){return f!=null&&function(y,w,l){for(var _=-1,v=(w=Rt(w,y)).length,S=!1;++_<v;){var O=Te(w[_]);if(!(S=y!=null&&l(y,O)))break;y=y[O]}return S||++_!=v?S:!!(v=y==null?0:y.length)&&Je(v)&&Le(O,v)&&(C(y)||He(y))}(f,p,ko)}(h,a):lt(c,d,zo|Ao)}}(e[0],e[1]):(o=function(a){for(var c=ye(a),h=c.length;h--;){var d=c[h],f=a[d];c[h]=[d,f,dr(f)]}return c}(n=e),o.length==1&&o[0][2]?pr(o[0][0],o[0][1]):function(a){return a===n||function(c,h,d,f){var p=d.length,y=p;if(c==null)return!y;for(c=Object(c);p--;){var w=d[p];if(w[2]?w[1]!==c[w[0]]:!(w[0]in c))return!1}for(;++p<y;){var l=(w=d[p])[0],_=c[l],v=w[1];if(w[2]){if(_===void 0&&!(l in c))return!1}else{var S=new G;if(!lt(v,_,Oo|xo,void 0,S))return!1}}return!0}(a,0,o)}):Ke(r=e)?(t=Te(r),function(a){return a==null?void 0:a[t]}):function(a){return function(c){return et(c,a)}}(r);var r,t,n,o}var Eo=function(e,r,t){for(var n=-1,o=Object(e),a=t(e),c=a.length;c--;){var h=a[++n];if(r(o[h],h,o)===!1)break}return e};function gr(e,r){return e&&Eo(e,r,ye)}var wr,Po=(wr=gr,function(e,r){if(e==null)return e;if(!ue(e))return wr(e,r);for(var t=e.length,n=-1,o=Object(e);++n<t&&r(o[n],n,o)!==!1;);return e});function _r(e,r){var t=-1,n=ue(e)?Array(e.length):[];return Po(e,function(o,a,c){n[++t]=r(o,a,c)}),n}function Fo(e,r){return e>r}var To=Math.min;function Io(e){return function(r){return H(r)&&ue(r)}(e)?e:[]}var Mo=Et(function(e){var r=ce(e,Io);return r.length&&r[0]===e[0]?function(t,n,o){for(var a=Qr,c=t[0].length,h=t.length,d=h,f=Array(h),p=1/0,y=[];d--;){var w=t[d];p=To(w.length,p),f[d]=c>=120&&w.length>=120?new je(d&&w):void 0}w=t[0];var l=-1,_=f[0];e:for(;++l<c&&y.length<p;){var v=w[l],S=v;if(v=v!==0?v:0,!(_?ct(_,S):a(y,S,o))){for(d=h;--d;){var O=f[d];if(!(O?ct(O,S):a(t[d],S,o)))continue e}_&&_.push(S),y.push(v)}}return y}(r):[]}),$o=Mo;function No(e,r){return e<r}function A(e,r){var t={};return r=ie(r),gr(e,function(n,o,a){Be(t,o,r(n,o,a))}),t}function yr(e,r,t){for(var n=-1,o=e.length;++n<o;){var a=e[n],c=r(a);if(c!=null&&(h===void 0?c==c&&!ae(c):t(c,h)))var h=c,d=a}return d}function Co(e,r){return e&&e.length?yr(e,ie(r),Fo):void 0}function vr(e,r){for(var t,n=-1,o=e.length;++n<o;){var a=r(e[n]);a!==void 0&&(t=t===void 0?a:t+a)}return t}function Wo(e,r){return function(t,n){var o=t==null?0:t.length;return o?vr(t,n)/o:NaN}(e,ie(r))}function Do(e,r){if(e!==r){var t=e!==void 0,n=e===null,o=e==e,a=ae(e),c=r!==void 0,h=r===null,d=r==r,f=ae(r);if(!h&&!f&&!a&&e>r||a&&c&&d&&!h&&!f||n&&c&&d||!t&&d||!o)return 1;if(!n&&!a&&!f&&e<r||f&&t&&o&&!n&&!a||h&&t&&o||!c&&o||!d)return-1}return 0}function mr(e,r,t){r=r.length?ce(r,function(o){return C(o)?function(a){return et(a,o.length===1?o[0]:o)}:o}):[Oe];var n=-1;return r=ce(r,Ee(ie)),function(o,a){var c=o.length;for(o.sort(function(h,d){return function(f,p,y){for(var w=-1,l=f.criteria,_=p.criteria,v=l.length,S=y.length;++w<v;){var O=Do(l[w],_[w]);if(O)return w>=S?O:O*(y[w]=="desc"?-1:1)}return f.index-p.index}(h,d,t)});c--;)o[c]=o[c].value;return o}(_r(e,function(o,a,c){return{criteria:ce(r,function(h){return h(o)}),index:++n,value:o}}))}function ht(e,r,t,n){return e==null?[]:(C(r)||(r=r==null?[]:[r]),C(t=t)||(t=t==null?[]:[t]),mr(e,r,t))}var Vo=Et(function(e,r){if(e==null)return[];var t=r.length;return t>1&&Pt(e,r[0],r[1])?r=[]:t>2&&Pt(r[0],r[1],r[2])&&(r=[r[0]]),mr(e,mn(r),[])});function Ro(e,r){return e&&e.length?vr(e,ie(r)):0}function k(e){if(this.words=[],e)if(Symbol&&Symbol.iterator&&e[Symbol.iterator]!==void 0){const r=e[Symbol.iterator]();let t=r.next();for(;!t.done;)this.add(t.value),t=r.next()}else for(let r=0;r<e.length;r++)this.add(e[r])}k.fromWords=function(e){const r=Object.create(k.prototype);return r.words=e,r},k.prototype.add=function(e){this.resize(e),this.words[e>>>5]|=1<<e},k.prototype.flip=function(e){this.resize(e),this.words[e>>>5]^=1<<e},k.prototype.clear=function(){this.words.length=0},k.prototype.remove=function(e){this.resize(e),this.words[e>>>5]&=~(1<<e)},k.prototype.isEmpty=function(e){const r=this.words.length;for(let t=0;t<r;t++)if(this.words[t]!==0)return!1;return!0},k.prototype.has=function(e){return(this.words[e>>>5]&1<<e)!=0},k.prototype.checkedAdd=function(e){this.resize(e);const r=this.words[e>>>5],t=r|1<<e;return this.words[e>>>5]=t,(t^r)>>>e},k.prototype.trim=function(e){let r=this.words.length;for(;r>0&&this.words[r-1]===0;)r--;this.words.length=r},k.prototype.resize=function(e){const r=e+32>>>5;for(let t=this.words.length;t<r;t++)this.words[t]=0},k.prototype.hammingWeight=function(e){return 16843009*((e=(858993459&(e-=e>>>1&1431655765))+(e>>>2&858993459))+(e>>>4)&252645135)>>>24},k.prototype.hammingWeight4=function(e,r,t,n){return 16843009*((e=(e=(858993459&(e-=e>>>1&1431655765))+(e>>>2&858993459))+(e>>>4)&252645135)+(r=(r=(858993459&(r-=r>>>1&1431655765))+(r>>>2&858993459))+(r>>>4)&252645135)+(t=(t=(858993459&(t-=t>>>1&1431655765))+(t>>>2&858993459))+(t>>>4)&252645135)+(n=(n=(858993459&(n-=n>>>1&1431655765))+(n>>>2&858993459))+(n>>>4)&252645135))>>>24},k.prototype.size=function(){let e=0;const r=this.words.length,t=this.words;for(let n=0;n<r;n++)e+=this.hammingWeight(t[n]);return e},k.prototype.array=function(){const e=new Array(this.size());let r=0;const t=this.words.length;for(let n=0;n<t;++n){let o=this.words[n];for(;o!=0;){const a=o&-o;e[r++]=(n<<5)+this.hammingWeight(a-1|0),o^=a}}return e},k.prototype.forEach=function(e){const r=this.words.length;for(let t=0;t<r;++t){let n=this.words[t];for(;n!=0;){const o=n&-n;e((t<<5)+this.hammingWeight(o-1|0)),n^=o}}},k.prototype[Symbol.iterator]=function(){const e=this.words.length;let r=0,t=this.words[r],n=this.hammingWeight,o=this.words;return{[Symbol.iterator](){return this},next(){for(;r<e;){if(t!==0){const a=t&-t,c=(r<<5)+n(a-1|0);return t^=a,{done:!1,value:c}}r++,r<e&&(t=o[r])}return{done:!0,value:void 0}}}},k.prototype.clone=function(){const e=Object.create(k.prototype);return e.words=this.words.slice(),e},k.prototype.intersects=function(e){const r=Math.min(this.words.length,e.words.length);for(let t=0;t<r;++t)if((this.words[t]&e.words[t])!=0)return!0;return!1},k.prototype.intersection=function(e){const r=Math.min(this.words.length,e.words.length);let t=0;for(;t+7<r;t+=8)this.words[t]&=e.words[t],this.words[t+1]&=e.words[t+1],this.words[t+2]&=e.words[t+2],this.words[t+3]&=e.words[t+3],this.words[t+4]&=e.words[t+4],this.words[t+5]&=e.words[t+5],this.words[t+6]&=e.words[t+6],this.words[t+7]&=e.words[t+7];for(;t<r;++t)this.words[t]&=e.words[t];const n=this.words.length;for(t=r;t<n;++t)this.words[t]=0;return this},k.prototype.intersection_size=function(e){const r=Math.min(this.words.length,e.words.length);let t=0;for(let n=0;n<r;++n)t+=this.hammingWeight(this.words[n]&e.words[n]);return t},k.prototype.new_intersection=function(e){const r=Object.create(k.prototype),t=Math.min(this.words.length,e.words.length);r.words=new Array(t);let n=0;for(;n+7<t;n+=8)r.words[n]=this.words[n]&e.words[n],r.words[n+1]=this.words[n+1]&e.words[n+1],r.words[n+2]=this.words[n+2]&e.words[n+2],r.words[n+3]=this.words[n+3]&e.words[n+3],r.words[n+4]=this.words[n+4]&e.words[n+4],r.words[n+5]=this.words[n+5]&e.words[n+5],r.words[n+6]=this.words[n+6]&e.words[n+6],r.words[n+7]=this.words[n+7]&e.words[n+7];for(;n<t;++n)r.words[n]=this.words[n]&e.words[n];return r},k.prototype.equals=function(e){const r=Math.min(this.words.length,e.words.length);for(let t=0;t<r;++t)if(this.words[t]!=e.words[t])return!1;if(this.words.length<e.words.length){const t=e.words.length;for(let n=this.words.length;n<t;++n)if(e.words[n]!=0)return!1}else if(e.words.length<this.words.length){const t=this.words.length;for(let n=e.words.length;n<t;++n)if(this.words[n]!=0)return!1}return!0},k.prototype.difference=function(e){const r=Math.min(this.words.length,e.words.length);let t=0;for(;t+7<r;t+=8)this.words[t]&=~e.words[t],this.words[t+1]&=~e.words[t+1],this.words[t+2]&=~e.words[t+2],this.words[t+3]&=~e.words[t+3],this.words[t+4]&=~e.words[t+4],this.words[t+5]&=~e.words[t+5],this.words[t+6]&=~e.words[t+6],this.words[t+7]&=~e.words[t+7];for(;t<r;++t)this.words[t]&=~e.words[t];return this},k.prototype.new_difference=function(e){return this.clone().difference(e)},k.prototype.difference2=function(e){const r=Math.min(this.words.length,e.words.length);let t=0;for(;t+7<r;t+=8)e.words[t]=this.words[t]&~e.words[t],e.words[t+1]=this.words[t+1]&~e.words[t+1],e.words[t+2]=this.words[t+2]&~e.words[t+2],e.words[t+3]=this.words[t+3]&~e.words[t+3],e.words[t+4]=this.words[t+4]&~e.words[t+4],e.words[t+5]=this.words[t+5]&~e.words[t+5],e.words[t+6]=this.words[t+6]&~e.words[t+6],e.words[t+7]=this.words[t+7]&~e.words[t+7];for(;t<r;++t)e.words[t]=this.words[t]&~e.words[t];for(t=this.words.length-1;t>=r;--t)e.words[t]=this.words[t];return e.words.length=this.words.length,e},k.prototype.difference_size=function(e){const r=Math.min(this.words.length,e.words.length);let t=0,n=0;for(;n<r;++n)t+=this.hammingWeight(this.words[n]&~e.words[n]);const o=this.words.length;for(;n<o;++n)t+=this.hammingWeight(this.words[n]);return t},k.prototype.change=function(e){const r=Math.min(this.words.length,e.words.length);let t=0;for(;t+7<r;t+=8)this.words[t]^=e.words[t],this.words[t+1]^=e.words[t+1],this.words[t+2]^=e.words[t+2],this.words[t+3]^=e.words[t+3],this.words[t+4]^=e.words[t+4],this.words[t+5]^=e.words[t+5],this.words[t+6]^=e.words[t+6],this.words[t+7]^=e.words[t+7];for(;t<r;++t)this.words[t]^=e.words[t];for(t=e.words.length-1;t>=r;--t)this.words[t]=e.words[t];return this},k.prototype.new_change=function(e){const r=Object.create(k.prototype),t=Math.max(this.words.length,e.words.length);r.words=new Array(t);const n=Math.min(this.words.length,e.words.length);let o=0;for(;o+7<n;o+=8)r.words[o]=this.words[o]^e.words[o],r.words[o+1]=this.words[o+1]^e.words[o+1],r.words[o+2]=this.words[o+2]^e.words[o+2],r.words[o+3]=this.words[o+3]^e.words[o+3],r.words[o+4]=this.words[o+4]^e.words[o+4],r.words[o+5]=this.words[o+5]^e.words[o+5],r.words[o+6]=this.words[o+6]^e.words[o+6],r.words[o+7]=this.words[o+7]^e.words[o+7];for(;o<n;++o)r.words[o]=this.words[o]^e.words[o];const a=this.words.length;for(o=n;o<a;++o)r.words[o]=this.words[o];const c=e.words.length;for(o=n;o<c;++o)r.words[o]=e.words[o];return r},k.prototype.change_size=function(e){const r=Math.min(this.words.length,e.words.length);let t=0,n=0;for(;n<r;++n)t+=this.hammingWeight(this.words[n]^e.words[n]);const o=this.words.length>e.words.length?this:e,a=o.words.length;for(;n<a;++n)t+=this.hammingWeight(o.words[n]);return t},k.prototype.toString=function(){return"{"+this.array().join(",")+"}"},k.prototype.union=function(e){const r=Math.min(this.words.length,e.words.length);let t=0;for(;t+7<r;t+=8)this.words[t]|=e.words[t],this.words[t+1]|=e.words[t+1],this.words[t+2]|=e.words[t+2],this.words[t+3]|=e.words[t+3],this.words[t+4]|=e.words[t+4],this.words[t+5]|=e.words[t+5],this.words[t+6]|=e.words[t+6],this.words[t+7]|=e.words[t+7];for(;t<r;++t)this.words[t]|=e.words[t];if(this.words.length<e.words.length){this.resize((e.words.length<<5)-1);const n=e.words.length;for(let o=r;o<n;++o)this.words[o]=e.words[o]}return this},k.prototype.new_union=function(e){const r=Object.create(k.prototype),t=Math.max(this.words.length,e.words.length);r.words=new Array(t);const n=Math.min(this.words.length,e.words.length);let o=0;for(;o+7<n;o+=8)r.words[o]=this.words[o]|e.words[o],r.words[o+1]=this.words[o+1]|e.words[o+1],r.words[o+2]=this.words[o+2]|e.words[o+2],r.words[o+3]=this.words[o+3]|e.words[o+3],r.words[o+4]=this.words[o+4]|e.words[o+4],r.words[o+5]=this.words[o+5]|e.words[o+5],r.words[o+6]=this.words[o+6]|e.words[o+6],r.words[o+7]=this.words[o+7]|e.words[o+7];for(;o<n;++o)r.words[o]=this.words[o]|e.words[o];const a=this.words.length;for(o=n;o<a;++o)r.words[o]=this.words[o];const c=e.words.length;for(o=n;o<c;++o)r.words[o]=e.words[o];return r},k.prototype.union_size=function(e){const r=Math.min(this.words.length,e.words.length);let t=0;for(let n=0;n<r;++n)t+=this.hammingWeight(this.words[n]|e.words[n]);if(this.words.length<e.words.length){const n=e.words.length;for(let o=this.words.length;o<n;++o)t+=this.hammingWeight(0|e.words[o])}else{const n=this.words.length;for(let o=e.words.length;o<n;++o)t+=this.hammingWeight(0|this.words[o])}return t};var W=k;function ft(){return ft=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},ft.apply(this,arguments)}function Uo(e,r){var t=[];return e.forEach(function(n){r.forEach(function(o){t.push(n.concat(o))})}),t}function br(e){return!!~e.search(/\(|\)/)}function jr(e,r){for(var t=r.split(" "+e+" "),n=[],o=[],a=0;a<t.length;a++)if(br(t[a])||o.length>0){o.push(t[a]);var c=""+o;(c.match(/\(/g)||[]).length===(c.match(/\)/g)||[]).length&&(n.push(o.join(" "+e+" ")),o=[])}else n.push(t[a]);return n}var qo=function e(r){return function(n){for(var o=n[0],a=1;a<n.length;a++)o=o.concat(n[a]);return o}(jr("OR",(t=r=function(n){if(n.charAt(0)==="("){for(var o=0,a=0;a<n.length;a++)if(n.charAt(a)==="("?o++:n.charAt(a)===")"&&o--,o===0)return a!==n.length-1?n:n.substring(1,n.length-1)}return n}(r),r=t.replace(/[\s]+/g," "))).map(function(n){for(var o=jr("AND",n),a=[],c=[],h=0;h<o.length;h++)br(o[h])?a.push(e(o[h])):c.push(o[h]);return a.push([c]),function(d){for(var f=[[]],p=0;p<d.length;p++)f=Uo(f,d[p]);return f}(a)}));var t};const Sr=function(e){try{return structuredClone(e)}catch{try{return JSON.parse(JSON.stringify(e))}catch{return e}}},Or=function(e,r){let t=new W([]),n=0;return A(r,function(o,a){o.forEach(c=>{++n,t=t.new_union(e[a][c]||new W([]))})}),n===0?null:t},Lo=function(e,r,t){let n=1;return A(e.bits_data_temp,(o,a)=>{let c,h,d,f,p,y,w;t[a]&&(c=t[a].order,h=t[a].sort,d=t[a].size,f=t[a].title,p=t[a].show_facet_stats||!1,y=t[a].chosen_filters_on_top!==!1,w=t[a].hide_zero_doc_count||!1);let l,_,v,S,O=Object.entries(o).map(M=>{let V=[];r&&r.filters&&r.filters[a]&&(V=r.filters[a]);const x=M[1].array().length;if(!w||x!==0||V.indexOf(M[0])!==-1)return{key:M[0],doc_count:x,selected:V.indexOf(M[0])!==-1}}).filter(Boolean);var I,$;return C(h)?(l=h||["key"],_=c||["asc"]):(h==="term"||h==="key"?(l=["key"],_=[c||"asc"]):(l=["doc_count","key"],_=[c||"desc","asc"]),y&&(l.unshift("selected"),_.unshift("desc"))),O=ht(O,l,_),O=O.slice(0,d||10),p&&(v=[],Object.entries(o).forEach(M=>{if(isNaN(M[0]))throw new Error("You cant use chars to calculate the facet_stats.");M[1].array().length>0&&M[1].forEach(()=>{v.push(parseInt(M[0]))})}),S={min:(I=v,I&&I.length?yr(I,ie(void 0),No):void 0),max:Co(v),avg:Wo(v),sum:Ro(v)}),ft({name:a,title:f||($=a,$.replace(/^[\s_]+|[\s_]+$/g,"").replace(/[_\s]+/g," ").replace(/^[a-z]/,function(M){return M.toUpperCase()})),position:n++,buckets:O},p&&{facet_stats:S})})};function xr(e,r,t,n,o){r=r||Object.create(null);const a=parseInt(r.per_page||12),c=parseInt(r.page||1),h=r.is_all_filtered_items||!1;if(t.native_search_enabled===!1&&(r.query||r.filter))throw new Error('"query" and "filter" options are not working once native search is disabled');let d=0;const f=new Date().getTime();let p,y,w,l=o.bits_ids();if(r._ids)p=new W(r._ids),y=r._ids;else if(r.ids)y=o.internal_ids_from_ids_map(r.ids),p=new W(y);else if(n&&(r.query||r.filter)){const x=new Date().getTime();y=n.search(r.query,r.filter),d=new Date().getTime()-x,p=new W(y)}let _=new Date().getTime();const v=o.search(r,{query_ids:p});_=new Date().getTime()-_,p&&(l=p),v.ids&&(l=l.new_intersection(v.ids)),v.not_ids&&(l=l.new_difference(v.not_ids));let S=l.array(),O=S.map(x=>o.get_item(x)),I=!1;const $=new Date().getTime();let M=0;r.sort?O=function(x,z,q){return q&&q[z]&&(z=q[z]),z.field?ht(x,z.field,z.order||"asc"):x}(O,r.sort,t.sortings):y&&(S=y.filter(x=>l.has(x)),O=S.slice((c-1)*a,c*a).map(x=>o.get_item(x)),I=!0),I||(w=h?O:null,O=O.slice((c-1)*a,c*a)),M=new Date().getTime()-$;const V=new Date().getTime()-f;return{pagination:{per_page:a,page:c,total:S.length},timings:{total:V,facets:_,search:d,sorting:M},data:{items:O,allFilteredItems:w,aggregations:Lo(v,r,t.aggregations)}}}var Ne=function(e){var r={exports:{}};return function(t,n){(function(){var o,a,c,h,d,f,p,y,w,l,_,v,S,O,I,$,M,V,x,z,q,L,he,D,U,B,Q,X,u=function(i){var s=new u.Index;return s.pipeline.add(u.trimmer,u.stopWordFilter,u.stemmer),i&&i.call(s,s),s};u.version="1.0.0",u.utils={},u.utils.warn=function(i){return function(s){i.console&&console.warn&&console.warn(s)}}(this),u.utils.asString=function(i){return i==null?"":i.toString()},u.EventEmitter=function(){this.events={}},u.EventEmitter.prototype.addListener=function(){var i=Array.prototype.slice.call(arguments),s=i.pop(),g=i;if(typeof s!="function")throw new TypeError("last argument must be a function");g.forEach(function(m){this.hasHandler(m)||(this.events[m]=[]),this.events[m].push(s)},this)},u.EventEmitter.prototype.removeListener=function(i,s){if(this.hasHandler(i)){var g=this.events[i].indexOf(s);this.events[i].splice(g,1),this.events[i].length||delete this.events[i]}},u.EventEmitter.prototype.emit=function(i){if(this.hasHandler(i)){var s=Array.prototype.slice.call(arguments,1);this.events[i].forEach(function(g){g.apply(void 0,s)})}},u.EventEmitter.prototype.hasHandler=function(i){return i in this.events},u.tokenizer=function(i){return arguments.length&&i!=null&&i!=null?Array.isArray(i)?i.map(function(s){return u.utils.asString(s).toLowerCase()}):i.toString().trim().toLowerCase().split(u.tokenizer.separator):[]},u.tokenizer.separator=/[\s\-]+/,u.tokenizer.load=function(i){var s=this.registeredFunctions[i];if(!s)throw new Error("Cannot load un-registered function: "+i);return s},u.tokenizer.label="default",u.tokenizer.registeredFunctions={default:u.tokenizer},u.tokenizer.registerFunction=function(i,s){s in this.registeredFunctions&&u.utils.warn("Overwriting existing tokenizer: "+s),i.label=s,this.registeredFunctions[s]=i},u.Pipeline=function(){this._stack=[]},u.Pipeline.registeredFunctions={},u.Pipeline.registerFunction=function(i,s){s in this.registeredFunctions&&u.utils.warn("Overwriting existing registered function: "+s),i.label=s,u.Pipeline.registeredFunctions[i.label]=i},u.Pipeline.warnIfFunctionNotRegistered=function(i){i.label&&i.label in this.registeredFunctions||u.utils.warn(`Function is not registered with pipeline. This may cause problems when serialising the index.
`,i)},u.Pipeline.load=function(i){var s=new u.Pipeline;return i.forEach(function(g){var m=u.Pipeline.registeredFunctions[g];if(!m)throw new Error("Cannot load un-registered function: "+g);s.add(m)}),s},u.Pipeline.prototype.add=function(){Array.prototype.slice.call(arguments).forEach(function(i){u.Pipeline.warnIfFunctionNotRegistered(i),this._stack.push(i)},this)},u.Pipeline.prototype.after=function(i,s){u.Pipeline.warnIfFunctionNotRegistered(s);var g=this._stack.indexOf(i);if(g==-1)throw new Error("Cannot find existingFn");this._stack.splice(g+=1,0,s)},u.Pipeline.prototype.before=function(i,s){u.Pipeline.warnIfFunctionNotRegistered(s);var g=this._stack.indexOf(i);if(g==-1)throw new Error("Cannot find existingFn");this._stack.splice(g,0,s)},u.Pipeline.prototype.remove=function(i){var s=this._stack.indexOf(i);s!=-1&&this._stack.splice(s,1)},u.Pipeline.prototype.run=function(i){for(var s=[],g=i.length,m=this._stack.length,b=0;b<g;b++){for(var j=i[b],E=0;E<m&&(j=this._stack[E](j,b,i))!==void 0&&j!=="";E++);j!==void 0&&j!==""&&s.push(j)}return s},u.Pipeline.prototype.reset=function(){this._stack=[]},u.Pipeline.prototype.toJSON=function(){return this._stack.map(function(i){return u.Pipeline.warnIfFunctionNotRegistered(i),i.label})},u.Vector=function(){this._magnitude=null,this.list=void 0,this.length=0},u.Vector.Node=function(i,s,g){this.idx=i,this.val=s,this.next=g},u.Vector.prototype.insert=function(i,s){this._magnitude=void 0;var g=this.list;if(!g)return this.list=new u.Vector.Node(i,s,g),this.length++;if(i<g.idx)return this.list=new u.Vector.Node(i,s,g),this.length++;for(var m=g,b=g.next;b!=null;){if(i<b.idx)return m.next=new u.Vector.Node(i,s,b),this.length++;m=b,b=b.next}return m.next=new u.Vector.Node(i,s,b),this.length++},u.Vector.prototype.magnitude=function(){if(this._magnitude)return this._magnitude;for(var i,s=this.list,g=0;s;)g+=(i=s.val)*i,s=s.next;return this._magnitude=Math.sqrt(g)},u.Vector.prototype.dot=function(i){for(var s=this.list,g=i.list,m=0;s&&g;)s.idx<g.idx?s=s.next:(s.idx>g.idx||(m+=s.val*g.val,s=s.next),g=g.next);return m},u.Vector.prototype.similarity=function(i){return this.dot(i)/(this.magnitude()*i.magnitude())},u.SortedSet=function(){this.length=0,this.elements=[]},u.SortedSet.load=function(i){var s=new this;return s.elements=i,s.length=i.length,s},u.SortedSet.prototype.add=function(){var i,s;for(i=0;i<arguments.length;i++)~this.indexOf(s=arguments[i])||this.elements.splice(this.locationFor(s),0,s);this.length=this.elements.length},u.SortedSet.prototype.toArray=function(){return this.elements.slice()},u.SortedSet.prototype.map=function(i,s){return this.elements.map(i,s)},u.SortedSet.prototype.forEach=function(i,s){return this.elements.forEach(i,s)},u.SortedSet.prototype.indexOf=function(i){for(var s=0,g=this.elements.length,m=g-s,b=s+Math.floor(m/2),j=this.elements[b];m>1;){if(j===i)return b;j<i&&(s=b),j>i&&(g=b),m=g-s,b=s+Math.floor(m/2),j=this.elements[b]}return j===i?b:-1},u.SortedSet.prototype.locationFor=function(i){for(var s=0,g=this.elements.length,m=g-s,b=s+Math.floor(m/2),j=this.elements[b];m>1;)j<i&&(s=b),j>i&&(g=b),m=g-s,b=s+Math.floor(m/2),j=this.elements[b];return j>i?b:j<i?b+1:void 0},u.SortedSet.prototype.intersect=function(i){for(var s=new u.SortedSet,g=0,m=0,b=this.length,j=i.length,E=this.elements,N=i.elements;!(g>b-1||m>j-1);)E[g]!==N[m]?E[g]<N[m]?g++:E[g]>N[m]&&m++:(s.add(E[g]),g++,m++);return s},u.SortedSet.prototype.clone=function(){var i=new u.SortedSet;return i.elements=this.toArray(),i.length=i.elements.length,i},u.SortedSet.prototype.union=function(i){var s,g,m;this.length>=i.length?(s=this,g=i):(s=i,g=this),m=s.clone();for(var b=0,j=g.toArray();b<j.length;b++)m.add(j[b]);return m},u.SortedSet.prototype.toJSON=function(){return this.toArray()},u.Index=function(){this._fields=[],this._ref="id",this.pipeline=new u.Pipeline,this.documentStore=new u.Store,this.tokenStore=new u.TokenStore,this.corpusTokens=new u.SortedSet,this.eventEmitter=new u.EventEmitter,this.tokenizerFn=u.tokenizer,this._idfCache={},this.on("add","remove","update",(function(){this._idfCache={}}).bind(this))},u.Index.prototype.on=function(){var i=Array.prototype.slice.call(arguments);return this.eventEmitter.addListener.apply(this.eventEmitter,i)},u.Index.prototype.off=function(i,s){return this.eventEmitter.removeListener(i,s)},u.Index.load=function(i){i.version!==u.version&&u.utils.warn("version mismatch: current "+u.version+" importing "+i.version);var s=new this;return s._fields=i.fields,s._ref=i.ref,s.tokenizer(u.tokenizer.load(i.tokenizer)),s.documentStore=u.Store.load(i.documentStore),s.tokenStore=u.TokenStore.load(i.tokenStore),s.corpusTokens=u.SortedSet.load(i.corpusTokens),s.pipeline=u.Pipeline.load(i.pipeline),s},u.Index.prototype.field=function(i,s){return this._fields.push({name:i,boost:(s=s||{}).boost||1}),this},u.Index.prototype.ref=function(i){return this._ref=i,this},u.Index.prototype.tokenizer=function(i){return i.label&&i.label in u.tokenizer.registeredFunctions||u.utils.warn("Function is not a registered tokenizer. This may cause problems when serialising the index"),this.tokenizerFn=i,this},u.Index.prototype.add=function(i,s){var g={},m=new u.SortedSet,b=i[this._ref];s=s===void 0||s,this._fields.forEach(function(We){var pe=this.pipeline.run(this.tokenizerFn(i[We.name]));g[We.name]=pe;for(var ge=0;ge<pe.length;ge++){var De=pe[ge];m.add(De),this.corpusTokens.add(De)}},this),this.documentStore.set(b,m);for(var j=0;j<m.length;j++){for(var E=m.elements[j],N=0,F=0;F<this._fields.length;F++){var fe=this._fields[F],Ce=g[fe.name],Se=Ce.length;if(Se){for(var Z=0,de=0;de<Se;de++)Ce[de]===E&&Z++;N+=Z/Se*fe.boost}}this.tokenStore.add(E,{ref:b,tf:N})}s&&this.eventEmitter.emit("add",i,this)},u.Index.prototype.remove=function(i,s){var g=i[this._ref];if(s=s===void 0||s,this.documentStore.has(g)){var m=this.documentStore.get(g);this.documentStore.remove(g),m.forEach(function(b){this.tokenStore.remove(b,g)},this),s&&this.eventEmitter.emit("remove",i,this)}},u.Index.prototype.update=function(i,s){s=s===void 0||s,this.remove(i,!1),this.add(i,!1),s&&this.eventEmitter.emit("update",i,this)},u.Index.prototype.idf=function(i){var s="@"+i;if(Object.prototype.hasOwnProperty.call(this._idfCache,s))return this._idfCache[s];var g=this.tokenStore.count(i),m=1;return g>0&&(m=1+Math.log(this.documentStore.length/g)),this._idfCache[s]=m},u.Index.prototype.search=function(i){var s=this.pipeline.run(this.tokenizerFn(i)),g=new u.Vector,m=[],b=this._fields.reduce(function(j,E){return j+E.boost},0);return s.some(function(j){return this.tokenStore.has(j)},this)?(s.forEach(function(j,E,N){var F=1/N.length*this._fields.length*b,fe=this,Ce=this.tokenStore.expand(j).reduce(function(Se,Z){var de=fe.corpusTokens.indexOf(Z),We=fe.idf(Z),pe=1,ge=new u.SortedSet;if(Z!==j){var De=Math.max(3,Z.length-j.length);pe=1/Math.log(De)}de>-1&&g.insert(de,F*We*pe);for(var Ar=fe.tokenStore.get(Z),Er=Object.keys(Ar),Ho=Er.length,pt=0;pt<Ho;pt++)ge.add(Ar[Er[pt]].ref);return Se.union(ge)},new u.SortedSet);m.push(Ce)},this),m.reduce(function(j,E){return j.intersect(E)}).map(function(j){return{ref:j,score:g.similarity(this.documentVector(j))}},this).sort(function(j,E){return E.score-j.score})):[]},u.Index.prototype.documentVector=function(i){for(var s=this.documentStore.get(i),g=s.length,m=new u.Vector,b=0;b<g;b++){var j=s.elements[b],E=this.tokenStore.get(j)[i].tf,N=this.idf(j);m.insert(this.corpusTokens.indexOf(j),E*N)}return m},u.Index.prototype.toJSON=function(){return{version:u.version,fields:this._fields,ref:this._ref,tokenizer:this.tokenizerFn.label,documentStore:this.documentStore.toJSON(),tokenStore:this.tokenStore.toJSON(),corpusTokens:this.corpusTokens.toJSON(),pipeline:this.pipeline.toJSON()}},u.Index.prototype.use=function(i){var s=Array.prototype.slice.call(arguments,1);s.unshift(this),i.apply(this,s)},u.Store=function(){this.store={},this.length=0},u.Store.load=function(i){var s=new this;return s.length=i.length,s.store=Object.keys(i.store).reduce(function(g,m){return g[m]=u.SortedSet.load(i.store[m]),g},{}),s},u.Store.prototype.set=function(i,s){this.has(i)||this.length++,this.store[i]=s},u.Store.prototype.get=function(i){return this.store[i]},u.Store.prototype.has=function(i){return i in this.store},u.Store.prototype.remove=function(i){this.has(i)&&(delete this.store[i],this.length--)},u.Store.prototype.toJSON=function(){return{store:this.store,length:this.length}},u.stemmer=(o={ational:"ate",tional:"tion",enci:"ence",anci:"ance",izer:"ize",bli:"ble",alli:"al",entli:"ent",eli:"e",ousli:"ous",ization:"ize",ation:"ate",ator:"ate",alism:"al",iveness:"ive",fulness:"ful",ousness:"ous",aliti:"al",iviti:"ive",biliti:"ble",logi:"log"},a={icate:"ic",ative:"",alize:"al",iciti:"ic",ical:"ic",ful:"",ness:""},f="^("+(h="[^aeiou][^aeiouy]*")+")?"+(d=(c="[aeiouy]")+"[aeiou]*")+h+"("+d+")?$",p="^("+h+")?"+d+h+d+h,y="^("+h+")?"+c,w=new RegExp("^("+h+")?"+d+h),l=new RegExp(p),_=new RegExp(f),v=new RegExp(y),S=/^(.+?)(ss|i)es$/,O=/^(.+?)([^s])s$/,I=/^(.+?)eed$/,$=/^(.+?)(ed|ing)$/,M=/.$/,V=/(at|bl|iz)$/,x=new RegExp("([^aeiouylsz])\\1$"),z=new RegExp("^"+h+c+"[^aeiouwxy]$"),q=/^(.+?[^aeiou])y$/,L=/^(.+?)(ational|tional|enci|anci|izer|bli|alli|entli|eli|ousli|ization|ation|ator|alism|iveness|fulness|ousness|aliti|iviti|biliti|logi)$/,he=/^(.+?)(icate|ative|alize|iciti|ical|ful|ness)$/,D=/^(.+?)(al|ance|ence|er|ic|able|ible|ant|ement|ment|ent|ou|ism|ate|iti|ous|ive|ize)$/,U=/^(.+?)(s|t)(ion)$/,B=/^(.+?)e$/,Q=/ll$/,X=new RegExp("^"+h+c+"[^aeiouwxy]$"),function(i){var s,g,m,b,j,E,N;if(i.length<3)return i;if((m=i.substr(0,1))=="y"&&(i=m.toUpperCase()+i.substr(1)),j=O,(b=S).test(i)?i=i.replace(b,"$1$2"):j.test(i)&&(i=i.replace(j,"$1$2")),j=$,(b=I).test(i)){var F=b.exec(i);(b=w).test(F[1])&&(i=i.replace(b=M,""))}else j.test(i)&&(F=j.exec(i),(j=v).test(s=F[1])&&(E=x,N=z,(j=V).test(i=s)?i+="e":E.test(i)?i=i.replace(b=M,""):N.test(i)&&(i+="e")));return(b=q).test(i)&&(i=(s=(F=b.exec(i))[1])+"i"),(b=L).test(i)&&(g=(F=b.exec(i))[2],(b=w).test(s=F[1])&&(i=s+o[g])),(b=he).test(i)&&(g=(F=b.exec(i))[2],(b=w).test(s=F[1])&&(i=s+a[g])),j=U,(b=D).test(i)?(F=b.exec(i),(b=l).test(s=F[1])&&(i=s)):j.test(i)&&(F=j.exec(i),(j=l).test(s=F[1]+F[2])&&(i=s)),(b=B).test(i)&&(F=b.exec(i),j=_,E=X,((b=l).test(s=F[1])||j.test(s)&&!E.test(s))&&(i=s)),j=l,(b=Q).test(i)&&j.test(i)&&(i=i.replace(b=M,"")),m=="y"&&(i=m.toLowerCase()+i.substr(1)),i}),u.Pipeline.registerFunction(u.stemmer,"stemmer"),u.generateStopWordFilter=function(i){var s=i.reduce(function(g,m){return g[m]=m,g},{});return function(g){if(g&&s[g]!==g)return g}},u.stopWordFilter=u.generateStopWordFilter(["a","able","about","across","after","all","almost","also","am","among","an","and","any","are","as","at","be","because","been","but","by","can","cannot","could","dear","did","do","does","either","else","ever","every","for","from","get","got","had","has","have","he","her","hers","him","his","how","however","i","if","in","into","is","it","its","just","least","let","like","likely","may","me","might","most","must","my","neither","no","nor","not","of","off","often","on","only","or","other","our","own","rather","said","say","says","she","should","since","so","some","than","that","the","their","them","then","there","these","they","this","tis","to","too","twas","us","wants","was","we","were","what","when","where","which","while","who","whom","why","will","with","would","yet","you","your"]),u.Pipeline.registerFunction(u.stopWordFilter,"stopWordFilter"),u.trimmer=function(i){return i.replace(/^\W+/,"").replace(/\W+$/,"")},u.Pipeline.registerFunction(u.trimmer,"trimmer"),u.TokenStore=function(){this.root={docs:{}},this.length=0},u.TokenStore.load=function(i){var s=new this;return s.root=i.root,s.length=i.length,s},u.TokenStore.prototype.add=function(i,s,g){g=g||this.root;var m=i.charAt(0),b=i.slice(1);return m in g||(g[m]={docs:{}}),b.length===0?(g[m].docs[s.ref]=s,void(this.length+=1)):this.add(b,s,g[m])},u.TokenStore.prototype.has=function(i){if(!i)return!1;for(var s=this.root,g=0;g<i.length;g++){if(!s[i.charAt(g)])return!1;s=s[i.charAt(g)]}return!0},u.TokenStore.prototype.getNode=function(i){if(!i)return{};for(var s=this.root,g=0;g<i.length;g++){if(!s[i.charAt(g)])return{};s=s[i.charAt(g)]}return s},u.TokenStore.prototype.get=function(i,s){return this.getNode(i,s).docs||{}},u.TokenStore.prototype.count=function(i,s){return Object.keys(this.get(i,s)).length},u.TokenStore.prototype.remove=function(i,s){if(i){for(var g=this.root,m=0;m<i.length;m++){if(!(i.charAt(m)in g))return;g=g[i.charAt(m)]}delete g.docs[s]}},u.TokenStore.prototype.expand=function(i,s){var g=this.getNode(i);return s=s||[],Object.keys(g.docs||{}).length&&s.push(i),Object.keys(g).forEach(function(m){m!=="docs"&&s.concat(this.expand(i+m,s))},this),s},u.TokenStore.prototype.toJSON=function(){return{root:this.root,length:this.length}},t.exports=u})()}(r),r.exports}();class kr{constructor(r,t){this.store=new Map,this.idx=Ne(function(){this.field("name",{boost:10}),((t==null?void 0:t.searchableFields)||[]).forEach(o=>this.field(o)),this.ref("_id"),t!=null&&t.isExactSearch&&(this.pipeline.remove(Ne.stemmer),this.pipeline.remove(Ne.stopWordFilter)),t!=null&&t.removeStopWordFilter&&this.pipeline.remove(Ne.stopWordFilter)});let n=1;(r||[]).map(o=>{o._id=n,++n,this.idx.add(o),this.store.set(o._id,o)})}search_full(r,t){return this.search(r,t).map(n=>this.store.get(n))}search(r,t){return t instanceof Function?(r?this.idx.search(r).map(n=>this.store.get(n.ref)):[...this.store.values()]).filter(t).map(n=>n._id):r?this.idx.search(r).map(n=>n.ref):[...this.store.keys()]}}class zr{constructor(r,t){(t=t||Object.create(null)).aggregations=t.aggregations||Object.create(null),this._items=r,this.config=t.aggregations,this.facets=function(c,h){h=h||[];const d={data:Object.create(null),bits_data:Object.create(null),bits_data_temp:Object.create(null)};let f=1;return h.forEach(p=>{d.data[p]=Object.create(null)}),c&&c.map(p=>(p._id||(p._id=f,++f),p)),c&&c.map(p=>(h.forEach(y=>{if(p){if(Array.isArray(p[y]))p[y].forEach(w=>{p[y]&&(d.data[y][w]||(d.data[y][w]=[]),d.data[y][w].push(parseInt(p._id)))});else if(p[y]!==void 0){const w=p[y];d.data[y][w]||(d.data[y][w]=[]),d.data[y][w].push(parseInt(p._id))}}}),p)),d.data=A(d.data,function(p,y){return d.bits_data[y]||(d.bits_data[y]=Object.create(null),d.bits_data_temp[y]=Object.create(null)),A(p,function(w,l){const _=Vo(w);return d.bits_data[y][l]=new W(_),_})}),d}(r,ye(t.aggregations)),this._items_map=Object.create(null),this._ids=[];let n=1;var o,a;a=c=>{this._ids.push(n),this._items_map[n]=c,c._id=n,++n},(C(o=r)?ce:_r)(o,ie(a)),this.ids_map=Object.create(null),r&&r.forEach(c=>{const h=t.custom_id_field||"id";c[h]&&c._id&&(this.ids_map[c[h]]=c._id)}),this._bits_ids=new W(this._ids)}items(){return this._items}bits_ids(r){return r?new W(r):this._bits_ids}internal_ids_from_ids_map(r){return r.map(t=>this.ids_map[t])}index(){return this.facets}get_item(r){return this._items_map[r]}search(r,t){const n=this.config;t=t||Object.create(null);const o=at(this.facets);let a;o.not_ids=Or(o.bits_data,r.not_filters);const c=function(h,d){const f=[];return A(h.filters,function(p,y){if(p&&p.length)if(d[y].conjunction!==!1)A(p,function(w){f.push([y,w])});else{const w=[];A(p,function(l){w.push([y,l])}),f.push(w)}}),A(h.not_filters,function(p,y){p&&p.length&&A(p,function(w){f.push([y,"-",w])})}),f}(r,n);return a=function(h,d){const f=at(h);let p;d=d||[],A(f.bits_data,function(w,l){A(f.bits_data[l],function(_,v){f.bits_data_temp[l][v]=f.bits_data[l][v]})}),f.is_temp_copied=!0;const y=function(w,l){const _=Object.create(null);return A(l,function(v){if(Array.isArray(v[0])){let S=new W([]);A(v,function(O){const I=O[0];S=S.new_union(w.bits_data[I][O[1]]||new W([])),_[I]=S})}}),_}(h,d);return A(d,function(w){if(!Array.isArray(w[0])){const l=w[0],_=w[1];p=p&&f.bits_data_temp[l][_]?f.bits_data_temp[l][_].new_intersection(p):p&&!f.bits_data_temp[l][_]?new W([]):f.bits_data_temp[l][_]}}),p&&A(f.bits_data_temp,function(w,l){A(f.bits_data_temp[l],function(_,v){f.bits_data_temp[l][v]=f.bits_data_temp[l][v].new_intersection(p)})}),A(d,function(w){if(w.length===3&&w[1]==="-"){const l=f.bits_data_temp[w[0]][w[2]].clone();A(f.bits_data_temp,function(_,v){A(f.bits_data_temp[v],function(S,O){f.bits_data_temp[v][O]=f.bits_data_temp[v][O].new_difference(l)})})}}),A(f.bits_data_temp,function(w,l){A(f.bits_data_temp[l],function(_,v){A(y,function(S,O){O!==l&&(f.bits_data_temp[l][v]=f.bits_data_temp[l][v].new_intersection(S))})})}),f}(this.facets,c),r.filters_query&&(a=function(h,d){const f=at(h);f.is_temp_copied||A(f.bits_data,function(y,w){A(f.bits_data[w],function(l,_){f.bits_data_temp[w][_]=f.bits_data[w][_]})});let p=null;return A(d,function(y){let w=null;A(y,function(l){const _=l[0],v=l[1];if(!f.bits_data_temp[_])throw new Error("Panic. The key does not exist in facets lists.");w=w&&f.bits_data_temp[_][v]?f.bits_data_temp[_][v].new_intersection(w):w&&!f.bits_data_temp[_][v]?new W([]):f.bits_data_temp[_][v]}),p=(p||new W([])).new_union(w||new W([]))}),p!==null&&A(f.bits_data_temp,function(y,w){A(f.bits_data_temp[w],function(l,_){f.bits_data_temp[w][_]=f.bits_data_temp[w][_].new_intersection(p)})}),f}(a,qo(r.filters_query).map(h=>Array.isArray(h)?h.map(d=>Array.isArray(d)?d.map(f=>f):d.split(":")):h.split(":")))),o.bits_data_temp=a.bits_data_temp,A(o.bits_data_temp,function(h,d){A(o.bits_data_temp[d],function(f,p){t.query_ids&&(o.bits_data_temp[d][p]=t.query_ids.new_intersection(o.bits_data_temp[d][p])),t.test&&(o.data[d][p]=o.bits_data_temp[d][p].array())})}),o.ids=r.filters_query?function(h){let d=new W([]);return A(h,function(f,p){A(h[p],function(y,w){d=d.new_union(h[p][w])})}),d}(o.bits_data_temp):Or(o.bits_data_temp,r.filters),o}}function Bo(e,r){let t;(r=r||Object.create(null)).native_search_enabled!==!1&&(t=new kr(e,r));let n=new zr(e,r);return{search:function(o){return(o=o||Object.create(null)).aggregations=function(a,c){return A(Sr(a),(h,d)=>{h.field||(h.field=d);let f=[];c.filters&&c.filters[d]&&(f=c.filters[d]),h.filters=f;let p=[];return c.not_filters&&c.not_filters[d]&&(p=c.not_filters[d]),c.exclude_filters&&c.exclude_filters[d]&&(p=c.exclude_filters[d]),h.not_filters=p,h})}(r.aggregations,o),xr(0,o,r,t,n)},similar:function(o,a){return function(c,h,d){const f=d.per_page||10,p=d.minimum||0,y=d.page||1;let w;for(let v=0;v<c.length;++v)if(c[v].id==h){w=c[v];break}if(!d.field)throw new Error("Please define field in options");const l=d.field;let _=[];for(let v=0;v<c.length;++v)if(c[v].id!==h){const S=$o(w[l],c[v][l]);S.length>=p&&(_.push(c[v]),_[_.length-1].intersection_length=S.length)}return _=ht(_,["intersection_length"],["desc"]),{pagination:{per_page:f,page:y,total:_.length},data:{items:_.slice((y-1)*f,y*f)}}}(e,o,a)},aggregation:function(o){return function(a,c,h,d,f){const p=c.per_page||10,y=c.page||1;if(c.name&&(!h.aggregations||!h.aggregations[c.name]))throw new Error('Please define aggregation "'.concat(c.name,'" in config'));const w=Sr(c);if(w.page=1,w.per_page=0,!c.name)throw new Error("field name is required");h.aggregations[c.name].size=1e4;const l=xr(0,w,h,d,f).data.aggregations[c.name].buckets;return{pagination:{per_page:p,page:y,total:l.length},data:{buckets:l.slice((y-1)*p,y*p)}}}(0,o,r,t,n)},reindex:function(o){t=new kr(e=o,r),n=new zr(e,r)}}}const dt={};function Jo(e,r,t){dt[e]||(dt[e]=Bo(r,t))}function Go({dataSource:e,query:r,page:t=1,perPage:n=25,sort:o="title_asc",filters:a={}}){const c=dt[e];if(!c)throw new Error(`Search engine for ${e} is not initialised`);return c.search({per_page:n,page:t,query:r,sort:o,filters:a})}addEventListener("message",async e=>{const{action:r,payload:t}=e.data;if(r==="load"){const{basePath:n,dataSource:o}=t,a=Pr[o],c=await fetch(`${n}/api/search/${o}.json`).then(h=>h.json());Jo(o,c,a),postMessage({action:"ready"})}else if(r==="search"){const{dataSource:n,query:o,filters:a,page:c}=t,h=Go({dataSource:n,query:o,filters:a,page:c});postMessage({action:"results",payload:{query:o,results:h}})}})})();
