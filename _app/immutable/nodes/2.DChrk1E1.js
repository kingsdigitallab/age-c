import{l as Te,t as L,a as C,s as O,g as ye,i as Me,e as ue,f as Ee}from"../chunks/n3zSNMMU.js";import{ak as De,a0 as Ve,aB as We,s as he,h as Z,ap as ze,am as Je,a as Be,b as Ue,A as n,I as Ze,e as Ge,r as we,f as de,d as oe,av as Xe,g as Fe,c as Ne,p as je,az as Qe,N as $e,y as Ie,aC as _e,a4 as Re,aD as Ce,aE as pe,aF as ea,ay as aa,aG as ra,Z as ta,aH as xe,aI as na,ao as sa,aJ as He,a9 as be,aK as la,aL as ia,o as oa,ad as Oe,aM as ca,al as ua,k as d,j as m,l as T,t as q,w as G,ai as ae,q as se,v as le,aN as va,K as ke,ag as X,M as K}from"../chunks/DGUPX_yp.js";import{a as J,r as qe,s as fa,b as ha,c as da}from"../chunks/C8TOtLiR.js";import{i as P}from"../chunks/DHs3WuQV.js";import{b as te}from"../chunks/CtoVAqSD.js";import{c as ne}from"../chunks/CS75LI7K.js";import{p as W}from"../chunks/Bz8ItFjh.js";import{o as _a,a as ga}from"../chunks/Dgs5UUeM.js";import{t as Pe,s as ma,f as Sa}from"../chunks/CYwLZZSY.js";const ya=[];function ba(a,e=!1){return ve(a,new Map,"",ya)}function ve(a,e,r,v,t=null){if(typeof a=="object"&&a!==null){var o=e.get(a);if(o!==void 0)return o;if(a instanceof Map)return new Map(a);if(a instanceof Set)return new Set(a);if(De(a)){var s=Array(a.length);e.set(a,s),t!==null&&e.set(t,s);for(var _=0;_<a.length;_+=1){var S=a[_];_ in a&&(s[_]=ve(S,e,r,v))}return s}if(Ve(a)===We){s={},e.set(a,s),t!==null&&e.set(t,s);for(var l in a)s[l]=ve(a[l],e,r,v);return s}if(a instanceof Date)return structuredClone(a);if(typeof a.toJSON=="function")return ve(a.toJSON(),e,r,v,a)}if(a instanceof EventTarget)return a;try{return structuredClone(a)}catch{return a}}function $(a,e){return e}function ka(a,e,r,v){for(var t=[],o=e.length,s=0;s<o;s++)ea(e[s].e,t,!0);var _=o>0&&t.length===0&&r!==null;if(_){var S=r.parentNode;aa(S),S.append(r),v.clear(),j(a,e[0].prev,e[o-1].next)}ra(t,()=>{for(var l=0;l<o;l++){var g=e[l];_||(v.delete(g.k),j(a,g.prev,g.next)),ta(g.e,!_)}})}function ee(a,e,r,v,t,o=null){var s=a,_={flags:e,items:new Map,first:null},S=(e&He)!==0;if(S){var l=a;s=Z?he(ze(l)):l.appendChild(Je())}Z&&Be();var g=null,x=!1,i=Ze(()=>{var k=r();return De(k)?k:k==null?[]:Qe(k)});Ue(()=>{var k=n(i),c=k.length;if(x&&c===0)return;x=c===0;let E=!1;if(Z){var b=s.data===Ge;b!==(c===0)&&(s=we(),he(s),de(!1),E=!0)}if(Z){for(var w=null,A,p=0;p<c;p++){if(oe.nodeType===8&&oe.data===Xe){s=oe,E=!0,de(!1);break}var u=k[p],h=v(u,p);A=Ye(oe,_,w,null,u,h,p,t,e,r),_.items.set(h,A),w=A}c>0&&he(we())}Z||Ca(k,_,s,t,e,v,r),o!==null&&(c===0?g?Fe(g):g=Ne(()=>o(s)):g!==null&&je(g,()=>{g=null})),E&&de(!0),n(i)}),Z&&(s=oe)}function Ca(a,e,r,v,t,o,s){var Y,B,V,U;var _=(t&la)!==0,S=(t&(xe|Ce))!==0,l=a.length,g=e.items,x=e.first,i=x,k,c=null,E,b=[],w=[],A,p,u,h;if(_)for(h=0;h<l;h+=1)A=a[h],p=o(A,h),u=g.get(p),u!==void 0&&((Y=u.a)==null||Y.measure(),(E??(E=new Set)).add(u));for(h=0;h<l;h+=1){if(A=a[h],p=o(A,h),u=g.get(p),u===void 0){var F=i?i.e.nodes_start:r;c=Ye(F,e,c,c===null?e.first:c.next,A,p,h,v,t,s),g.set(p,c),b=[],w=[],i=c.next;continue}if(S&&xa(u,A,h,t),(u.e.f&_e)!==0&&(Fe(u.e),_&&((B=u.a)==null||B.unfix(),(E??(E=new Set)).delete(u))),u!==i){if(k!==void 0&&k.has(u)){if(b.length<w.length){var y=w[0],f;c=y.prev;var I=b[0],Q=b[b.length-1];for(f=0;f<b.length;f+=1)Le(b[f],y,r);for(f=0;f<w.length;f+=1)k.delete(w[f]);j(e,I.prev,Q.next),j(e,c,I),j(e,Q,y),i=y,c=Q,h-=1,b=[],w=[]}else k.delete(u),Le(u,i,r),j(e,u.prev,u.next),j(e,u,c===null?e.first:c.next),j(e,c,u),c=u;continue}for(b=[],w=[];i!==null&&i.k!==p;)(i.e.f&_e)===0&&(k??(k=new Set)).add(i),w.push(i),i=i.next;if(i===null)continue;u=i}b.push(u),c=u,i=u.next}if(i!==null||k!==void 0){for(var M=k===void 0?[]:Qe(k);i!==null;)(i.e.f&_e)===0&&M.push(i),i=i.next;var D=M.length;if(D>0){var H=(t&He)!==0&&l===0?r:null;if(_){for(h=0;h<D;h+=1)(V=M[h].a)==null||V.measure();for(h=0;h<D;h+=1)(U=M[h].a)==null||U.fix()}ka(e,M,H,g)}}_&&be(()=>{var z;if(E!==void 0)for(u of E)(z=u.a)==null||z.apply()}),Re.first=e.first&&e.first.e,Re.last=c&&c.e}function xa(a,e,r,v){(v&xe)!==0&&pe(a.v,e),(v&Ce)!==0?pe(a.i,r):a.i=r}function Ye(a,e,r,v,t,o,s,_,S,l){var g=(S&xe)!==0,x=(S&na)===0,i=g?x?$e(t):Ie(t):t,k=(S&Ce)===0?s:Ie(s),c={i:k,v:i,k:o,a:null,e:null,prev:r,next:v};try{return c.e=Ne(()=>_(a,i,k,l),Z),c.e.prev=r&&r.e,c.e.next=v&&v.e,r===null?e.first=c:(r.next=c,r.e.next=c.e),v!==null&&(v.prev=c,v.e.prev=c.e),c}finally{}}function Le(a,e,r){for(var v=a.next?a.next.e.nodes_start:r,t=e?e.e.nodes_start:r,o=a.e.nodes_start;o!==v;){var s=sa(o);t.before(o),o=s}}function j(a,e,r){e===null?a.first=r:(e.next=r,e.e.next=r&&r.e),r!==null&&(r.prev=e,r.e.prev=e&&e.e)}function Ea(a,e,r=e){var v=ia();Te(a,"input",t=>{var o=t?a.defaultValue:a.value;if(o=me(a)?Se(o):o,r(o),v&&o!==(o=e())){var s=a.selectionStart,_=a.selectionEnd;a.value=o??"",_!==null&&(a.selectionStart=s,a.selectionEnd=Math.min(_,a.value.length))}}),(Z&&a.defaultValue!==a.value||oa(e)==null&&a.value)&&r(me(a)?Se(a.value):a.value),Oe(()=>{var t=e();me(a)&&t===Se(a.value)||a.type==="date"&&!t&&!a.value||t!==a.value&&(a.value=t??"")})}const ge=new Set;function wa(a,e,r,v,t=v){var o=r.getAttribute("type")==="checkbox",s=a;let _=!1;if(e!==null)for(var S of e)s=s[S]??(s[S]=[]);s.push(r),Te(r,"change",()=>{var l=r.__value;o&&(l=Ae(s,l,r.checked)),t(l)},()=>t(o?[]:null)),Oe(()=>{var l=v();if(Z&&r.defaultChecked!==r.checked){_=!0;return}o?(l=l||[],r.checked=l.includes(r.__value)):r.checked=ca(r.__value,l)}),ua(()=>{var l=s.indexOf(r);l!==-1&&s.splice(l,1)}),ge.has(s)||(ge.add(s),be(()=>{s.sort((l,g)=>l.compareDocumentPosition(g)===4?-1:1),ge.delete(s)})),be(()=>{if(_){var l;if(o)l=Ae(s,l,r.checked);else{var g=s.find(x=>x.checked);l=g==null?void 0:g.__value}t(l)}})}function Ae(a,e,r){for(var v=new Set,t=0;t<a.length;t+=1)a[t].checked&&v.add(a[t].__value);return r||v.delete(e),Array.from(v)}function me(a){var e=a.type;return e==="number"||e==="range"}function Se(a){return a===""?null:+a}var Ia=L('<li class="svelte-55kp84"><time class="year"> </time></li>'),Ra=L('<li class="svelte-55kp84"> </li>'),pa=L('<li class="svelte-55kp84"><a> </a></li>'),La=L('<ul class="svelte-55kp84"><li class="svelte-55kp84">Director</li> <!></ul>'),Aa=L('<li class="svelte-55kp84"><a> </a></li>'),Ta=L('<ul class="svelte-55kp84"></ul>'),Ma=L('<ul class="svelte-55kp84"><!> <!></ul> <!> <!>',1),Da=L('<li class="svelte-55kp84"><a> </a></li>'),Fa=L('<ul class="svelte-55kp84"><li class="svelte-55kp84">Director</li> <!></ul>'),Na=L('<li class="svelte-55kp84"><a> </a></li>'),Qa=L('<ul class="svelte-55kp84"><li class="svelte-55kp84">Character</li> <!></ul>'),Ha=L("<!> <!>",1),Oa=L("<li><a><strong> </strong></a> <!></li>"),qa=L("<ol></ol>");function Pa(a,e){var r=qa();ee(r,21,()=>e.items,$,(v,t)=>{var o=Oa(),s=m(o),_=m(s),S=m(_,!0);d(_),d(s);var l=T(s,2);{var g=i=>{var k=Ma(),c=G(k),E=m(c);{var b=y=>{var f=Ia(),I=m(f),Q=m(I,!0);d(I),d(f),q(()=>{J(I,"datetime",n(t).release.date),O(Q,n(t).release.year)}),C(y,f)};P(E,y=>{var f,I;(I=(f=n(t))==null?void 0:f.release)!=null&&I.year&&y(b)})}var w=T(E,2);{var A=y=>{var f=Ra(),I=m(f,!0);d(f),q(()=>O(I,n(t).production.country)),C(y,f)};P(w,y=>{var f,I;(I=(f=n(t))==null?void 0:f.production)!=null&&I.country&&y(A)})}d(c);var p=T(c,2);{var u=y=>{var f=La(),I=T(m(f),2);ee(I,17,()=>n(t).director,$,(Q,M)=>{var D=pa(),H=m(D),Y=m(H);d(H),d(D),q(()=>{J(H,"href",`${te}/person/${n(M).slug}`),O(Y,`${n(M).name??""} (${n(M).gender??""}, ${n(M).birthYear??""} - ${n(M).deathYear??""})`)}),C(Q,D)}),d(f),C(y,f)};P(p,y=>{n(t).director&&n(t).director.length>0&&y(u)})}var h=T(p,2);{var F=y=>{var f=Ta();ee(f,21,()=>n(t).character,$,(I,Q)=>{var M=Aa();const D=ae(()=>n(Q).person);var H=m(M),Y=m(H);d(H),d(M),q(()=>{var B,V,U,z,re;J(H,"href",`${te}/person/${(B=n(D))==null?void 0:B.slug}`),O(Y,`${((V=n(D))==null?void 0:V.name)??""}
									(${((U=n(D))==null?void 0:U.gender)??""}, ${((z=n(D))==null?void 0:z.birthYear)??""} - ${((re=n(D))==null?void 0:re.deathYear)??""})`)}),C(I,M)}),d(f),C(y,f)};P(h,y=>{n(t).character&&n(t).character.length>0&&y(F)})}C(i,k)},x=i=>{var k=Ha(),c=G(k);{var E=A=>{var p=Fa(),u=T(m(p),2);ee(u,17,()=>n(t).director,$,(h,F)=>{var y=Da(),f=m(y),I=m(f,!0);d(f),d(y),q(()=>{var Q;J(f,"href",`${te}/film/${n(F).slug}`),O(I,(Q=n(F).title)==null?void 0:Q.native)}),C(h,y)}),d(p),C(A,p)};P(c,A=>{n(t).director&&n(t).director.length>0&&A(E)})}var b=T(c,2);{var w=A=>{var p=Qa(),u=T(m(p),2);ee(u,17,()=>n(t).character,$,(h,F)=>{var y=Na();const f=ae(()=>n(F).film);var I=m(y),Q=m(I,!0);d(I),d(y),q(()=>{var M,D,H;J(I,"href",`${te}/film/${(M=n(f))==null?void 0:M.slug}`),O(Q,(H=(D=n(f))==null?void 0:D.title)==null?void 0:H.native)}),C(h,y)}),d(p),C(A,p)};P(b,A=>{n(t).character&&n(t).character.length>0&&A(w)})}C(i,k)};P(l,i=>{n(t).type==="film"?i(g):i(x,!1)})}d(o),q(()=>{J(s,"href",`${te}/${n(t).type}/${n(t).slug}`),O(S,n(t).title)}),C(v,o)}),d(r),C(a,r)}function Ya(a){return new Worker(""+new URL("../workers/worker-CmZ4zfDp.js",import.meta.url).href,{name:a==null?void 0:a.name})}var Ka=L('<section><h2> </h2> <form><fieldset role="group"><input id="search-query" type="text"> <button type="submit">Search</button> <button type="reset" aria-label="Reset search">Reset</button></fieldset></form></section>');function Va(a,e){se(e,!0);let r=W(e,"title",3,"Search"),v=W(e,"searchQuery",15,""),t=W(e,"minSearchQueryLength",3,3),o=ae(()=>v().trim().length>=t());var s=Ka(),_=m(s),S=m(_,!0);d(_);var l=T(_,2),g=m(l),x=m(g);qe(x);var i=T(x,2),k=T(i,2);d(g),d(l),d(s),q((c,E)=>{O(S,r()),x.disabled=e.isLoading||e.isSearching,J(x,"placeholder",c),J(x,"aria-label",E),i.disabled=e.isLoading||!n(o),J(i,"aria-label",n(o)?"Search":`Please enter at least ${t()} characters`),k.disabled=e.isLoading},[()=>`Enter a ${r().toLowerCase()} query...`,()=>`Enter a ${r().toLowerCase()} query...`]),ye("submit",l,function(...c){var E;(E=e.onSearch)==null||E.apply(this,c)}),ye("reset",l,function(...c){var E;(E=e.onReset)==null||E.apply(this,c)}),Ea(x,v),C(a,s),le()}var Wa=L("<p>Loading...</p>"),za=L("<p>Searching...</p>"),Ja=L('<p role="alert" class="error"> </p>'),Ba=L("<section><!> <!></section>");function Ua(a,e){var r=Ba(),v=m(r);{var t=S=>{var l=Wa();J(l,"aria-busy",!0),C(S,l)},o=(S,l)=>{{var g=x=>{var i=za();J(i,"aria-busy",!0),C(x,i)};P(S,x=>{e.isSearching&&x(g)},l)}};P(v,S=>{e.isLoading?S(t):S(o,!1)})}var s=T(v,2);{var _=S=>{var l=Ja(),g=m(l,!0);d(l),q(()=>O(g,e.searchError)),C(S,l)};P(s,S=>{e.searchError&&S(_)})}d(r),C(a,r)}function Za(a,e){se(e,!0),ye("keydown",va,r=>{(r.ctrlKey||r.metaKey)&&(r.key==="k"||r.key==="K")&&(r.preventDefault(),e.onToggleSearch())}),le()}var Ga=L('<label class="svelte-y5pyp5"><input type="checkbox"> <span> </span> <small> </small></label>'),Xa=L('<section><details class="svelte-y5pyp5"><summary> </summary> <fieldset class="svelte-y5pyp5"></fieldset></details></section>'),ja=L('<aside tabindex="-1" class="svelte-y5pyp5"><h3>Filters</h3> <button class="close-search-filters-button svelte-y5pyp5" aria-label="Close search filters"><span aria-hidden="true">&times;</span></button> <!> <!></aside>');function $a(a,e){se(e,!0);const r=[],v=W(e,"searchFilters",31,()=>ke({})),t=W(e,"children",3,null),o=ae(()=>Object.entries(e.searchConfig[e.dataSource].aggregations));var s=ue(),_=G(s);{var S=l=>{var g=ja(),x=T(m(g),2);x.__click=function(...b){var w;(w=e.onClose)==null||w.apply(this,b)};var i=T(x,2);{var k=b=>{var w=ue(),A=G(w);fa(A,t),C(b,w)};P(i,b=>{t()&&b(k)})}var c=T(i,2);{var E=b=>{var w=ue(),A=G(w);ee(A,17,()=>n(o),$,(p,u,h)=>{let F=()=>n(u)[0],y=()=>n(u)[1];var f=Xa(),I=m(f),Q=m(I),M=m(Q,!0);d(Q);var D=T(Q,2);ee(D,21,()=>e.searchAggregations[F()].buckets,$,(H,Y)=>{var B=Ga(),V=m(B);qe(V);var U;V.__change=function(...R){var N;(N=e.onFiltersChange)==null||N.apply(this,R)};var z=T(V,2),re=m(z,!0);d(z);var ce=T(z,2),fe=m(ce);d(ce),d(B),q(()=>{U!==(U=n(Y).key)&&(V.value=(V.__value=n(Y).key)??""),O(re,n(Y).key),O(fe,`(${n(Y).doc_count??""})`)}),wa(r,[h],V,()=>(n(Y).key,v()[F()]),R=>v(v()[F()]=R,!0)),C(H,B)}),d(D),d(I),d(f),q(()=>O(M,y().title)),C(p,f)}),C(b,w)};P(c,b=>{e.searchAggregations&&b(E)})}d(g),Pe(3,g,()=>ma,()=>({axis:"x"})),C(l,g)};P(_,l=>{e.show&&l(S)})}C(a,s),le()}Me(["click","change"]);var er=L("<li><a> </a></li>"),ar=L("<ol></ol>");function Ke(a,e){var r=ar();ee(r,21,()=>e.items,$,(v,t)=>{var o=er(),s=m(o),_=m(s,!0);d(s),d(o),q(()=>{J(s,"href",`${te}/${n(t).type}/${n(t).slug}`),O(_,n(t).title)}),C(v,o)}),d(r),C(a,r)}var rr=L("<p> </p>"),tr=L("<hgroup><h2> </h2> <small><!></small></hgroup> <div><!></div>",1),nr=L("<section><!></section>");function sr(a,e){se(e,!0);const r=W(e,"title",3,"Results"),v=W(e,"SearchResultsItemsComponent",3,Ke);var t=nr(),o=m(t);{var s=_=>{var S=tr(),l=G(S),g=m(l),x=m(g,!0);d(g);var i=T(g,2),k=m(i);{var c=u=>{var h=Ee();q(F=>O(h,`${F??""} found`),[()=>e.searchPagination.total.toLocaleString()]),C(u,h)},E=u=>{var h=Ee("No results");C(u,h)};P(k,u=>{var h;((h=e.searchPagination)==null?void 0:h.total)!==void 0?u(c):u(E,!1)})}d(i),d(l);var b=T(l,2),w=m(b);{var A=u=>{var h=ue(),F=G(h);ne(F,v,(y,f)=>{f(y,{get items(){return e.searchItems}})}),C(u,h)},p=(u,h)=>{{var F=y=>{var f=rr(),I=m(f);d(f),q(()=>O(I,`No results found for "${e.searchQuery??""}"`)),C(y,f)};P(u,y=>{e.searchQuery&&!e.isSearching&&y(F)},h)}};P(w,u=>{var h;((h=e.searchItems)==null?void 0:h.length)>0?u(A):u(p,!1)})}d(b),q(()=>O(x,r())),Pe(3,b,()=>Sa),C(_,S)};P(o,_=>{e.isLoading||_(s)})}d(t),q(()=>J(t,"aria-busy",e.isSearching)),C(a,t),le()}var lr=L("<!> <article><h1> </h1> <!> <!> <section><button>Filters</button></section> <!></article> <!>",1);function ir(a,e){se(e,!0);const r=W(e,"SearchShortcutsComponent",3,Za),v=W(e,"SearchStatusComponent",3,Ua),t=W(e,"SearchInputComponent",3,Va),o=W(e,"SearchFiltersComponent",3,$a),s=W(e,"SearchResultsComponent",3,sr),_=W(e,"SearchResultsItemsComponent",3,Ke),S=W(e,"minSearchQueryLength",3,3);let l=X(""),g=X(ke({})),x=X("idle"),i=X(null),k=X(null),c=ae(()=>["idle","load"].includes(n(x))),E=X(!1),b=X(!1),w=X(ke([]));const A=ae(()=>{var R,N;return(N=(R=n(w))==null?void 0:R.data)==null?void 0:N.aggregations}),p=ae(()=>{var R,N;return(N=(R=n(w))==null?void 0:R.data)==null?void 0:N.items}),u=ae(()=>{var R;return(R=n(w))==null?void 0:R.pagination});_a(()=>{h()});function h(){n(x)!=="ready"&&(K(x,"load"),K(i,new Ya,!0),n(i).onmessage=R=>{const{action:N,payload:ie}=R.data;K(k,null),N==="ready"?(K(x,"ready"),f()):N==="results"&&(K(w,ie.results,!0),K(b,!1))},n(i).onerror=R=>{K(k,"An error occurred while searching"),K(x,"ready"),console.error("Search worker error:",R)},n(i).postMessage({action:"load",payload:{basePath:te,dataSource:e.dataSource}}))}function F(){K(E,!n(E))}function y(R){R.preventDefault(),K(b,!0),f()}function f(){var R;n(x)==="ready"&&((R=n(i))==null||R.postMessage({action:"search",payload:{dataSource:e.dataSource,query:n(l),filters:ba(n(g))}}))}function I(){K(l,""),K(g,{},!0),f()}function Q(){f()}ga(()=>{setTimeout(()=>{n(i)&&(n(i).terminate(),K(i,null))},1e3)});var M=lr(),D=G(M);ne(D,r,(R,N)=>{N(R,{onToggleSearch:F})});var H=T(D,2),Y=m(H),B=m(Y,!0);d(Y);var V=T(Y,2);ne(V,v,(R,N)=>{N(R,{get isLoading(){return n(c)},get isSearching(){return n(b)},get searchError(){return n(k)}})});var U=T(V,2);ne(U,t,(R,N)=>{N(R,{get isLoading(){return n(c)},get isSearching(){return n(b)},get minSearchQueryLength(){return S()},onSearch:y,onReset:I,get searchQuery(){return n(l)},set searchQuery(ie){K(l,ie,!0)}})});var z=T(U,2),re=m(z);re.__click=F,d(z);var ce=T(z,2);ne(ce,s,(R,N)=>{N(R,{get isLoading(){return n(c)},get isSearching(){return n(b)},get searchQuery(){return n(l)},get searchItems(){return n(p)},get searchPagination(){return n(u)},get SearchResultsItemsComponent(){return _()}})}),d(H);var fe=T(H,2);ne(fe,o,(R,N)=>{N(R,{get show(){return n(E)},get searchAggregations(){return n(A)},get searchConfig(){return e.searchConfig},get dataSource(){return e.dataSource},onClose:()=>K(E,!1),onFiltersChange:Q,get searchFilters(){return n(g)},set searchFilters(ie){K(g,ie,!0)}})}),q(()=>{O(B,e.title),re.disabled=n(c)||n(b)||n(E)}),C(a,M),le()}Me(["click"]);var or=L('<section><h1 class="svelte-8gczgd"> </h1></section> <section><!></section>',1);function Sr(a,e){se(e,!0);const r="corpus";var v=or(),t=G(v),o=m(t),s=m(o,!0);d(o),d(t);var _=T(t,2),S=m(_);ir(S,{get dataSource(){return r},searchConfig:ha,title:"Explore the dataset",SearchResultsItemsComponent:Pa}),d(_),q(()=>O(s,da.siteTitle)),C(a,v),le()}export{Sr as component};
